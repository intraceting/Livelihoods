%!PS
%%Version: 3.15
%%DocumentFonts: (atend)
%%Pages: (atend)
%%EndComments
%ident	"@(#)lp:filter/postscript/postscript/dpost.ps	1.1"
%
% Version 3.15 prologue for troff files.
%

/#copies 1 store
/aspectratio 1 def
/formsperpage 1 def
/landscape false def
/linewidth .3 def
/magnification 1 def
/margin 0 def
/orientation 0 def
/resolution 720 def
/xoffset 0 def
/yoffset 0 def

/roundpage true def
/useclippath true def
/pagebbox [0 0 612 792] def

/R  /Times-Roman def
/I  /Times-Italic def
/B  /Times-Bold def
/BI /Times-BoldItalic def
/H  /Helvetica def
/HI /Helvetica-Oblique def
/HB /Helvetica-Bold def
/HX /Helvetica-BoldOblique def
/CW /Courier def
/CO /Courier def
/CI /Courier-Oblique def
/CB /Courier-Bold def
/CX /Courier-BoldOblique def
/PA /Palatino-Roman def
/PI /Palatino-Italic def
/PB /Palatino-Bold def
/PX /Palatino-BoldItalic def
/Hr /Helvetica-Narrow def
/Hi /Helvetica-Narrow-Oblique def
/Hb /Helvetica-Narrow-Bold def
/Hx /Helvetica-Narrow-BoldOblique def
/KR /Bookman-Light def
/KI /Bookman-LightItalic def
/KB /Bookman-Demi def
/KX /Bookman-DemiItalic def
/AR /AvantGarde-Book def
/AI /AvantGarde-BookOblique def
/AB /AvantGarde-Demi def
/AX /AvantGarde-DemiOblique def
/NR /NewCenturySchlbk-Roman def
/NI /NewCenturySchlbk-Italic def
/NB /NewCenturySchlbk-Bold def
/NX /NewCenturySchlbk-BoldItalic def
/ZD /ZapfDingbats def
/ZI /ZapfChancery-MediumItalic def
/VR /Varitimes#Roman def
/VI /Varitimes#Italic def
/VB /Varitimes#Bold def
/VX /Varitimes#BoldItalic def
/S  /S def
/S1 /S1 def
/GR /Symbol def

/inch {72 mul} bind def
/min {2 copy gt {exch} if pop} bind def

/setup {
	counttomark 2 idiv {def} repeat pop

	landscape {/orientation 90 orientation add def} if
	/scaling 72 resolution div def
	linewidth setlinewidth
	1 setlinecap

	pagedimensions
	xcenter ycenter translate
	orientation neg rotate
	width 2 div neg height 2 div translate
	xoffset inch yoffset inch translate
	margin 2 div dup neg translate
	magnification dup aspectratio mul scale
	scaling scaling scale

	/Symbol /S Sdefs cf
	/Times-Roman /S1 S1defs cf
	0 0 moveto
} def

/pagedimensions {
	useclippath userdict /gotpagebbox known not and {
		/pagebbox [clippath pathbbox newpath] def
		roundpage currentdict /roundpagebbox known and {roundpagebbox} if
	} if
	pagebbox aload pop
	4 -1 roll exch 4 1 roll 4 copy
	landscape {4 2 roll} if
	sub /width exch def
	sub /height exch def
	add 2 div /xcenter exch def
	add 2 div /ycenter exch def
	userdict /gotpagebbox true put
} def

/pagesetup {
	/page exch def
	currentdict /pagedict known currentdict page known and {
		page load pagedict exch get cvx exec
	} if
} def

/decodingdefs [
	{counttomark 2 idiv {y moveto show} repeat}
	{neg /y exch def counttomark 2 idiv {y moveto show} repeat}
	{neg moveto {2 index stringwidth pop sub exch div 0 32 4 -1 roll widthshow} repeat}
	{neg moveto {spacewidth sub 0.0 32 4 -1 roll widthshow} repeat}
	{counttomark 2 idiv {y moveto show} repeat}
	{neg setfunnytext}
] def

/setdecoding {/t decodingdefs 3 -1 roll get bind def} bind def

/w {neg moveto show} bind def
/m {neg dup /y exch def moveto} bind def
/done {/lastpage where {pop lastpage} if} def

/f {
	dup /font exch def findfont exch
	dup /ptsize exch def scaling div dup /size exch def scalefont setfont
	linewidth ptsize mul scaling 10 mul div setlinewidth
	/spacewidth ( ) stringwidth pop def
} bind def

/changefont {
	/fontheight exch def
	/fontslant exch def
	currentfont [
		1 0
		fontheight ptsize div fontslant sin mul fontslant cos div
		fontheight ptsize div
		0 0
	] makefont setfont
} bind def

/sf {f} bind def

/cf {
	dup length 2 idiv
	/entries exch def
	/chtab exch def
	/newfont exch def

	findfont dup length 1 add dict
	/newdict exch def
	{1 index /FID ne {newdict 3 1 roll put} {pop pop} ifelse} forall

	newdict /Metrics entries dict put
	newdict /Metrics get
	begin
		chtab aload pop
		1 1 entries {pop def} for
		newfont newdict definefont pop
	end
} bind def

%
% A few arrays used to adjust reference points and character widths in some
% of the printer resident fonts. If square roots are too high try changing
% the lines describing /radical and /radicalex to,
%
%	/radical	[0 -75 550 0]
%	/radicalex	[-50 -75 500 0]
%

/Sdefs [
	/bracketlefttp		[220 500]
	/bracketleftbt		[220 500]
	/bracketrighttp		[-70 380]
	/bracketrightbt		[-70 380]
	/braceleftbt		[220 490]
	/bracketrightex		[220 -125 500 0]
	/radical		[0 0 550 0]
	/radicalex		[-50 0 500 0]
	/parenleftex		[-20 -170 0 0]
	/integral		[100 -50 500 0]
	/infinity		[10 -75 730 0]
] def

/S1defs [
	/underscore		[0 80 500 0]
	/endash			[7 90 650 0]
] def
%%EndProlog
%%BeginSetup
mark
/resolution 720 def
setup
2 setdecoding
%%EndSetup
%%Page: 1 1
save
mark
1 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
12 B f
(Microsoft Networks)1 1032 1 2364 1200 t
(SMB FILE SHARING PROTOCOL EXTENSIONS)4 2720 1 1520 1440 t
(SMB File Sharing Protocol Extensions Version 3.0)6 2640 1 1560 1800 t
(Document Version 1.11)2 1216 1 2272 2280 t
(June 19, 1990)2 717 1 2521 3120 t
10 I f
(Microsoft Corporation)1 923 1 2418 3360 t
10 R f
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 1 1
%%Page: 2 2
save
mark
2 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 2 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(1. INTRODUCTION)1 941 1 720 840 t
10 R f
( de\256nes extensions to the LANMAN 1.0 Microsoft \256le sharing protocol as de\256ned in the)14 3712(This document)1 608 2 720 996 t
( the OenNet/Microsoft)2 948(SMB File Sharing Protocol Extension version 2.0 , document version 3.2, and)11 3372 2 720 1116 t
( to as the)3 415(Networks File Sharing Protocol \(Intel PN 136329-001\) \(sometimes referred)8 3173 2 720 1236 t
10 S1 f
(")4352 1236 w
10 R f
(core)4393 1236 w
10 S1 f
(")4564 1236 w
10 R f
(protocol\).)4649 1236 w
( \256le sys-)2 367(These extensions are primarily to provide support for Operating Systems which use installable)12 3953 2 720 1356 t
( blocks, of potentially)3 926(tems. The support for installable \256le systems require that extended attribute data)11 3394 2 720 1476 t
( be transported in a negotiated)5 1256(greater size than a negotiated buffer, are supplied with requests that could)11 3064 2 720 1596 t
( extended \256le sharing protocol is not intended to be)9 2321( The)1 243(buffer in the LANMAN 1.0 enviroment.)5 1756 3 720 1716 t
( is anticipated that other Operating Systems will have many similar requirements and)12 3510( It)1 128(speci\256c to OS/2.)2 682 3 720 1836 t
(that they will use the same services and protocols to meet them.)11 2635 1 720 1956 t
( the LANMAN 1.0 and core protocol, allows all \256le oriented OS/2)11 2798(This extension, when combined with)4 1522 2 720 2196 t
(version 1.2 functions to be performed on remote \256les using LANMAN 2.0.)11 3090 1 720 2316 t
(The extended protocol de\256ned in this document is selected by the dialect string)12 3403 1 720 2556 t
10 S1 f
(")4169 2556 w
10 R f
(LM1.2X002)4210 2556 w
10 S1 f
(")4707 2556 w
10 R f
(in the)1 246 1 4794 2556 t
(core protocol negotiate request.)3 1282 1 720 2676 t
(Acronyms used include:)2 987 1 720 2916 t
( level connection \(sometimes called a session\) between two)8 2723( transport)1 422( A)1 172( Virtual Circuit.)2 720(VC -)1 283 5 720 3192 t
(networked machines \(nodes\).)2 1188 1 970 3312 t
( token representing an instance of authenticated use of a network resource)11 3214( A)1 154( Tree Identi\256er.)2 669(TID -)1 283 4 720 3468 t
(\(often a shared subdirectory tree structure\).)5 1762 1 970 3588 t
( token representing an authenticated user of a network resource.)9 2620( A)1 138( User Identi\256er.)2 645(UID -)1 283 4 720 3744 t
( number which uniquely identi\256es a process on a node.)9 2269( A)1 138( Process Identi\256er.)2 762(PID -)1 283 4 720 3900 t
( number which uniquely identi\256es a protocol request and response within)10 3040( A)1 141( Multiplex Identi\256er.)2 856(MID -)1 283 4 720 4056 t
(a process.)1 401 1 970 4176 t
( called \256le)2 458( number which identi\256es an instance of an open \256le \( sometimes)11 2792( A)1 150( File Identi\256er.)2 637(FID -)1 283 5 720 4332 t
(handle\).)970 4452 w
( detail will be provided at a later time.)8 1587( Further)1 360(T.B.D.- To Be De\256ned.)3 970 3 720 4608 t
( reserved \256elds must be set to zero by the consumer.)10 2168( All)1 194(MBZ - Must Be Zero.)4 912 3 720 4764 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 2 2
%%Page: 3 3
save
mark
3 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 3 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( FORMAT)1 477(2. MESSAGE)1 631 2 720 840 t
10 R f
( extended protocol \(both the core messages used and the additional)10 2873(All messages sent while using the)5 1447 2 720 996 t
(messages de\256ned in this document\) will have the following format.)9 2764 1 720 1116 t
(BYTE smb)1 578 1 764 1296 t
10 S f
(_)1342 1296 w
10 R f
( contains 0xFF,'SMB' */)3 1025(idf[4]; /*)1 494 2 1392 1296 t
(BYTE smb)1 578 1 764 1416 t
10 S f
(_)1342 1416 w
10 R f
( command code */)3 759(com; /*)1 494 2 1392 1416 t
(BYTE smb)1 578 1 764 1536 t
10 S f
(_)1342 1536 w
10 R f
( error class */)3 564(rcls; /*)1 494 2 1392 1536 t
(BYTE smb)1 578 1 764 1656 t
10 S f
(_)1342 1656 w
10 R f
( reserved for future */)4 901(reh; /*)1 494 2 1392 1656 t
(WORD smb)1 622 1 720 1776 t
10 S f
(_)1342 1776 w
10 R f
( error code */)3 558(err; /*)1 494 2 1392 1776 t
(BYTE smb)1 578 1 764 1896 t
10 S f
(_)1342 1896 w
10 R f
( \257ags */)2 333(\257g; /*)1 494 2 1392 1896 t
(WORD smb)1 622 1 720 2016 t
10 S f
(_)1342 2016 w
10 R f
( \257ags */)2 333(\257g2; /*)1 494 2 1392 2016 t
(WORD smb)1 622 1 720 2136 t
10 S f
(_)1342 2136 w
10 R f
( reserved for future */)4 901(res[6]; /*)1 494 2 1392 2136 t
(WORD smb)1 622 1 720 2256 t
10 S f
(_)1342 2256 w
10 R f
( authenticated resource identi\256er */)4 1440(tid; /*)1 494 2 1392 2256 t
(WORD smb)1 622 1 720 2376 t
10 S f
(_)1342 2376 w
10 R f
( caller's process id */)4 880(pid; /*)1 494 2 1392 2376 t
(WORD smb)1 622 1 720 2496 t
10 S f
(_)1342 2496 w
10 R f
( authenticated user id */)4 986(uid; /*)1 494 2 1392 2496 t
(WORD smb)1 622 1 720 2616 t
10 S f
(_)1342 2616 w
10 R f
( multiplex id */)3 639(mid; /*)1 494 2 1392 2616 t
(BYTE smb)1 578 1 764 2736 t
10 S f
(_)1342 2736 w
10 R f
( count of 16-bit words that follow */)7 1508(wct; /*)1 494 2 1392 2736 t
(WORD smb)1 622 1 720 2856 t
10 S f
(_)1342 2856 w
10 R f
( variable number of 16-bit words */)6 1468(vwv[]; /*)1 494 2 1392 2856 t
(WORD smb)1 622 1 720 2976 t
10 S f
(_)1342 2976 w
10 R f
( count of bytes that follow */)6 1203(bcc; /*)1 494 2 1392 2976 t
(BYTE smb)1 578 1 764 3096 t
10 S f
(_)1342 3096 w
10 R f
( variable number of bytes */)5 1163(buf[]; /*)1 494 2 1392 3096 t
(The structure de\256ned from smb)4 1327 1 720 3396 t
10 S f
(_)2047 3396 w
10 R f
( smb)1 210(idf through)1 464 2 2097 3396 t
10 S f
(_)2771 3396 w
10 R f
(wct is the \256xed portion of the SMB structure some-)9 2219 1 2821 3396 t
( the header there is a variable number of words \(de\256ned)10 2317( Following)1 479( SMB header.)2 570(times referred to as the)4 954 4 720 3516 t
(by smb)1 300 1 720 3636 t
10 S f
(_)1020 3636 w
10 R f
(wct\) and following that is smb)5 1259 1 1070 3636 t
10 S f
(_)2329 3636 w
10 R f
(bcc which de\256nes an additional variable number of bytes.)8 2368 1 2379 3636 t
(A BYTE is 8 bits.)4 752 1 1080 3936 t
(A WORD is two BYTEs.)4 1051 1 1080 4056 t
(The BYTEs within a WORD are ordered such that the low BYTE precedes the high)14 3461 1 1080 4176 t
(BYTE.)1080 4296 w
(A DWORD is two WORDs.)4 1167 1 1080 4416 t
(The WORDs within a DWORD are ordered such that the low WORD precedes the)13 3410 1 1080 4536 t
(high WORD.)1 541 1 1080 4656 t
(smb)720 4872 w
10 S f
(_)887 4872 w
10 R f
(com: - command code.)3 939 1 937 4872 t
(smb)720 5028 w
10 S f
(_)887 5028 w
10 R f
(rcls: - error class \(see below\).)5 1219 1 937 5028 t
(smb)720 5184 w
10 S f
(_)887 5184 w
10 R f
(ret: - error returned \(see below\).)5 1318 1 937 5184 t
(smb)720 5340 w
10 S f
(_)887 5340 w
10 R f
( below\))1 310( \(see)1 226(tid: - Used by the server to identify a resource \(e.g., a disk sub-tree\).)13 2828 3 937 5340 t
(smb)720 5496 w
10 S f
(_)887 5496 w
10 R f
( a process)2 435( by the consumer \(redirector\) to uniquely identify)7 2117( Generated)1 487(pid: - caller's process id.)4 1064 4 937 5496 t
( the same value in)4 861( response message will always contain)5 1719( A)1 166(within the consumer's system.)3 1324 4 970 5616 t
(smb)970 5736 w
10 S f
(_)1137 5736 w
10 R f
(pid \(and smb)2 538 1 1187 5736 t
10 S f
(_)1725 5736 w
10 R f
(mid\) as in the corresponding request message.)6 1892 1 1775 5736 t
(smb)720 5892 w
10 S f
(_)887 5892 w
10 R f
( Circuit \(VC\) nor-)3 775(mid: - this \256eld is used for multiplexing multiple messages on a single Virtual)13 3328 2 937 5892 t
(mally when multiple requests are from the same process. The PID \(in smb)12 3133 1 970 6012 t
10 S f
(_)4103 6012 w
10 R f
( \(in)1 149(pid\) and the MID)3 738 2 4153 6012 t
(smb)970 6132 w
10 S f
(_)1137 6132 w
10 R f
( to correlate incoming)3 993(mid\) uniquely identify a request and are used by the consumer)10 2860 2 1187 6132 t
(responses to previously sent requests.)4 1533 1 970 6252 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 3 3
%%Page: 4 4
save
mark
4 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 4 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(3. NOTES:)1 514 1 720 840 t
10 R f
(1. smb)1 417 1 720 996 t
10 S f
(_)1137 996 w
10 R f
(\257g can have the following values:)5 1391 1 1187 996 t
( \(returned\) from the server in the Negotiate response protocol, this bit indicates that the)14 3620( When set)2 417(bit0 -)1 283 3 720 1152 t
(server supports the)2 802 1 970 1272 t
10 S1 f
(")1821 1272 w
10 R f
(sub dialect)1 454 1 1862 1272 t
10 S1 f
(")2316 1272 w
10 R f
(consisting of the LockandRead and WriteandUnlock protocols)6 2634 1 2406 1272 t
(de\256ned in the SMB File Sharing Protocol Extension version 2.0 , document version 3.2)13 3598 1 970 1392 t
( the server\), the consumer guarantees that there is a)9 2134( When on \(on a protocol request being sent to)9 1903(bit1 -)1 283 3 720 1668 t
(receive buffer posted such that a)5 1423 1 970 1788 t
10 S1 f
(")2444 1788 w
10 R f
(Send.No.Ack)2485 1788 w
10 S1 f
(")3023 1788 w
10 R f
( used by the server to respond to the)8 1642(can be)1 283 2 3115 1788 t
( LANMAN 2.0 Redirector for OS/2 will not set this bit.)10 2307( The)1 221(consumer's request.)1 806 3 970 1908 t
( Reserved \(must be zero\).)4 1054(bit2 -)1 283 2 720 2184 t
( off, the pathnames)3 816( When)1 313( be treated as caseless.)4 962( When on, all pathnames in the protocol must)8 1946(bit3 -)1 283 5 720 2496 t
( forwarding of the protocol message on various extended VCs)9 2719( allows)1 314( This)1 264(are case sensitive.)2 773 4 970 2616 t
( LANMAN 2.0 Redirector for OS/2 will always have)8 2271( The)1 231(where caseless may not be the norm.)6 1568 3 970 2736 t
(this bit on to indicate caseless pathnames.)6 1716 1 970 2856 t
( on \(on the Session Setup and X protocol de\256ned later in this document\), all paths sent to)17 3763( When)1 274(bit4 -)1 283 3 720 3132 t
( means that)2 471( This)1 244( format used by OS/2.)4 912(the server by the consumer are already in the canonicalized)9 2443 4 970 3252 t
(\256le/directory names are in upper case, are valid characters and backslashes are used as seperators.)14 4010 1 970 3372 t
( this indicates that the consumer is)6 1485( When on \(on core protocols Open, Create and Make New\),)10 2552(bit5 -)1 283 3 720 3648 t
(requesting that the \256le be)4 1074 1 970 3768 t
10 S1 f
(")2085 3768 w
10 R f
(opportunisticaly)2126 3768 w
10 S1 f
(")2776 3768 w
10 R f
( has)1 173(locked if this process is the only process which)8 2009 2 2858 3768 t
( the server)2 443( If)1 138(the \256le open at the time of the open request.)9 1879 3 970 3888 t
10 S1 f
(")3469 3888 w
10 R f
(grants)3510 3888 w
10 S1 f
(")3754 3888 w
10 R f
( request, then this)3 750(this oplock)1 456 2 3834 3888 t
( coresponding response protocol to indicate to the consumer that the)10 2894(bit should remain set in the)5 1176 2 970 4008 t
( granted. See the discussion of)5 1270(oplock request was)2 785 2 970 4128 t
10 S1 f
(")3061 4128 w
10 R f
(oplock)3102 4128 w
10 S1 f
(")3374 4128 w
10 R f
(in the sections de\256ning the)4 1116 1 3451 4128 t
10 S1 f
(")4603 4128 w
10 R f
(Open and)1 396 1 4644 4128 t
(X)970 4248 w
10 S1 f
(")1042 4248 w
10 R f
(and)1122 4248 w
10 S1 f
(")1305 4248 w
10 R f
(Locking and X)2 627 1 1346 4248 t
10 S1 f
(")1973 4248 w
10 R f
( bit 1)2 232(protocols later in this document \(this bit has the same function as)11 2755 2 2053 4248 t
(of smb)1 283 1 970 4368 t
10 S f
(_)1253 4368 w
10 R f
(\257ags of the)2 460 1 1303 4368 t
10 S1 f
(")1796 4368 w
10 R f
(Open and X)2 498 1 1837 4368 t
10 S1 f
(")2335 4368 w
10 R f
(protocol\).)2409 4368 w
( on \(on core protocols Open, Create and Make New\), this indicates that the server should)15 3761( When)1 276(bit6 -)1 283 3 720 4644 t
( If)1 142( the \256le \(delete, setattrib, rename, etc.\).)6 1668(notify the consumer on any action which can modify)8 2260 3 970 4764 t
( the discussion of)3 739( See)1 216( need only notify the consumer on another open request.)9 2372(not set, the server)3 743 4 970 4884 t
10 S1 f
(")970 5004 w
10 R f
(oplock)1011 5004 w
10 S1 f
(")1283 5004 w
10 R f
(in the sections de\256ning the)4 1144 1 1367 5004 t
10 S1 f
(")2554 5004 w
10 R f
(Open and X)2 518 1 2595 5004 t
10 S1 f
(")3113 5004 w
10 R f
(and)3197 5004 w
10 S1 f
(")3384 5004 w
10 R f
( X)1 114(Locking and)1 520 2 3425 5004 t
10 S1 f
(")4059 5004 w
10 R f
(protocols later in this)3 898 1 4142 5004 t
(document \(this bit has the same function as bit 2 of smb)11 2323 1 970 5124 t
10 S f
(_)3293 5124 w
10 R f
(\257ags of the)2 460 1 3343 5124 t
10 S1 f
(")3836 5124 w
10 R f
(Open and X)2 498 1 3877 5124 t
10 S1 f
(")4375 5124 w
10 R f
(protocol\).)4449 5124 w
( When on, this protocol is being sent from the server in response to a consumer request. The)17 4037(bit7 -)1 283 2 720 5400 t
(smb)970 5520 w
10 S f
(_)1137 5520 w
10 R f
( in a protocol request from the consu-)7 1598(com \(command\) \256eld usually contains the same value)7 2255 2 1187 5520 t
( bit unambi-)2 515( This)1 249(mer to the server as in the matching response from the server to the consumer.)14 3306 3 970 5640 t
( multiplexed VC)2 703( a)1 88( On)1 199(guously distinguishes the command request from the command response.)8 3080 4 970 5760 t
( consumer are active, this bit can be used by the node's SMB)12 2666(on a node where both server and)6 1404 2 970 5880 t
( identify whether this protocol should be routed to a waiting consumer pro-)12 3110(delivery system to help)3 960 2 970 6000 t
(cess or to the server.)4 849 1 970 6120 t
(2. smb)1 417 1 720 6396 t
10 S f
(_)1137 6396 w
10 R f
(\257g2 can have the following values:)5 1441 1 1187 6396 t
( When set by the consumer, the running application understands OS/2 1.2 style \256le names.)14 3728(bit0 -)1 283 2 720 6672 t
( When set by the consumer, the running application understands extended attributes.)11 3458(bit1 -)1 283 2 720 6948 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 4 4
%%Page: 5 5
save
mark
5 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 5 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
( bit15 - Reserved \(MBZ\).)4 1050(bit2 through)1 561 2 720 840 t
(3. smb)1 417 1 720 1116 t
10 S f
(_)1137 1116 w
10 R f
( extended protocol when the server)5 1459( is used by the LANMAN 1.0)6 1251( It)1 130(uid is the user identi\256er.)4 1013 4 1187 1116 t
(is executing in)2 605 1 970 1236 t
10 S1 f
(")1611 1236 w
10 R f
(user level security mode)3 1006 1 1652 1236 t
10 S1 f
(")2658 1236 w
10 R f
(to validate access on protocols which reference symbol-)7 2306 1 2734 1236 t
( differing users accessing the same TID may be)8 2055( Thus)1 278( \256le open\).)2 470(icly named resources \(such as)4 1267 4 970 1356 t
( resources de\256ned by the TID based on smb)8 1984(granted differing access to the)4 1322 2 970 1476 t
10 S f
(_)4276 1476 w
10 R f
(uid. The UID is)3 714 1 4326 1476 t
( fol-)1 181( UID must be used in all SMB's)7 1363( This)1 247(returned by the server via the Session Set Up protocol.)9 2279 4 970 1596 t
(lowing Session Set Up And X.)5 1268 1 970 1716 t
( extended protocol environment the TID represents an instance of an authen-)11 3194( the LANMAN 2.0)3 793(4. In)1 333 3 720 1992 t
( successful NET USE to a server using a valid netname and)11 2563( is the result of a)5 753( This)1 287(ticated use.)1 467 4 970 2112 t
(password \(if any\).)2 739 1 970 2232 t
(If the server is executing in a)6 1236 1 970 2472 t
10 S1 f
(")2244 2472 w
10 R f
(share level security mode)3 1056 1 2285 2472 t
10 S1 f
(")3341 2472 w
10 R f
( is the only thing used to allow)7 1329(, the tid)2 329 2 3382 2472 t
( if the user is able to perform a successful NET USE to the)13 2551( Thus)1 275(access to the shared resource.)4 1244 3 970 2592 t
(server specifying the appropriate netname and passwd \(if any\) the resource may be accessed)13 4070 1 970 2712 t
( access rights associated with the shared resource \(same for all who gained access)13 3403(according to the)2 667 2 970 2832 t
(this way\).)1 402 1 970 2952 t
( in)1 112(If however the server is executing)5 1394 2 970 3192 t
10 S1 f
(")2510 3192 w
10 R f
(user level security mode)3 1000 1 2551 3192 t
10 S1 f
(")3551 3192 w
10 R f
(, access to the resource is based on)7 1448 1 3592 3192 t
( access)1 300(the UID \(validated on the Session Setup protocol\) and the TID is NOT associated with)14 3770 2 970 3312 t
(control but rather merely de\256nes the resource \(such as the shared directory tree\).)12 3306 1 970 3432 t
(In most SMB protocols, smb)4 1206 1 970 3672 t
10 S f
(_)2176 3672 w
10 R f
( a)1 83( include prior to getting)4 996( Exceptions)1 515(tid must contain a valid TID.)5 1220 4 2226 3672 t
( NEGOTIATE, TREE CONNECT, SESS)4 2022(TID established including)2 1218 2 970 3792 t
10 S f
(_)4210 3792 w
10 R f
(SETUPandX and)1 780 1 4260 3792 t
(TREE)970 3912 w
10 S f
(_)1220 3912 w
10 R f
( exceptions include QUERY)3 1188( Other)1 301(CONNandX protocols.)1 937 3 1270 3912 t
10 S f
(_)3696 3912 w
10 R f
(SRV)3746 3912 w
10 S f
(_)3941 3912 w
10 R f
( forms of the)3 564(INFO some)1 485 2 3991 3912 t
( de\256ned as 0xFFFF. The server is respon-)7 1735( NULL TID is)3 607( A)1 141(TRANSACTION protocol and ECHO.)3 1587 4 970 4032 t
(sible for enforcing use of a valid TID where appropriate.)9 2332 1 970 4152 t
( the core, smb)3 593( in)1 113(5. As)1 361 3 720 4428 t
10 S f
(_)1787 4428 w
10 R f
( inform servers of the)4 903( Consumers)1 519(pid uniquely identi\256es a consumer process.)5 1781 3 1837 4428 t
( a new smb)3 491(creation of a new process by simply introducing)7 2020 2 970 4548 t
10 S f
(_)3481 4548 w
10 R f
(pid value into the dialogue \(for new)6 1509 1 3531 4548 t
(processes\).)970 4668 w
(In the core protocol however, the)5 1369 1 970 4908 t
10 S1 f
(")2373 4908 w
10 R f
(Process Exit)1 506 1 2414 4908 t
10 S1 f
(")2920 4908 w
10 R f
(protocol was used to indicate the catastrophic ter-)7 2045 1 2995 4908 t
( the single tasking DOS system, it was possible for hard)10 2435( In)1 161( session\).)1 392(mination of a process \(or)4 1082 4 970 5028 t
( a Process)2 431( Thus)1 274( causing the destruction of the process with \256les remaining open.)10 2754(errors to occur)2 611 4 970 5148 t
( this occurrence to allow the server to close all \256les opened by that pro-)14 2976(Exit protocol was used for)4 1094 2 970 5268 t
(cess.)970 5388 w
(In the LANMAN 2.0 extended protocol, no)6 1838 1 970 5628 t
10 S1 f
(")2851 5628 w
10 R f
(Process Exit)1 515 1 2892 5628 t
10 S1 f
(")3407 5628 w
10 R f
( operating)1 420( The)1 231(protocol will be sent.)3 898 3 3491 5628 t
(system will ensure that the)4 1114 1 970 5748 t
10 S1 f
(")2121 5748 w
10 R f
(close Protocol)1 581 1 2162 5748 t
10 S1 f
(")2743 5748 w
10 R f
( process referencing the \256le)4 1146(will be sent when the last)5 1073 2 2821 5748 t
( the server's point of view, there is no concept of FIDs)11 2333( From)1 289(closes it.)1 364 3 970 5868 t
10 S1 f
(")3995 5868 w
10 R f
(belonging to)1 517 1 4036 5868 t
10 S1 f
(")4553 5868 w
10 R f
(processes.)4633 5868 w
( any other process using the same VC)7 1562(A FID returned by the server to one process may be used by)12 2508 2 970 5988 t
( is no)2 239(and TID. There)2 637 2 970 6108 t
10 S1 f
(")1882 6108 w
10 R f
(birth announcement)1 807 1 1923 6108 t
10 S1 f
(")2730 6108 w
10 R f
(\(no)2807 6108 w
10 S1 f
(")2976 6108 w
10 R f
(fork)3017 6108 w
10 S1 f
(")3183 6108 w
10 R f
( is up to the)4 511( It)1 130(protocol\) sent to the server.)4 1139 3 3260 6108 t
( TREE DISCON-)2 745( On)1 200(consumer to ensure only valid processes gain access to FIDs \(and TIDs\).)11 3125 3 970 6228 t
( when the VC environment is terminated\) the server may invalidate any \256les opened by)14 3657(NECT \(or)1 413 2 970 6348 t
(any process within the VC environment using that TID.)8 2287 1 970 6468 t
( the LANMAN 2.0 extended protocol will typically be multi-tasked and will allow)12 3480( using)1 256(6. Systems)1 584 3 720 6744 t
( a multiplex ID \(smb)4 869( Therefore)1 459( requests per task.)3 742(multiple asynchronous input/output)2 1443 4 970 6864 t
10 S f
(_)4483 6864 w
10 R f
(mid\) is used)2 507 1 4533 6864 t
(\(along with smb)2 672 1 970 6984 t
10 S f
(_)1642 6984 w
10 R f
( the consumer's)2 656(pid\) to allow multiplexing the single consumer/server VC among)8 2692 2 1692 6984 t
(multiple processes, threads and requests per thread.)6 2099 1 970 7104 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 5 5
%%Page: 6 6
save
mark
6 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 6 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
( smb)1 204(The consumer is responsible for ensuring that every request includes a value in the)13 3445 2 970 840 t
10 S f
(_)4619 840 w
10 R f
(mid \256eld)1 371 1 4669 840 t
( the correct request \(at least the smb)7 1536(which will allow the response to be associated with)8 2173 2 970 960 t
10 S f
(_)4679 960 w
10 R f
(pid and)1 311 1 4729 960 t
(smb)970 1080 w
10 S f
(_)1137 1080 w
10 R f
(mid must uniquely identify the request/response relationship system wide\).)8 3065 1 1187 1080 t
( responsible for ensuring that every response contains the same smb)10 2852(The server is)2 541 2 970 1320 t
10 S f
(_)4363 1320 w
10 R f
(mid value \(and)2 627 1 4413 1320 t
(smb)970 1440 w
10 S f
(_)1137 1440 w
10 R f
( consumer may then use the smb)6 1490( The)1 244(pid value\) as its request.)4 1096 3 1187 1440 t
10 S f
(_)4017 1440 w
10 R f
(mid value \(along with)3 973 1 4067 1440 t
(smb)970 1560 w
10 S f
(_)1137 1560 w
10 R f
(pid value\) for associating requests and responses and may have up to the negotiated number)14 3853 1 1187 1560 t
(of requests outstanding at any time on a multiplexed \256le server VC.)11 2791 1 970 1680 t
( LANMAN 2.0 extended protocol enhances the semantics of the pathname.)10 3085(7. The)1 405 2 720 1956 t
(Two special pathname component values \320\320)5 1932 1 970 2196 t
10 S1 f
(")2939 2196 w
10 R f
(.)2980 2196 w
10 S1 f
(")3005 2196 w
10 R f
(and)3083 2196 w
10 S1 f
(")3264 2196 w
10 R f
(..)3305 2196 w
10 S1 f
(")3355 2196 w
10 R f
( may)1 210( There)1 302(\320\320 must be recognized.)3 1062 3 3466 2196 t
( the standard meanings \320\320)4 1243( have)1 239( They)1 289(be multiple of these components in a path name.)8 2142 4 970 2316 t
10 S1 f
(")4933 2316 w
10 R f
(.)4974 2316 w
10 S1 f
(")4999 2316 w
10 R f
(points to its own directory,)4 1107 1 970 2436 t
10 S1 f
(")2110 2436 w
10 R f
(..)2151 2436 w
10 S1 f
(")2201 2436 w
10 R f
(points to its directory's parent.)4 1256 1 2275 2436 t
( to ensure that the)4 770(Note that it is the server's responsibility)6 1683 2 970 2676 t
10 S1 f
(")3463 2676 w
10 R f
(..)3504 2676 w
10 S1 f
(")3554 2676 w
10 R f
(can not be used to gain access to)7 1405 1 3635 2676 t
(\256les/directories above the)2 1042 1 970 2796 t
10 S1 f
(")2045 2796 w
10 R f
(virtual root)1 455 1 2086 2796 t
10 S1 f
(")2541 2796 w
10 R f
(as de\256ned by the Tree Connect \(TID\).)6 1569 1 2615 2796 t
( 2.0 extended protocol requests and responses are variable length \(as was true)12 3239( new LANMAN)2 676(8. The)1 405 3 720 3072 t
(in)970 3192 w
10 S1 f
(")1092 3192 w
10 R f
(core)1133 3192 w
10 S1 f
(")1304 3192 w
10 R f
( added in the smb)4 777(\). Thus additional words may be)5 1388 2 1345 3192 t
10 S f
(_)3510 3192 w
10 R f
(vwv[] area in the future as well as)7 1480 1 3560 3192 t
( the smb)2 375(additional bytes added within)3 1231 2 970 3312 t
10 S f
(_)2576 3312 w
10 R f
( must be implemented such that addi-)6 1607( Servers)1 375(buf[] area.)1 432 3 2626 3312 t
( additional \256elds are)3 867( If)1 142( of these areas will not cause the command to fail.)10 2179(tional \256elds in either)3 882 4 970 3432 t
( they should)2 523(encountered which are not recognized by the server's level of SMB implementation,)11 3547 2 970 3552 t
( upgrade of the protocol and eliminates the need for)9 2218(be ignored. This allows for future)5 1432 2 970 3672 t
10 S1 f
(")4662 3672 w
10 R f
(reserved)4703 3672 w
(\256elds)970 3792 w
10 S1 f
(")1187 3792 w
10 R f
(.)1228 3792 w
( contents of response parameters is not guaranteed in the case of an error return \(any protocol)16 3915(9. The)1 405 2 720 4068 t
( have smb)2 435(response with an error set in the SMB header may)9 2143 2 970 4188 t
10 S f
(_)3548 4188 w
10 R f
(wct of zero and smb)4 869 1 3598 4188 t
10 S f
(_)4467 4188 w
10 R f
(bcc count of)2 523 1 4517 4188 t
(zero\).)970 4308 w
( error class has been)4 892( LANMAN 2.0 extended protocol has been negotiated, the ERRDOS)9 2940(10. When)1 488 3 720 4584 t
( such,)1 249( As)1 185( system.)1 344(expanded to include all errors which may be generated by the OS/2 operating)12 3292 4 970 4704 t
( values de\256ned for error class ERRDOS in this document are a subset of the possi-)15 3493(the error code)2 577 2 970 4824 t
( documentation for the complete set of possible)7 2014( the OS/2 operating system)4 1155( See)1 220(ble error values.)2 681 4 970 4944 t
(OS/2 \(ERRDOS\) error codes.)3 1211 1 970 5064 t
(These semantic changes apply to all)5 1539 1 720 5460 t
10 S1 f
(")2305 5460 w
10 R f
(core)2346 5460 w
10 S1 f
(")2517 5460 w
10 R f
( there are)2 412( Where)1 344(requests used by the extended protocol.)5 1680 3 2604 5460 t
( server having negotiated LAN-)4 1357( The)1 235( requests.)1 399(additional changes, they are documented with the new)7 2329 4 720 5580 t
(MAN 2.0 is expected to still support all LANMAN 1.0 and core protocol requests.)13 3400 1 720 5700 t
( be supported in the LANMAN 2.0)6 1599(The following are the core protocol requests which must still)9 2721 2 720 6060 t
( See)1 236(extended protocol without change.)3 1483 2 720 6180 t
10 S1 f
(")2498 6180 w
10 R f
(File Sharing Protocol)2 922 1 2539 6180 t
10 S1 f
(")3461 6180 w
10 R f
(Intel Part number 136329-001 for)4 1480 1 3560 6180 t
(detailed explanation of each protocol request/response.)5 2235 1 720 6300 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 6 6
%%Page: 7 7
save
mark
7 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 7 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
(TREE CONNECT)1 755 1 1080 900 t
(TREE DISCONNECT)1 916 1 1080 1020 t
(OPEN FILE)1 505 1 1080 1140 t
(CREATE FILE)1 633 1 1080 1260 t
(CLOSE FILE)1 561 1 1080 1380 t
(FLUSH FILE)1 561 1 1080 1500 t
(READ)1080 1620 w
(WRITE)1080 1740 w
(SEEK)1080 1860 w
(CREATE DIRECTORY)1 994 1 1080 1980 t
(DELETE DIRECTORY)1 982 1 1080 2100 t
(DELETE FILE)1 621 1 1080 2220 t
(RENAME FILE)1 666 1 1080 2340 t
(GET FILE ATTRIBUTES)2 1082 1 1080 2460 t
(SET FILE ATTRIBUTES)2 1066 1 1080 2580 t
(LOCK RECORD)1 711 1 1080 2700 t
(UNLOCK RECORD)1 855 1 1080 2820 t
(CREATE TEMPORARY FILE \(no longer used by LANMAN 2.0 Redirector\))9 3202 1 1080 2940 t
( longer used by LANMAN 2.0 Redirector\))6 1753( \(no)1 356(PROCESS EXIT)1 695 3 1080 3060 t
(MAKE NEW FILE)2 798 1 1080 3180 t
(CHECK PATH)1 633 1 1080 3300 t
(GET SERVER ATTRIBUTES)2 1255 1 1080 3420 t
(NEGOTIATE PROTOCOL \(additional \256elds in response if LANMAN 2.0 negotiated\))9 3540 1 1080 3540 t
(FILE SEARCH)1 639 1 1080 3660 t
(CREATE PRINT FILE)2 955 1 1080 3780 t
(CLOSE PRINT FILE)2 883 1 1080 3900 t
(WRITE PRINT FILE)2 882 1 1080 4020 t
(\(core Message Commands are also supported\))5 1883 1 1080 4140 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 7 7
%%Page: 8 8
save
mark
8 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 8 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
( LANMAN 1.0 extended protocol requests which must still be supported in the)12 3401(The following are the)3 919 2 720 840 t
( Protocol Extensions Version)3 1217( SMB File Sharing)3 805( See)1 219(LANMAN 2.0 extended protocol without change.)5 2079 4 720 960 t
( detailed explanation of each protocol request/response.)6 2268( for)1 182(2.0, doument version 3.2,)3 1043 3 720 1080 t
(SESS)1080 1260 w
10 S f
(_)1309 1260 w
10 R f
( is another valid protocol request e.g. TREE)7 1812(SETUPandX \(X)1 906 2 1359 1260 t
10 S f
(_)4077 1260 w
10 R f
(CONNandX\))4127 1260 w
(TREE)1080 1380 w
10 S f
(_)1330 1380 w
10 R f
( is another valid protocol request e.g. OPEN\))7 1856(CONNandX \(X)1 885 2 1380 1380 t
( is another valid protocol request e.g. READ\))7 1867(OPENandX \(X)1 825 2 1080 1500 t
( is another valid protocol request e.g. CLOSE\))7 1912(READandX \(X)1 825 2 1080 1620 t
( is another valid protocol request e.g. READ\))7 1867(WRITEandX \(X)1 825 2 1080 1740 t
( OS/2 form of FILE SEARCH\))5 1287(FIND \(matches)1 720 2 1080 1860 t
(FIND)1080 1980 w
10 S f
(_)1313 1980 w
10 R f
( OS/2 form of FILE SEARCH\))5 1287(UNIQUE \(matches)1 797 2 1363 1980 t
(FIND)1080 2100 w
10 S f
(_)1313 2100 w
10 R f
( OS/2 form of FILE SEARCH\))5 1287(CLOSE \(matches)1 797 2 1363 2100 t
(READ)1080 2220 w
10 S f
(_)1352 2220 w
10 R f
(BLOCK)1402 2220 w
10 S f
(_)1741 2220 w
10 R f
( larger than negotiated buffer size request raw\))7 1919(RAW \(read)1 573 2 1791 2220 t
(READ)1080 2340 w
10 S f
(_)1352 2340 w
10 R f
(BLOCK)1402 2340 w
10 S f
(_)1741 2340 w
10 R f
( larger than negotiated buffer size request multiplexed\))7 2248(MPX \(read)1 573 2 1791 2340 t
(WRITE)1080 2460 w
10 S f
(_)1396 2460 w
10 R f
(BLOCK)1446 2460 w
10 S f
(_)1785 2460 w
10 R f
( larger than negotiated buffer size request raw\))7 1919(RAW \(write)1 563 2 1835 2460 t
(WRITE)1080 2580 w
10 S f
(_)1396 2580 w
10 R f
(BLOCK)1446 2580 w
10 S f
(_)1785 2580 w
10 R f
( larger than negotiated buffer size request multiplexed\))7 2248(MPX \(write)1 563 2 1835 2580 t
(GET)1080 2700 w
10 S f
(_)1274 2700 w
10 R f
(E)1324 2700 w
10 S f
(_)1385 2700 w
10 R f
(FILE)1435 2700 w
10 S f
(_)1646 2700 w
10 R f
( new OS/2 system call\))4 959(ATTR \(accommodate)1 1051 2 1696 2700 t
(SET)1080 2820 w
10 S f
(_)1258 2820 w
10 R f
(E)1308 2820 w
10 S f
(_)1369 2820 w
10 R f
(FILE)1419 2820 w
10 S f
(_)1630 2820 w
10 R f
( new OS/2 system call\))4 959(ATTR \(accommodate)1 1067 2 1680 2820 t
( new OS/2 system call\))4 959(LOCKINGandX \(accommodate)1 1307 2 1080 2940 t
(COPY)1080 3060 w
10 S f
(_)1347 3060 w
10 R f
( when both source and target are remote\))7 1687(FILE \(used)1 619 2 1397 3060 t
(MOVE)1080 3180 w
10 S f
(_)1374 3180 w
10 R f
( when both source and target are remote\))7 1687(FILE \(used)1 592 2 1424 3180 t
( IOCTL request on to server and retrieve results\))8 2009(IOCTL \(pass)1 565 2 1080 3300 t
( bytes in/out associated with name\))5 1447(TRANSACTION \(allows)1 1014 2 1080 3420 t
( sent data back\))3 647(ECHO \(echo)1 581 2 1080 3540 t
( \256nal bytes then close \256le\))5 1092(WRITEandCLOSE \(write)1 1318 2 1080 3660 t
( bytes then Read locked bytes\))5 1263(LOCKandREAD \(Lock)1 958 2 1080 3780 t
( bytes then Unlock bytes\))4 1053(WRITEandUnlock \(Write)1 1340 2 1080 3900 t
(Of the LANMAN 1.0 extended protocols, only the SESS)8 2468 1 720 4200 t
10 S f
(_)3188 4200 w
10 R f
( the COPY)2 489(SETUPandX request and)2 1052 2 3238 4200 t
10 S f
(_)4779 4200 w
10 R f
(FILE)4829 4200 w
( LANMAN 2.0 protocol has been negotiated. The format of these)10 2837(SMB have extended features when)4 1483 2 720 4320 t
( been negotiated is compatible with)5 1553(SMBs, and their functionality when LANMAN 1.0 protocol has)8 2767 2 720 4440 t
( The)1 227( new features when LANMAN 2.0 protocol is negotiated.)8 2413(LANMAN 1.0 protocol but will support)5 1680 3 720 4560 t
(extended features of SESS)3 1086 1 720 4680 t
10 S f
(_)1806 4680 w
10 R f
(SETUPandX and COPY)2 999 1 1856 4680 t
10 S f
(_)2855 4680 w
10 R f
(FILE SMBs are detailed later in this document.)7 1949 1 2905 4680 t
( the)1 167( However,)1 468( LANMAN 2.0 extended protocol is mandatory.)6 2045(Support of all core requests within the)6 1640 4 720 4920 t
( by the OS/2 implementation of the redirector when)8 2168(following core requests will no longer be generated)7 2152 2 720 5040 t
(LANMAN 1.0 or LANMAN 2.0 extended protocol has been negotiated.)9 2961 1 720 5160 t
(PROCESS EXIT)1 695 1 1080 5340 t
(CREATE TEMPORARY FILE)2 1283 1 1080 5460 t
(CREATE PRINT FILE)2 955 1 1080 5580 t
(CLOSE PRINT FILE)2 883 1 1080 5700 t
(WRITE PRINT FILE)2 882 1 1080 5820 t
( protocol format change to a core protocol service is that the response to the negotiate protocol)16 3952(The only)1 368 2 720 6120 t
( the)1 160(\(NEGOTIATE PROTOCOL\) will contain additional \256elds if)6 2521 2 720 6240 t
10 S1 f
(")3439 6240 w
10 R f
(LM1.2X002)3480 6240 w
10 S1 f
(")3977 6240 w
10 R f
(string has been selected)3 984 1 4056 6240 t
( additional)1 434( The)1 282( placing the session into LANMAN 2.0 extended protocol.)8 2414(by the server thus effectively)4 1190 4 720 6360 t
(\256elds returned will be documented in detail later in this document.)10 2736 1 720 6480 t
( protocol requests within the LANMAN 2.0 extended protocol have a new command value)13 3939(All other)1 381 2 720 6720 t
( the protocol)2 537( the server need not constantly test)6 1483( Thus)1 275(from that of a similar function in core protocol.)8 2025 4 720 6840 t
( is expected to only submit appropriate requests within the dialect)10 2865( consumer)1 436( The)1 236(version negotiated.)1 783 4 720 6960 t
(negotiated.)720 7080 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 8 8
%%Page: 9 9
save
mark
9 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1678( 9 -)2 149( -)1 1046(SMB Protocol Extensions)2 1056 5 720 520 t
( LANMAN 2.0 extended protocol requests, each will be de\256ned in detail later)12 3231(The following are the new)4 1089 2 720 840 t
(in this document.)2 708 1 720 960 t
(TRANSACT2)1080 1320 w
(FIND)1080 1560 w
10 S f
(_)1313 1560 w
10 R f
(CLOSE)1363 1560 w
(FIND)1080 1680 w
10 S f
(_)1313 1680 w
10 R f
(NOTIFY)1363 1680 w
10 S f
(_)1729 1680 w
10 R f
( a noti\256cation handle\))3 898(CLOSE \(close)1 705 2 1779 1680 t
( a user id\))3 420( \(logoff)1 483(USER LOGOFF and X)3 960 3 1080 1800 t
10 B f
( MODEL)1 411(4. ARCHITECTURAL)1 1030 2 720 2400 t
10 R f
(The Network File Access system fundemental architecture for LANMAN 2.0 is unchanged from the)13 4320 1 720 2676 t
( Extensions Version 2.0, docu-)4 1272(LANMAN 1.0 architecure as described in the SMB File Sharing Protocol)10 3048 2 720 2796 t
(ment version 3.2.)2 710 1 720 2916 t
10 B f
( 1.0 SMB EXTENSIONS)3 1087(5. LANMAN)1 590 2 720 3276 t
10 R f
( and modi\256cations to the LANMAN 1.0)6 1680(This section describes how to negotiate LANMAN 2.0 protocol)8 2640 2 720 3552 t
(SMB extensions which may be used when the LANMAN 2.0 protocol has been negotiated,)13 3752 1 720 3672 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 9 9
%%Page: 10 10
save
mark
10 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 10 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(5.1. NEGOTIATE)1 823 1 720 840 t
10 R f
(Request Format is unchanged in order to remain compatible with earlier versions and the core protocol.)15 4252 1 720 996 t
( only when LANMAN 1.0 dialect or higher is selected\):)9 2307( \(returned)1 431(Enhanced Response Format)2 1131 3 720 1152 t
(BYTE smb)1 578 1 902 1332 t
10 S f
(_)1480 1332 w
10 R f
( value = 13 */)4 582(wct; /*)1 671 2 1530 1332 t
(WORD smb)1 622 1 858 1452 t
10 S f
(_)1480 1452 w
10 R f
( index identifying dialect selected */)5 1491(index; /*)1 671 2 1530 1452 t
(WORD smb)1 622 1 858 1572 t
10 S f
(_)1480 1572 w
10 R f
( security mode:)2 632(secmode; /*)1 671 2 1530 1572 t
( */)1 144( level security.)2 601( Share)1 293(bit 0 - 1 = User level security, 0 =)9 1421 4 2123 1692 t
( not encrypt passwords */)4 1053( do)1 166(bit 1 - 1 = encrypt passwords , 0 =)9 1438 3 2123 1812 t
(WORD smb)1 622 1 858 1932 t
10 S f
(_)1480 1932 w
10 R f
( min */)2 300( 1k)1 166( max transmit buffer size server supports,)6 1703(maxxmt; /*)1 671 4 1530 1932 t
(WORD smb)1 622 1 858 2052 t
10 S f
(_)1480 2052 w
10 R f
( max pending multiplexed requests server supports */)7 2190(maxmux; /*)1 671 2 1530 2052 t
(WORD smb)1 622 1 858 2172 t
10 S f
(_)1480 2172 w
10 R f
( max VCs per server/consumer session supported */)7 2128(maxvcs; /*)1 671 2 1530 2172 t
(WORD smb)1 622 1 858 2292 t
10 S f
(_)1480 2292 w
10 R f
( block read/write mode support :)5 1341(blkmode; /*)1 671 2 1530 2292 t
(bit 0 - Read Block Raw supported \(65,535 bytes max\).)9 2256 1 2123 2412 t
(bit 1 - Write Block Raw supported \(65,535 bytes max\). */)10 2389 1 2123 2532 t
(DWORD smb)1 694 1 786 2652 t
10 S f
(_)1480 2652 w
10 R f
( Session Key \(unique token identifying session\) */)7 2069(sesskey; /*)1 671 2 1530 2652 t
(WORD smb)1 622 1 858 2772 t
10 S f
(_)1480 2772 w
10 R f
(srv)1530 2772 w
10 S f
(_)1652 2772 w
10 R f
( server's current time \(hhhhh mmmmmm xxxxx\))6 2007(time; /*)1 499 2 1702 2772 t
(where 'xxxxx' is in two second increments */)7 1878 1 2123 2892 t
(WORD smb)1 622 1 858 3012 t
10 S f
(_)1480 3012 w
10 R f
(srv)1530 3012 w
10 S f
(_)1652 3012 w
10 R f
( server's current date \(yyyyyyy mmmm ddddd\) */)7 2050(date; /*)1 499 2 1702 3012 t
(WORD smb)1 622 1 858 3132 t
10 S f
(_)1480 3132 w
10 R f
(srv)1530 3132 w
10 S f
(_)1652 3132 w
10 R f
( server's current time zone */)5 1206(tzone; /*)1 499 2 1702 3132 t
(DWORD smb)1 694 1 786 3252 t
10 S f
(_)1480 3252 w
10 R f
( reserved */)2 481(rsvd; /*)1 671 2 1530 3252 t
(WORD smb)1 622 1 858 3372 t
10 S f
(_)1480 3372 w
10 R f
( value = \(size of smb)5 875(bcc; /*)1 671 2 1530 3372 t
10 S f
(_)3076 3372 w
10 R f
(cryptkey\) */)1 493 1 3126 3372 t
(BYTE smb)1 578 1 902 3492 t
10 S f
(_)1480 3492 w
10 R f
( Key used for password encryption */)6 1545(cryptkey[]; /*)1 671 2 1530 3492 t
( following protocol strings are now)5 1562( The)1 244( unchanged from LANMAN 1.0.)4 1438(This protocol function is)3 1076 4 720 3708 t
(accepted:)720 3828 w
(PC NETWORK PROGRAM 1.0)3 1341 1 1080 4128 t
(PCLAN1.0)1080 4248 w
(MICROSOFT NETWORKS 1.03)2 1369 1 1080 4368 t
(MICROSOFT NETWORKS 3.0)2 1319 1 1080 4488 t
(LANMAN1.0)1080 4608 w
(LM1.2X002)1080 4728 w
(DOS LM1.2X002)1 730 1 1080 4848 t
( except)1 299(The meaning of all protocol strings)5 1472 2 720 5148 t
10 S1 f
(")2530 5148 w
10 R f
(LM1.2X002)2571 5148 w
10 S1 f
(")3068 5148 w
10 R f
(and)3148 5148 w
10 S1 f
(")3331 5148 w
10 R f
(DOS LM1.2X002)1 736 1 3372 5148 t
10 S1 f
(")4108 5148 w
10 R f
(are described in ear-)3 852 1 4188 5148 t
( wishing to use Lanman 2.0 extensions)6 1702( running versions of MS-DOS and)5 1504( Machines)1 472(lier documents.)1 642 4 720 5268 t
(should negotiate the protocol)3 1250 1 720 5388 t
10 S1 f
(")2024 5388 w
10 R f
(DOS LM1.2X002)1 751 1 2065 5388 t
10 S1 f
(")2816 5388 w
10 R f
( 2.0)1 180( other workstations using the LANMAN)5 1763(. All)1 240 3 2857 5388 t
(extensions should use the protocol string)5 1670 1 720 5508 t
10 S1 f
(")2423 5508 w
10 R f
(LM1.2X002)2464 5508 w
10 S1 f
(")2961 5508 w
10 R f
(.)3002 5508 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 10 10
%%Page: 11 11
save
mark
11 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 11 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( SETUP and X)3 656(5.2. SESSION)1 640 2 720 840 t
10 R f
(Request Format:)1 672 1 720 996 t
(BYTE smb)1 578 1 869 1176 t
10 S f
(_)1447 1176 w
10 R f
( value = 10 */)4 582(wct; /*)1 710 2 1497 1176 t
(BYTE smb)1 578 1 869 1296 t
10 S f
(_)1447 1296 w
10 R f
( secondary \(X\) command, 0xFF = none */)7 1732(com2; /*)1 710 2 1497 1296 t
(BYTE smb)1 578 1 869 1416 t
10 S f
(_)1447 1416 w
10 R f
( reserved \(must be zero\) */)5 1106(reh2; /*)1 710 2 1497 1416 t
(WORD smb)1 622 1 825 1536 t
10 S f
(_)1447 1536 w
10 R f
( offset \(from SMB hdr start\) to next cmd \()9 1756(off2; /*)1 710 2 1497 1536 t
10 S1 f
(@)3963 1536 w
10 R f
(smb)4055 1536 w
10 S f
(_)4222 1536 w
10 R f
(wct\) */)1 288 1 4272 1536 t
(WORD smb)1 622 1 825 1656 t
10 S f
(_)1447 1656 w
10 R f
( the consumers max buffer size */)6 1395(bufsize; /*)1 710 2 1497 1656 t
(WORD smb)1 622 1 825 1776 t
10 S f
(_)1447 1776 w
10 R f
( actual maximum multiplexed pending requests */)6 2047(mpxmax; /*)1 710 2 1497 1776 t
(WORD smb)1 622 1 825 1896 t
10 S f
(_)1447 1896 w
10 R f
(vc)1497 1896 w
10 S f
(_)1591 1896 w
10 R f
( 0 = \256rst \(only\), non zero - additional VC number */)11 2170(num; /*)1 566 2 1641 1896 t
(DWORD smb)1 694 1 753 2016 t
10 S f
(_)1447 2016 w
10 R f
( Session Key \(valid only if smb)6 1309(sesskey; /*)1 710 2 1497 2016 t
10 S f
(_)3516 2016 w
10 R f
(vc)3566 2016 w
10 S f
(_)3660 2016 w
10 R f
(num != 0\) */)3 527 1 3710 2016 t
(WORD smb)1 622 1 825 2136 t
10 S f
(_)1447 2136 w
10 R f
( size of account password \(smb)5 1290(apasslen; /*)1 710 2 1497 2136 t
10 S f
(_)3497 2136 w
10 R f
(apasswd\) */)1 482 1 3547 2136 t
(WORD smb)1 622 1 825 2256 t
10 S f
(_)1447 2256 w
10 R f
( size of encryption key \(smb)5 1174(encryptlen; /*)1 710 2 1497 2256 t
10 S f
(_)3381 2256 w
10 R f
(encrypt\) */)1 443 1 3431 2256 t
(WORD smb)1 622 1 825 2376 t
10 S f
(_)1447 2376 w
10 R f
( offset \(from SMB hdr start\) to smb)7 1480(encryptoff; /*)1 710 2 1497 2376 t
10 S f
(_)3687 2376 w
10 R f
(encrypt */)1 410 1 3737 2376 t
(WORD smb)1 622 1 825 2496 t
10 S f
(_)1447 2496 w
10 R f
( minimum value = 0 */)5 955(bcc; /*)1 710 2 1497 2496 t
(BYTE smb)1 578 1 869 2616 t
10 S f
(_)1447 2616 w
10 R f
( account password \(* = smb)5 1158(apasswd[*]; /*)1 710 2 1497 2616 t
10 S f
(_)3365 2616 w
10 R f
(apasslen value\) */)2 731 1 3415 2616 t
(BYTE smb)1 578 1 869 2736 t
10 S f
(_)1447 2736 w
10 R f
( account name string */)4 964(aname[]; /*)1 710 2 1497 2736 t
(BYTE smb)1 578 1 869 2856 t
10 S f
(_)1447 2856 w
10 R f
( encryption key. \(* = smb)5 1067(encrypt[*]; /*)1 710 2 1497 2856 t
10 S f
(_)3274 2856 w
10 R f
(encryptlen value\) */)2 814 1 3324 2856 t
(Response Format:)1 733 1 720 3156 t
(BYTE smb)1 578 1 830 3336 t
10 S f
(_)1408 3336 w
10 R f
( value = 3 */)4 532(wct; /*)1 626 2 1458 3336 t
(BYTE smb)1 578 1 830 3456 t
10 S f
(_)1408 3456 w
10 R f
( secondary \(X\) command, 0xFF = none */)7 1732(com2; /*)1 626 2 1458 3456 t
(BYTE smb)1 578 1 830 3576 t
10 S f
(_)1408 3576 w
10 R f
( reserved \(pad to word\) */)5 1073(res2; /*)1 626 2 1458 3576 t
(WORD smb)1 622 1 786 3696 t
10 S f
(_)1408 3696 w
10 R f
( offset \(from SMB hdr start\) to next cmd \()9 1756(off2; /*)1 626 2 1458 3696 t
10 S1 f
(@)3840 3696 w
10 R f
(smb)3932 3696 w
10 S f
(_)4099 3696 w
10 R f
(wct\) */)1 288 1 4149 3696 t
(WORD smb)1 622 1 786 3816 t
10 S f
(_)1408 3816 w
10 R f
( request mode:)2 604(action; /*)1 626 2 1458 3816 t
(bit0 = Logged in successfully - BUT as GUEST */)9 2096 1 2006 3936 t
(WORD smb)1 622 1 786 4056 t
10 S f
(_)1408 4056 w
10 R f
( min value = 0 */)5 721(bcc; /*)1 626 2 1458 4056 t
(BYTE smb)1 578 1 830 4176 t
10 S f
(_)1408 4176 w
10 R f
( server response to request encryption key */)7 1838(encresp[]; /*)1 626 2 1458 4176 t
(Service de\256nition:)1 744 1 720 4392 t
( the connec-)2 511(This protocol function is unchanged from LANMAN 1.0 except that the station establishing)12 3809 2 720 4668 t
( the request was made. The LANMAN 2.0)7 1874(tion may now verify the validity of the server to which)10 2446 2 720 4788 t
(SESS)720 4908 w
10 S f
(_)949 4908 w
10 R f
( DWORD \256eld from the LANMAN 1.0 request to pass the)10 2514(SETUPandX request uses a reserved)4 1527 2 999 4908 t
( server will)2 467( The)1 222( an encryption key contained in the data of the request to the server.)13 2822(length and offset of)3 809 4 720 5028 t
( the smb)2 371(use the encryption key to format)5 1370 2 720 5148 t
10 S f
(_)2461 5148 w
10 R f
(encresp \256eld of the response protocol. The station may then)9 2529 1 2511 5148 t
(use this response to validate the server session.)7 1931 1 720 5268 t
(The LANMAN 2.0 SESS)3 1046 1 720 5544 t
10 S f
(_)1766 5544 w
10 R f
(SETUPandX also returns a UID in the smb)7 1779 1 1816 5544 t
10 S f
(_)3595 5544 w
10 R f
( UID)1 211( is a validated)3 576( This)1 244(uid \256eld.)1 364 4 3645 5544 t
(which must be supplied by the workstation on all subsequent requests to the server.)13 3434 1 720 5664 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 11 11
%%Page: 12 12
save
mark
12 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 12 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(5.3. COPY)1 499 1 720 840 t
10 R f
(Request Format:)1 672 1 720 996 t
(BYTE smb)1 578 1 830 1176 t
10 S f
(_)1408 1176 w
10 R f
( value = 3 */)4 532(wct; /*)1 710 2 1458 1176 t
(WORD smb)1 622 1 786 1296 t
10 S f
(_)1408 1296 w
10 R f
( second \(destination\) path tid */)5 1303(tid2; /*)1 710 2 1458 1296 t
(WORD smb)1 622 1 786 1416 t
10 S f
(_)1408 1416 w
10 R f
( what to do if destination \256le exists */)8 1570(ofun; /*)1 710 2 1458 1416 t
(WORD smb)1 622 1 786 1536 t
10 S f
(_)1408 1536 w
10 R f
( \257ags to control copy operations:)5 1353(\257ags; /*)1 710 2 1458 1536 t
(bit 0 - destination must be a \256le.)7 1345 1 2090 1656 t
(bit 1 - destination must be a directory.)7 1577 1 2090 1776 t
(bit 2 - copy destination mode: 0 = binary, 1 = ASCII.)11 2213 1 2090 1896 t
(bit 3 - copy source mode: 0 = binary, 1 = ASCII.)11 2034 1 2090 2016 t
(bit 4 - verify all writes.)5 961 1 2090 2136 t
(bit 5 - tree copy. Source must be a directory.)9 1849 1 2090 2256 t
(Copy mode must be binary.)4 1140 1 2354 2376 t
(When tree copy is selected smb)5 1301 1 2354 2496 t
10 S f
(_)3655 2496 w
10 R f
(cct \256eld in the)3 593 1 3705 2496 t
(response protocol is unde\256ned.)3 1267 1 2354 2616 t
(bit 6 - Action when source has EA, and dest does not support EAs)13 2745 1 2090 2736 t
(0 = Discard EAs, 1 = Fail copy */)8 1411 1 2354 2856 t
(WORD smb)1 622 1 786 2976 t
10 S f
(_)1408 2976 w
10 R f
( minimum value = 2 */)5 955(bcc; /*)1 710 2 1458 2976 t
(BYTE smb)1 578 1 830 3096 t
10 S f
(_)1408 3096 w
10 R f
( pathname of source \256le */)5 1102(path[]; /*)1 710 2 1458 3096 t
(BYTE smb)1 578 1 830 3216 t
10 S f
(_)1408 3216 w
10 R f
(new)1458 3216 w
10 S f
(_)1624 3216 w
10 R f
( pathname of destination \256le */)5 1281(path[]; /*)1 494 2 1674 3216 t
(Response Format:)1 733 1 720 3396 t
(BYTE smb)1 578 1 830 3576 t
10 S f
(_)1408 3576 w
10 R f
( value = 1 */)4 532(wct; /*)1 565 2 1458 3576 t
(WORD smb)1 622 1 786 3696 t
10 S f
(_)1408 3696 w
10 R f
( number of \256les copied */)5 1064(cct; /*)1 565 2 1458 3696 t
(WORD smb)1 622 1 786 3816 t
10 S f
(_)1408 3816 w
10 R f
( minimum value = 0 */)5 955(bcc; /*)1 565 2 1458 3816 t
(BYTE smb)1 578 1 830 3936 t
10 S f
(_)1408 3936 w
10 R f
( pathname of \256le where error occured - ASCIIZ */)9 2080(err\256le[]; /*)1 565 2 1458 3936 t
(Service:)720 4116 w
( 2.0 is unchanged from LANMAN 1.0 except that the)9 2408(The COPY protocol function for LANMAN)5 1912 2 720 4392 t
( used to specify a tree copy on the remote server. The tree copy mode is selected by)17 3489(request may now be)3 831 2 720 4512 t
(setting bit 5 of the smb)5 960 1 720 4632 t
10 S f
(_)1680 4632 w
10 R f
( copy option is selected the des-)6 1330( the tree)2 337( When)1 304(\257ags word in the COPY request.)5 1339 4 1730 4632 t
( be an existing \256le and the source mode must be binary. A request with bit 5 of the)18 3605(tination must not)2 715 2 720 4752 t
(smb)720 4872 w
10 S f
(_)887 4872 w
10 R f
( the tree copy mode is)5 994( When)1 319( and either bit 0 or bit 3 set is therefore an error.)12 2191(\257ags word set)2 599 4 937 4872 t
(selected the smb)2 676 1 720 4992 t
10 S f
(_)1396 4992 w
10 R f
(cct word of the response protocol is unde\256ned.)7 1925 1 1446 4992 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 12 12
%%Page: 13 13
save
mark
13 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 13 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( PROTOCOL)1 606(6. EXTENDED)1 697 2 720 840 t
10 R f
( of enhanced and new commands is de\256ned commencing at the smb)11 2825(The format)1 455 2 720 996 t
10 S f
(_)4000 996 w
10 R f
( messages)1 412( All)1 196(wct \256eld.)1 382 3 4050 996 t
( an error is encountered a server)6 1398( When)1 316(will include the standard SMB header de\256ned in section 1.0.)9 2606 3 720 1116 t
( header portion of the response \(i.e., smb)7 1735(may choose to return only the)5 1260 2 720 1236 t
10 S f
(_)3715 1236 w
10 R f
(wct and smb)2 535 1 3765 1236 t
10 S f
(_)4300 1236 w
10 R f
(bcc both contain)2 690 1 4350 1236 t
(zero\).)720 1356 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 13 13
%%Page: 14 14
save
mark
14 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 14 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1. TRANSACT2)1 891 1 720 840 t
10 R f
(Primary Request Format:)2 1027 1 720 996 t
(BYTE smb)1 578 1 869 1212 t
10 S f
(_)1447 1212 w
10 R f
( value = \(14 + value of smb)7 1158(wct; /*)1 621 2 1497 1212 t
10 S f
(_)3276 1212 w
10 R f
(suwcnt\) */)1 427 1 3326 1212 t
(WORD smb)1 622 1 825 1332 t
10 S f
(_)1447 1332 w
10 R f
( total number of parameter bytes being sent */)8 1900(tpscnt; /*)1 621 2 1497 1332 t
(WORD smb)1 622 1 825 1452 t
10 S f
(_)1447 1452 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1452 t
(WORD smb)1 622 1 825 1572 t
10 S f
(_)1447 1572 w
10 R f
( max number of parameter bytes to return */)8 1827(mprcnt; /*)1 621 2 1497 1572 t
(WORD smb)1 622 1 825 1692 t
10 S f
(_)1447 1692 w
10 R f
( max number of data bytes to return */)8 1595(mdrcnt; /*)1 621 2 1497 1692 t
(BYTE smb)1 578 1 869 1812 t
10 S f
(_)1447 1812 w
10 R f
( max number of setup words to return */)8 1673(msrcnt; /*)1 621 2 1497 1812 t
(BYTE smb)1 578 1 869 1932 t
10 S f
(_)1447 1932 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 1932 t
(WORD smb)1 622 1 825 2052 t
10 S f
(_)1447 2052 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2052 t
(bit 0 - if set, also disconnect TID in smb)9 1682 1 2040 2172 t
10 S f
(_)3722 2172 w
10 R f
(tid)3772 2172 w
(bit 1 - if set, transaction is one way \(no \256nal response\) */)12 2368 1 2040 2292 t
(DWORD smb)1 694 1 753 2412 t
10 S f
(_)1447 2412 w
10 R f
( number of milliseconds to wait for completion */)8 2052(timeout; /*)1 621 2 1497 2412 t
(WORD smb)1 622 1 825 2532 t
10 S f
(_)1447 2532 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2532 t
(WORD smb)1 622 1 825 2652 t
10 S f
(_)1447 2652 w
10 R f
( number of parameter bytes being sent this buffer */)9 2143(pscnt; /*)1 621 2 1497 2652 t
(WORD smb)1 622 1 825 2772 t
10 S f
(_)1447 2772 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(psoff; /*)1 621 2 1497 2772 t
(WORD smb)1 622 1 825 2892 t
10 S f
(_)1447 2892 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 2892 t
(WORD smb)1 622 1 825 3012 t
10 S f
(_)1447 3012 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3012 t
(BYTE smb)1 578 1 869 3132 t
10 S f
(_)1447 3132 w
10 R f
( set up word count */)5 881(suwcnt; /*)1 621 2 1497 3132 t
(BYTE smb)1 578 1 869 3252 t
10 S f
(_)1447 3252 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3252 t
(WORD smb)1 622 1 825 3372 t
10 S f
(_)1447 3372 w
10 R f
( variable number of set up words \(* = smb)9 1767(setup[*]; /*)1 621 2 1497 3372 t
10 S f
(_)3885 3372 w
10 R f
(suwcnt\) */)1 427 1 3935 3372 t
(WORD smb)1 622 1 825 3492 t
10 S f
(_)1447 3492 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3492 t
(BYTE smb)1 578 1 869 3612 t
10 S f
(_)1447 3612 w
10 R f
( Must be a null byte */)6 948(name[1]; /*)1 621 2 1497 3612 t
(BYTE smb)1 578 1 869 3732 t
10 S f
(_)1447 3732 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3732 t
(BYTE smb)1 578 1 869 3852 t
10 S f
(_)1447 3852 w
10 R f
( param bytes \(* = value of smb)7 1296(param[*]; /*)1 621 2 1497 3852 t
10 S f
(_)3414 3852 w
10 R f
(pscnt\) */)1 355 1 3464 3852 t
(BYTE smb)1 578 1 869 3972 t
10 S f
(_)1447 3972 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 3972 t
(BYTE smb)1 578 1 869 4092 t
10 S f
(_)1447 4092 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 621 2 1497 4092 t
10 S f
(_)3331 4092 w
10 R f
(dscnt\) */)1 355 1 3381 4092 t
(Interim Response Format \(if no error - ok send remaining data\):)10 2631 1 720 4428 t
(BYTE smb)1 578 1 830 4608 t
10 S f
(_)1408 4608 w
10 R f
( value = 0 */)4 532(wct; /*)1 400 2 1458 4608 t
(WORD smb)1 622 1 786 4728 t
10 S f
(_)1408 4728 w
10 R f
( value = 0 */)4 532(bcc; /*)1 400 2 1458 4728 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 5028 t
(BYTE smb)1 578 1 830 5208 t
10 S f
(_)1408 5208 w
10 R f
( value = 9 */)4 532(wct; /*)1 621 2 1458 5208 t
(WORD smb)1 622 1 786 5328 t
10 S f
(_)1408 5328 w
10 R f
( total number of parameter bytes being sent */)8 1900(tpscnt; /*)1 621 2 1458 5328 t
(WORD smb)1 622 1 786 5448 t
10 S f
(_)1408 5448 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1458 5448 t
(WORD smb)1 622 1 786 5568 t
10 S f
(_)1408 5568 w
10 R f
( number of parameter bytes being sent this buffer */)9 2143(pscnt; /*)1 621 2 1458 5568 t
(WORD smb)1 622 1 786 5688 t
10 S f
(_)1408 5688 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(psoff; /*)1 621 2 1458 5688 t
(WORD smb)1 622 1 786 5808 t
10 S f
(_)1408 5808 w
10 R f
( byte displacement for these parameter bytes */)7 1938(psdisp; /*)1 621 2 1458 5808 t
(WORD smb)1 622 1 786 5928 t
10 S f
(_)1408 5928 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1458 5928 t
(WORD smb)1 622 1 786 6048 t
10 S f
(_)1408 6048 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1458 6048 t
(WORD smb)1 622 1 786 6168 t
10 S f
(_)1408 6168 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 621 2 1458 6168 t
(WORD smb)1 622 1 786 6288 t
10 S f
(_)1408 6288 w
10 R f
( \256le id for handle based requests, else 0xffff */)9 1929(\256d; /*)1 621 2 1458 6288 t
(WORD smb)1 622 1 786 6408 t
10 S f
(_)1408 6408 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 6408 t
(BYTE smb)1 578 1 830 6528 t
10 S f
(_)1408 6528 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 6528 t
(BYTE smb)1 578 1 830 6648 t
10 S f
(_)1408 6648 w
10 R f
( param bytes \(* = value of smb)7 1296(param[*]; /*)1 621 2 1458 6648 t
10 S f
(_)3375 6648 w
10 R f
(pscnt\) */)1 355 1 3425 6648 t
(BYTE smb)1 578 1 830 6768 t
10 S f
(_)1408 6768 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 6768 t
(BYTE smb)1 578 1 830 6888 t
10 S f
(_)1408 6888 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 621 2 1458 6888 t
10 S f
(_)3292 6888 w
10 R f
(dscnt\) */)1 355 1 3342 6888 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 14 14
%%Page: 15 15
save
mark
15 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 15 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Response Format \(may respond with zero or more of these\):)9 2476 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 + value of smb)7 1125(wct; /*)1 621 2 1458 1020 t
10 S f
(_)3204 1020 w
10 R f
(suwcnt */)1 394 1 3254 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( total number of parameter bytes being returned */)8 2071(tprcnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being returned */)8 1839(tdrcnt; /*)1 621 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( number of parameter bytes being returned this buf */)9 2204(prcnt; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(proff; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( byte displacement for these parameter bytes */)7 1938(prdisp; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( number of data bytes being returned this buffer */)9 2082(drcnt; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( set up return word count */)6 1152(suwcnt; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( variable)1 354(setup[*]; /*)1 621 2 1458 2460 t
10 S1 f
(#)2466 2460 w
10 R f
(of set up return words \(* = smb)7 1313 1 2549 2460 t
10 S f
(_)3862 2460 w
10 R f
(suwcnt\) */)1 427 1 3912 2460 t
(WORD smb)1 622 1 786 2580 t
10 S f
(_)1408 2580 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2700 t
(BYTE smb)1 578 1 830 2820 t
10 S f
(_)1408 2820 w
10 R f
( param bytes \(* = value of smb)7 1296(param[*]; /*)1 621 2 1458 2820 t
10 S f
(_)3375 2820 w
10 R f
(prcnt\) */)1 349 1 3425 2820 t
(BYTE smb)1 578 1 830 2940 t
10 S f
(_)1408 2940 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 2940 t
(BYTE smb)1 578 1 830 3060 t
10 S f
(_)1408 3060 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 621 2 1458 3060 t
10 S f
(_)3292 3060 w
10 R f
(drcnt\) */)1 349 1 3342 3060 t
(Service:)720 3360 w
( transfer of parameter and data blocks greater than a negotiated buffer)11 2936(The Transaction2 protocol allows)3 1384 2 720 3636 t
(size between the requester and the server.)6 1706 1 720 3756 t
( scope includes \(but is not limited to\) IOCTL device requests and \256le system)13 3184(The Transaction2 command)2 1136 2 720 3996 t
(requests which require the transfer of an extended attribute list.)9 2594 1 720 4116 t
( the)1 168(The Transaction2 protocol is used to transer a request for any of a set of supported functions on)17 4152 2 720 4356 t
( function requested is identi\256ed by the)6 1634(server which may require the transfer of large data blocks. The)10 2686 2 720 4476 t
(\256rst word in the transaction2 smb)5 1406 1 720 4596 t
10 S f
(_)2126 4596 w
10 R f
( speci\256c information may follow the func-)6 1776(setup \256eld. Other function)3 1088 2 2176 4596 t
(tion identi\256er in the smb)4 1088 1 720 4716 t
10 S f
(_)1808 4716 w
10 R f
(setup \256le id or in the smb)6 1173 1 1858 4716 t
10 S f
(_)3031 4716 w
10 R f
( are not)2 349( functions supported)2 868( The)1 239(param \256led.)1 503 4 3081 4716 t
( means)1 289( protocol simply provides a)4 1126( The)1 221(de\256ned by the protocol, but by consumer/server implementations.)7 2684 4 720 4836 t
(of delivering them and retrieving the results.)6 1826 1 720 4956 t
(The number of bytes needed in order to perform the TRANSACT2 request may be more than will \256t in)18 4320 1 720 5196 t
(a single buffer.)2 617 1 720 5316 t
( the number of parameter and data bytes expected to be)10 2335(At the time of the request, the consumer knows)8 1985 2 720 5556 t
( this information to the server via the primary request \(smb)10 2458(sent and passes)2 632 2 720 5676 t
10 S f
(_)3810 5676 w
10 R f
(tpscnt and smb)2 620 1 3860 5676 t
10 S f
(_)4480 5676 w
10 R f
(tdscnt\). This)1 510 1 4530 5676 t
(may be reduced by lowering the total number of bytes expected \(smb)11 2918 1 720 5796 t
10 S f
(_)3638 5796 w
10 R f
( smbtdscnt\) in each)3 819(tpscnt and/or)1 533 2 3688 5796 t
(\(any\) secondary request.)2 993 1 720 5916 t
(Thus when the amount of parameter bytes received \(total of each smb)11 2906 1 720 6156 t
10 S f
(_)3626 6156 w
10 R f
( amount of)2 457(pscnt\) equals the total)3 907 2 3676 6156 t
(parameter bytes expected \(smallest smb)4 1651 1 720 6276 t
10 S f
(_)2371 6276 w
10 R f
( the parameter)2 598(tpscnt\) received, then the server has received all)7 2021 2 2421 6276 t
(bytes.)720 6396 w
( bytes received \(total of each smb)6 1425(Likewise, when the amount of data)5 1468 2 720 6636 t
10 S f
(_)3613 6636 w
10 R f
(dscnt\) equals the total amount of)5 1377 1 3663 6636 t
(data bytes expected \(smallest smb)4 1391 1 720 6756 t
10 S f
(_)2111 6756 w
10 R f
(tdscnt\) received, then the server has received all the data bytes.)10 2595 1 2161 6756 t
( However, the server)3 914(The parameter bytes should normally be sent \256rst followed by the data bytes.)12 3406 2 720 6996 t
( buffer by the offset \256elds \(smb)6 1361(knows where each begins and ends in each)7 1835 2 720 7116 t
10 S f
(_)3916 7116 w
10 R f
(psoff and smb)2 600 1 3966 7116 t
10 S f
(_)4566 7116 w
10 R f
(dsoff\) and)1 424 1 4616 7116 t
(the length \256elds \(smb)3 894 1 720 7236 t
10 S f
(_)1614 7236 w
10 R f
(pscnt and smb)2 592 1 1664 7236 t
10 S f
(_)2256 7236 w
10 R f
( each\) is)2 354( displacement of the bytes \(relative to start of)8 1888(dscnt\). The)1 492 3 2306 7236 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 15 15
%%Page: 16 16
save
mark
16 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 16 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(also known \(smb)2 709 1 720 840 t
10 S f
(_)1429 840 w
10 R f
(psdisp and smb)2 643 1 1479 840 t
10 S f
(_)2122 840 w
10 R f
( able to reasemble the parameter and data)7 1737( the server is)3 546(dsdisp\). Thus)1 585 3 2172 840 t
(bytes should the)2 666 1 720 960 t
10 S1 f
(")1419 960 w
10 R f
(packets)1460 960 w
10 S1 f
(")1759 960 w
10 R f
(\(buffers\) be received out of sequence.)5 1545 1 1833 960 t
( interim response is expected \(and)5 1441(If all parameter bytes and data bytes \256t into a single buffer, then no)13 2879 2 720 1200 t
(no secondary request is sent\).)4 1210 1 720 1320 t
( amount of data bytes and parameter bytes which the server may)11 2789(The Consumer knows the maximum)4 1531 2 720 1560 t
(return \(from smb)2 698 1 720 1680 t
10 S f
(_)1418 1680 w
10 R f
(mprcnt and smb)2 660 1 1468 1680 t
10 S f
(_)2128 1680 w
10 R f
( it initializes its bytes expected variables)6 1663( Thus)1 266(mdrcnt of the request\).)3 933 3 2178 1680 t
( being returned via each)4 1030( Server then informs the consumer of the actual amounts)9 2413( The)1 230(to these values.)2 647 4 720 1800 t
10 S1 f
(")720 1920 w
10 R f
(packet)761 1920 w
10 S1 f
(")1021 1920 w
10 R f
(\(buffer\) of the response \(smb)4 1195 1 1095 1920 t
10 S f
(_)2290 1920 w
10 R f
(tprcnt and smb)2 610 1 2340 1920 t
10 S f
(_)2950 1920 w
10 R f
(tdrcnt\).)3000 1920 w
( the total number of bytes expected \(smb)7 1740(The server may reduce the expected bytes by lowering)8 2297 2 720 2160 t
10 S f
(_)4757 2160 w
10 R f
(tprcnt)4807 2160 w
(and/or smb)1 455 1 720 2280 t
10 S f
(_)1175 2280 w
10 R f
(tdrcnt\) in each \(any\) response.)4 1242 1 1225 2280 t
( of each smb)3 543(Thus when the amount of parameter bytes received \(total)8 2366 2 720 2520 t
10 S f
(_)3629 2520 w
10 R f
(prcnt\) equals the total amount of)5 1361 1 3679 2520 t
(parameter bytes expected \(smallest smb)4 1631 1 720 2640 t
10 S f
(_)2351 2640 w
10 R f
( received all the parame-)4 1021(tprcnt\) received, then the consumer has)5 1618 2 2401 2640 t
(ter bytes.)1 374 1 720 2760 t
(Likewise, when the amount of data bytes received \(total of each smb)11 2898 1 720 3000 t
10 S f
(_)3618 3000 w
10 R f
( of)1 123(drcnt\) equals the total amount)4 1249 2 3668 3000 t
(data bytes expected \(smallest smb)4 1391 1 720 3120 t
10 S f
(_)2111 3120 w
10 R f
(tdrcnt\) received, then the consumer has received all the data bytes.)10 2734 1 2161 3120 t
( bytes. However, the consu-)4 1174(The parameter bytes should normally be returned \256rst followed by the data)11 3146 2 720 3360 t
( buffer by the offset \256elds \(smb)6 1361(mer knows where each begins and ends in each)8 2033 2 720 3480 t
10 S f
(_)4114 3480 w
10 R f
(proff and smb)2 594 1 4164 3480 t
10 S f
(_)4758 3480 w
10 R f
(droff\))4808 3480 w
(and the length \256elds \(smb)4 1121 1 720 3600 t
10 S f
(_)1841 3600 w
10 R f
(prcnt and smb)2 610 1 1891 3600 t
10 S f
(_)2501 3600 w
10 R f
( of the bytes \(relative to start of)7 1417( displacement)1 574(drcnt\). The)1 498 3 2551 3600 t
(each\) is also known \(smb)4 1059 1 720 3720 t
10 S f
(_)1779 3720 w
10 R f
( smb)1 202(prdisp and)1 430 2 1829 3720 t
10 S f
(_)2461 3720 w
10 R f
( the consumer is able to reasemble the parame-)8 1953(drdisp\). Thus)1 576 2 2511 3720 t
(ter and data bytes should the)5 1180 1 720 3840 t
10 S1 f
(")1933 3840 w
10 R f
(packets)1974 3840 w
10 S1 f
(")2273 3840 w
10 R f
(\(buffers\) be received out of sequence.)5 1545 1 2347 3840 t
(Thus the \257ow is:)3 694 1 720 4080 t
( \(both parameters)2 740( consumer sends the \256rst \(primary\) request which identi\256es the total bytes)11 3175(1 The)1 405 3 720 4356 t
( as many of the parame-)5 1001(and data\) which are expected to be sent and contains the set up words and)14 3069 2 970 4476 t
( identi\256es the)2 581( request also)2 539( This)1 289(ter and data bytes bytes as will \256t in a negotiated size buffer.)12 2661 4 970 4596 t
( bytes \(setup, parameters and data\) the server is to return on TRANSACT2)12 3190(maximum number of)2 880 2 970 4716 t
(completion. If all the bytes \256t in the single buffer, skip to step 4.)13 2675 1 970 4836 t
( server responds with a single interim response meaning)8 2329(2 The)1 405 2 720 5112 t
10 S1 f
(")3490 5112 w
10 R f
( the bytes)2 407(ok, send the remainder of)4 1061 2 3531 5112 t
10 S1 f
(")4999 5112 w
10 R f
(or \(if error response\) terminate the transaction.)6 1912 1 970 5232 t
( iteration of this secon-)4 957( consumer then sends another buffer full of bytes to the server. On each)13 2958(3 The)1 405 3 720 5508 t
(dary request, smb)2 727 1 970 5628 t
10 S f
(_)1697 5628 w
10 R f
(tpscnt and/or smb)2 731 1 1747 5628 t
10 S f
(_)2478 5628 w
10 R f
( repeated until all bytes)4 968( step is)2 298( This)1 246(tdscnt could be reduced.)3 1000 4 2528 5628 t
( delivered to the server \(total of all smb)8 1703(have been)1 416 2 970 5748 t
10 S f
(_)3089 5748 w
10 R f
(pscnt equals smallest smb)3 1084 1 3139 5748 t
10 S f
(_)4223 5748 w
10 R f
(tpscnt and total of)3 767 1 4273 5748 t
(all smb)1 300 1 970 5868 t
10 S f
(_)1270 5868 w
10 R f
(dscnt equals smallest smb)3 1060 1 1320 5868 t
10 S f
(_)2380 5868 w
10 R f
(tdscnt\).)2430 5868 w
( Server sets up and performs the TRANSACT2 with the information provided.)11 3229(4 The)1 405 2 720 6144 t
( sends back \(up to\) the number of parameter and)9 2021( completion of the TRANSACT2, the server)6 1827(5 Upon)1 472 3 720 6420 t
( step is repeated)3 691( This)1 253( as will \256t in the negotiated buffer size\).)8 1731(data bytes requested \(or as many)5 1395 4 970 6540 t
( each iteration of this response, smb)6 1560( On)1 201( result bytes have been returned.)5 1396(until all)1 329 4 970 6660 t
10 S f
(_)4456 6660 w
10 R f
(tprcnt and/or)1 534 1 4506 6660 t
(smb)970 6780 w
10 S f
(_)1137 6780 w
10 R f
( bytes have been delivered to the con-)7 1580( step is repeated until all)5 1029( This)1 247(tdrcnt could be reduced.)3 997 4 1187 6780 t
(sumer \(total of all smb)4 937 1 970 6900 t
10 S f
(_)1907 6900 w
10 R f
(prcnt equals smallest smb)3 1054 1 1957 6900 t
10 S f
(_)3011 6900 w
10 R f
( of all smb)3 452(tprcnt and total)2 621 2 3061 6900 t
10 S f
(_)4134 6900 w
10 R f
(drcnt equals smallest)2 856 1 4184 6900 t
(smb)970 7020 w
10 S f
(_)1137 7020 w
10 R f
(tdrcnt\).)1187 7020 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 16 16
%%Page: 17 17
save
mark
17 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 17 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Thus the \257ow is:)3 694 1 970 840 t
( \256rst \(primary\) request which identi\256es the total bytes \(parameters and)10 3042( consumer sends the)3 873(1 The)1 405 3 720 1116 t
(data\) which are to be sent, contains the set up words and as many of the parameter and data bytes)19 4070 1 970 1236 t
( also identi\256es the maximum number of bytes)7 1921( request)1 325( This)1 281(as will \256t in a negotiated size buffer.)7 1543 4 970 1356 t
( on TRANSACT2 completion. The parameter)5 1921(\(setup, parameters and data\) the server is to return)8 2149 2 970 1476 t
( all)1 135( If)1 133(bytes are immediately followed by the data bytes \(the length \256elds identify the break point\).)14 3802 3 970 1596 t
(the bytes \256t in the single buffer, skip to step 4.)10 1935 1 970 1716 t
( server responds with a single interim response meaning)8 2329(2 The)1 405 2 720 1992 t
10 S1 f
(")3490 1992 w
10 R f
( the bytes)2 407(ok, send the remainder of)4 1061 2 3531 1992 t
10 S1 f
(")4999 1992 w
10 R f
(or \(if error response\) terminate the transaction.)6 1912 1 970 2112 t
( consumer then sends another buffer full of bytes to the server. This step is repeated until all)17 3915(3 The)1 405 2 720 2388 t
(bytes have been delivered to the server.)6 1624 1 970 2508 t
( Server sets up and performs the TRANSACT2 with the information provided.)11 3229(4 The)1 405 2 720 2784 t
( up to the the number of parameter)7 1495( completion of the TRANSACT2, the server sends back)8 2353(5 Upon)1 472 3 720 3060 t
( step is)2 334( This)1 264( negotiated buffer size\).)3 1031(and data bytes requested \(or as many as will \256t in the)11 2441 4 970 3180 t
( each iteration of this response,)5 1447( On)1 221(repeated until all bytes requested have been returned.)7 2402 3 970 3300 t
(smb)970 3420 w
10 S f
(_)1137 3420 w
10 R f
(rprcnt and smb)2 623 1 1187 3420 t
10 S f
(_)1810 3420 w
10 R f
( of matching bytes returned in the previous)7 1794(rdrcnt are reduced by the number)5 1386 2 1860 3420 t
( parameter count \(smb)3 925(response. The)1 596 2 970 3540 t
10 S f
(_)2491 3540 w
10 R f
(rprcnt\) is expected to go to zero \256rst because the parameters)10 2499 1 2541 3540 t
( data count \(smb)3 729( The)1 235(are sent before the data.)4 1037 3 970 3660 t
10 S f
(_)2971 3660 w
10 R f
( to be counted down.)4 919(rdrcnt\) may then continue)3 1100 2 3021 3660 t
(Fewer than the requested number of bytes may be returned.)9 2444 1 970 3780 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 17 17
%%Page: 18 18
save
mark
18 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 18 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
( and data does NOT all \256t in a sin-)9 1469(The \257ow for the TRANSACT2 protocol when the request parameters)9 2851 2 720 840 t
(gle buffer is:)2 526 1 720 960 t
(consumer)1080 1200 w
10 S1 f
(\261\261\261\261\261\261\261\261\261\261\261 >)1 711 1 1555 1200 t
10 R f
(TRANSACT2 request \(data\))2 1164 1 2303 1200 t
10 S1 f
( >)1 -4(> \261\261\261\261\261\261\261\261\261\261\261\261\261)1 904 2 3500 1200 t
10 R f
(server)4437 1200 w
(consumer)1080 1320 w
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261<)1 782(\261 <)1 61 2 1501 1320 t
10 R f
(OK send remaining data)3 997 1 2377 1320 t
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261\261\261)1 903(\261 <)1 61 2 3407 1320 t
10 R f
(server)4437 1320 w
(consumer)1080 1440 w
10 S1 f
(\261\261\261\261\261\261\261 >)1 451 1 1555 1440 t
10 R f
(TRANSACT2 secondary request 1 \(data\))4 1684 1 2043 1440 t
10 S1 f
( >)1 -4(> \261\261\261\261\261\261\261\261\261)1 644 2 3760 1440 t
10 R f
(server)4437 1440 w
(consumer)1080 1560 w
10 S1 f
(\261\261\261\261\261\261\261 >)1 451 1 1555 1560 t
10 R f
(TRANSACT2 secondary request 2 \(data\))4 1684 1 2043 1560 t
10 S1 f
( >)1 -4(> \261\261\261\261\261\261\261\261\261)1 644 2 3760 1560 t
10 R f
(server)4437 1560 w
( .)1 1787(. .)1 1813 2 1080 1680 t
(consumer)1080 1800 w
10 S1 f
(\261\261\261\261\261\261\261 >)1 451 1 1555 1800 t
10 R f
(TRANSACT2 secondary request n \(data\))4 1684 1 2043 1800 t
10 S1 f
( >)1 -4(> \261\261\261\261\261\261\261\261\261)1 644 2 3760 1800 t
10 R f
(server)4437 1800 w
( .)1 1787(. .)1 1813 2 1080 1920 t
( .)1 819( sets up and performs the TRANSACT2\))6 1685(. \(server)1 1096 3 1080 2040 t
( .)1 1787(. .)1 1813 2 1080 2160 t
(consumer)1080 2280 w
10 S1 f
( \261\261\261\261\261\261\261\261<)1 627(\261 <)1 61 2 1501 2280 t
10 R f
(TRANSACT2 response 1 \(data\))3 1308 1 2222 2280 t
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261)1 780(\261 <)1 61 2 3563 2280 t
10 R f
(server)4437 2280 w
(consumer)1080 2400 w
10 S1 f
( \261\261\261\261\261\261\261\261<)1 627(\261 <)1 61 2 1501 2400 t
10 R f
(TRANSACT2 response 2 \(data\))3 1308 1 2222 2400 t
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261)1 780(\261 <)1 61 2 3563 2400 t
10 R f
(server)4437 2400 w
( .)1 1787(. .)1 1813 2 1080 2520 t
(consumer)1080 2640 w
10 S1 f
( \261\261\261\261\261\261\261\261<)1 627(\261 <)1 61 2 1501 2640 t
10 R f
(TRANSACT2 response n \(data\))3 1308 1 2222 2640 t
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261)1 780(\261 <)1 61 2 3563 2640 t
10 R f
(server)4437 2640 w
( does all \256t in a single buffer)7 1209(The \257ow for the Transaction protocol when the request parameters and data)11 3111 2 720 2880 t
(is:)720 3000 w
(consumer)1080 3240 w
10 S1 f
(\261\261\261\261\261\261\261\261\261\261\261 >)1 711 1 1555 3240 t
10 R f
(TRANSACT2 request \(data\))2 1164 1 2303 3240 t
10 S1 f
( >)1 -4(> \261\261\261\261\261\261\261\261\261\261\261\261\261)1 904 2 3500 3240 t
10 R f
(server)4437 3240 w
( .)1 1787(. .)1 1813 2 1080 3360 t
( .)1 819( sets up and performs the TRANSACT2\))6 1685(. \(server)1 1096 3 1080 3480 t
( .)1 1787(. .)1 1813 2 1080 3600 t
(consumer)1080 3720 w
10 S1 f
( \261\261\261\261\261\261\261\261<)1 627(\261 <)1 61 2 1501 3720 t
10 R f
(TRANSACT2 response 1 \(data\))3 1308 1 2222 3720 t
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261)1 780(\261 <)1 61 2 3563 3720 t
10 R f
(server)4437 3720 w
( .)1 1124( one if all data \256t in buffer\))7 1140(. \(only)1 1336 3 1080 3840 t
(consumer)1080 3960 w
10 S1 f
( \261\261\261\261\261\261\261\261<)1 627(\261 <)1 61 2 1501 3960 t
10 R f
(TRANSACT2 response 2 \(data\))3 1308 1 2222 3960 t
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261)1 780(\261 <)1 61 2 3563 3960 t
10 R f
(server)4437 3960 w
( .)1 1787(. .)1 1813 2 1080 4080 t
(consumer)1080 4200 w
10 S1 f
( \261\261\261\261\261\261\261\261<)1 627(\261 <)1 61 2 1501 4200 t
10 R f
(TRANSACT2 response n \(data\))3 1308 1 2222 4200 t
10 S1 f
( \261\261\261\261\261\261\261\261\261\261\261)1 780(\261 <)1 61 2 3563 4200 t
10 R f
(server)4437 4200 w
( make up the complete protocol, thus the TID,)8 1970(Note that the primary request through the \256nal response)8 2350 2 720 4596 t
( consumer to)2 532(PID, UID and MID are expected to remain constant and can be used by both the server and)17 3788 2 720 4716 t
(route the individual messages of the protocol to the correct process.)10 2778 1 720 4836 t
(Transaction may generate the following errors:)5 1916 1 720 5112 t
(Error Class ERRDOS:)2 916 1 1080 5292 t
(ERRnoaccess)1146 5532 w
(ERRbadaccess)1146 5652 w
(Error Class ERRSRV:)2 911 1 1080 5892 t
(ERRerror)1146 6132 w
(ERRinvnid)1146 6252 w
(ERRaccess)1146 6372 w
(ERRmoredata)1146 6492 w
10 S1 f
(<)1146 6612 w
10 R f
(implementation speci\256c)1 966 1 1202 6612 t
10 S1 f
(>)2168 6612 w
10 R f
(Error Class ERRHRD:)2 927 1 1080 6852 t
10 S1 f
(<)1146 7092 w
10 R f
(implementation speci\256c)1 966 1 1202 7092 t
10 S1 f
(>)2168 7092 w
10 R f
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 18 18
%%Page: 19 19
save
mark
19 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 19 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( Transaction2 Protocols)2 1032(6.0.1.1. De\256ned)1 694 2 720 840 t
10 R f
( of the usages here)4 790( Each)1 269(This section speci\256es some of the de\256ned usages of the Transaction2 protocol.)11 3261 3 720 996 t
( is NOT meant to be an exhaustive list.)8 1621( This)1 244(utilize the basic \(and \257exible\) transaction protocol format.)7 2380 3 720 1116 t
( smb)1 206(The following function codes are transferred in)6 1962 2 720 1356 t
10 S f
(_)2888 1356 w
10 R f
(setup[0] and are used by the server to identify the)9 2102 1 2938 1356 t
(speci\256c function required.)2 1061 1 720 1476 t
(TRANSACT2)1080 1776 w
10 S f
(_)1658 1776 w
10 R f
(OPEN 0)1 3041 1 1708 1776 t
(TRANSACT2)1080 1896 w
10 S f
(_)1658 1896 w
10 R f
(FINDFIRST 1)1 3041 1 1708 1896 t
(TRANSACT2)1080 2016 w
10 S f
(_)1658 2016 w
10 R f
(FINDNEXT 2)1 3041 1 1708 2016 t
(TRANSACT2)1080 2136 w
10 S f
(_)1658 2136 w
10 R f
(QFSINFO 3)1 3041 1 1708 2136 t
(TRANSACT2)1080 2256 w
10 S f
(_)1658 2256 w
10 R f
(SETFSINFO 4)1 3041 1 1708 2256 t
(TRANSACT2)1080 2376 w
10 S f
(_)1658 2376 w
10 R f
(QPATHINFO 5)1 3041 1 1708 2376 t
(TRANSACT2)1080 2496 w
10 S f
(_)1658 2496 w
10 R f
(SETPATHINFO 6)1 3041 1 1708 2496 t
(TRANSACT2)1080 2616 w
10 S f
(_)1658 2616 w
10 R f
(QFILEINFO 7)1 3041 1 1708 2616 t
(TRANSACT2)1080 2736 w
10 S f
(_)1658 2736 w
10 R f
(SETFILEINFO 8)1 3041 1 1708 2736 t
(TRANSACT2)1080 2856 w
10 S f
(_)1658 2856 w
10 R f
(FSCTL 9)1 3041 1 1708 2856 t
(TRANSACT2)1080 2976 w
10 S f
(_)1658 2976 w
10 R f
(IOCTL 10)1 3091 1 1708 2976 t
(TRANSACT2)1080 3096 w
10 S f
(_)1658 3096 w
10 R f
(FINDNOTIFYFIRST 11)1 3091 1 1708 3096 t
(TRANSACT2)1080 3216 w
10 S f
(_)1658 3216 w
10 R f
(FINDNOTIFYNEXT 12)1 3091 1 1708 3216 t
(TRANSACT2)1080 3336 w
10 S f
(_)1658 3336 w
10 R f
(MKDIR 13)1 3091 1 1708 3336 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 19 19
%%Page: 20 20
save
mark
20 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 20 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.1. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(OPEN)1811 840 w
10 R f
(The function code TRANSACT2)3 1467 1 720 996 t
10 S f
(_)2187 996 w
10 R f
(OPEN in smb)2 648 1 2237 996 t
10 S f
(_)2885 996 w
10 R f
( TRANSACT2 requests)2 1049(setup[0] in the primary)3 1056 2 2935 996 t
(identi\256es a request to create a \256le with extended attributes.)9 2418 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1356 t
(BYTE smb)1 578 1 869 1656 t
10 S f
(_)1447 1656 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1656 t
(WORD smb)1 622 1 825 1776 t
10 S f
(_)1447 1776 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1776 t
(WORD smb)1 622 1 825 1896 t
10 S f
(_)1447 1896 w
10 R f
( total size of extended attribute list */)7 1541(tdscnt; /*)1 621 2 1497 1896 t
(WORD smb)1 622 1 825 2016 t
10 S f
(_)1447 2016 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 2016 t
(WORD smb)1 622 1 825 2136 t
10 S f
(_)1447 2136 w
10 R f
( value = 0. No data returned */)7 1276(mdrcnt; /*)1 621 2 1497 2136 t
(BYTE smb)1 578 1 869 2256 t
10 S f
(_)1447 2256 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2256 t
(BYTE smb)1 578 1 869 2376 t
10 S f
(_)1447 2376 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2376 t
(WORD smb)1 622 1 825 2496 t
10 S f
(_)1447 2496 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2496 t
(bit 0 - 0)3 338 1 2139 2616 t
(bit 1 - 0 */)4 449 1 2139 2736 t
(DWORD smb)1 694 1 753 2856 t
10 S f
(_)1447 2856 w
10 R f
( max milliseconds to wait for resource to open */)9 2028(timeout; /*)1 621 2 1497 2856 t
(WORD smb)1 622 1 825 2976 t
10 S f
(_)1447 2976 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2976 t
(WORD smb)1 622 1 825 3096 t
10 S f
(_)1447 3096 w
10 R f
( value = tpscnt, parms must be in primary request */)10 2159(pscnt; /*)1 621 2 1497 3096 t
(WORD smb)1 622 1 825 3216 t
10 S f
(_)1447 3216 w
10 R f
( offset \(from start of SMB hdr to parameter bytes */)10 2149(psoff; /*)1 621 2 1497 3216 t
(WORD smb)1 622 1 825 3336 t
10 S f
(_)1447 3336 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3336 t
(WORD smb)1 622 1 825 3456 t
10 S f
(_)1447 3456 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3456 t
(BYTE smb)1 578 1 869 3576 t
10 S f
(_)1447 3576 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3576 t
(BYTE smb)1 578 1 869 3696 t
10 S f
(_)1447 3696 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3696 t
(WORD smb)1 622 1 825 3816 t
10 S f
(_)1447 3816 w
10 R f
( value = 0 :- TRANSACT2)5 1126(setup1; /*)1 621 2 1497 3816 t
10 S f
(_)3244 3816 w
10 R f
(OPEN */)1 372 1 3294 3816 t
(WORD smb)1 622 1 825 3936 t
10 S f
(_)1447 3936 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3936 t
(BYTE smb)1 578 1 869 4056 t
10 S f
(_)1447 4056 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 4056 t
(BYTE smb)1 578 1 869 4176 t
10 S f
(_)1447 4176 w
10 R f
( The parmater block for the the TRANSACT2)7 1900(param[*]; /*)1 621 2 1497 4176 t
10 S f
(_)4018 4176 w
10 R f
(OPEN)4068 4176 w
(* function is the open speci\256c information in the)8 2007 1 2073 4296 t
(* following format. */)3 907 1 2073 4416 t
(WORD open)1 954 1 1280 4536 t
10 S f
(_)2234 4536 w
10 R f
(\257ags2;)2284 4536 w
(bit 0 - if set, return additional information)7 1727 1 2172 4656 t
(bit 1 - if set, set single user total \256le lock)10 1710 1 2172 4776 t
(bit 2 - if set, the server should notify the consumer)10 2097 1 2172 5016 t
(on any action which can modify the \256le \(delete,)8 1969 1 2436 5136 t
(setattrib, rename, etc.\). if not set, the server)7 1785 1 2436 5256 t
(need only notify the consumer on another open)7 1939 1 2436 5376 t
(request. */)1 424 1 2436 5496 t
(bit 3 - if set, return total length of EAs for the \256le)12 2069 1 2172 5616 t
(WORD open)1 921 1 1313 5736 t
10 S f
(_)2234 5736 w
10 R f
( \256le open mode */)4 754(mode; /*)1 559 2 2284 5736 t
(WORD open)1 921 1 1313 5856 t
10 S f
(_)2234 5856 w
10 R f
( */)1 144( search attributes)2 692(sattr; /*)1 476 3 2284 5856 t
(WORD open)1 921 1 1313 5976 t
10 S f
(_)2234 5976 w
10 R f
( \256le attributes \(for create\) */)5 1162(attr; /*)1 470 2 2284 5976 t
(DWORD open)1 954 1 1280 6096 t
10 S f
(_)2234 6096 w
10 R f
( create time */)3 592(time; /*)1 515 2 2284 6096 t
(WORD open)1 921 1 1313 6216 t
10 S f
(_)2234 6216 w
10 R f
( open function */)3 704(ofun; /*)1 520 2 2284 6216 t
(DWORD open)1 954 1 1280 6336 t
10 S f
(_)2234 6336 w
10 R f
( bytes to reserve on)4 808(size; /*)1 492 2 2284 6336 t
10 S1 f
(")3617 6336 w
10 R f
(create)3658 6336 w
10 S1 f
(")3895 6336 w
10 R f
(* or)1 166 1 2634 6456 t
10 S1 f
(")2833 6456 w
10 R f
(truncate)2874 6456 w
10 S1 f
(")3195 6456 w
10 R f
(*/)3269 6456 w
(WORD open)1 921 1 1313 6576 t
10 S f
(_)2234 6576 w
10 R f
( reserved \(must be zero\) */)5 1106(rsvd[5]; /*)1 526 2 2284 6576 t
(BYTE open)1 921 1 1313 6696 t
10 S f
(_)2234 6696 w
10 R f
(pathname[]; /* \256le pathname */)4 1286 1 2284 6696 t
(BYTE smb)1 578 1 869 6936 t
10 S f
(_)1447 6936 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 6936 t
(BYTE smb)1 578 1 869 7056 t
10 S f
(_)1447 7056 w
10 R f
( FEAList structure for the \256le to be openned */)9 1945(data[*]; /*)1 621 2 1497 7056 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 20 20
%%Page: 21 21
save
mark
21 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 21 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( total number of parameter bytes being sent */)8 1900(tpscnt; /*)1 538 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( value = 0xffff, no handle on request */)8 1625(\256d; /*)1 538 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 2460 t
10 S f
(_)3209 2460 w
10 R f
(dscnt\) */)1 355 1 3259 2460 t
(Response Format \(one only\):)3 1187 1 720 2760 t
(BYTE smb)1 578 1 830 2940 t
10 S f
(_)1408 2940 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 2940 t
(WORD smb)1 622 1 786 3060 t
10 S f
(_)1408 3060 w
10 R f
( total parameter length retuned */)5 1368(tprcnt; /*)1 621 2 1458 3060 t
(WORD smb)1 622 1 786 3180 t
10 S f
(_)1408 3180 w
10 R f
( */)1 144( value = 0 no data bytes)6 997(tdrcnt; /*)1 621 3 1458 3180 t
(WORD smb)1 622 1 786 3300 t
10 S f
(_)1408 3300 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 3300 t
(WORD smb)1 622 1 786 3420 t
10 S f
(_)1408 3420 w
10 R f
( parameter bytes being returned */)5 1406(prcnt; /*)1 621 2 1458 3420 t
(WORD smb)1 622 1 786 3540 t
10 S f
(_)1408 3540 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(proff; /*)1 621 2 1458 3540 t
(WORD smb)1 622 1 786 3660 t
10 S f
(_)1408 3660 w
10 R f
( value = 0 byte displacement for these param bytes */)10 2210(prdisp; /*)1 621 2 1458 3660 t
(WORD smb)1 622 1 786 3780 t
10 S f
(_)1408 3780 w
10 R f
( value = 0 no data bytes */)7 1108(drcnt; /*)1 621 2 1458 3780 t
(WORD smb)1 622 1 786 3900 t
10 S f
(_)1408 3900 w
10 R f
( value = 0 no data bytes */)7 1108(droff; /*)1 621 2 1458 3900 t
(WORD smb)1 622 1 786 4020 t
10 S f
(_)1408 4020 w
10 R f
( value = 0 no data bytes */)7 1108(drdisp; /*)1 621 2 1458 4020 t
(BYTE smb)1 578 1 830 4140 t
10 S f
(_)1408 4140 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 4140 t
(BYTE smb)1 578 1 830 4260 t
10 S f
(_)1408 4260 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 4260 t
(WORD smb)1 622 1 786 4380 t
10 S f
(_)1408 4380 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 4380 t
(BYTE smb)1 578 1 830 4500 t
10 S f
(_)1408 4500 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 4500 t
(BYTE smb)1 578 1 830 4620 t
10 S f
(_)1408 4620 w
10 R f
( The parmater block for the the TRANSACT2)7 1900(param[*]; /*)1 621 2 1458 4620 t
10 S f
(_)3979 4620 w
10 R f
(OPEN)4029 4620 w
(* function response is the open speci\256c return)7 1889 1 2034 4740 t
(* information in the following format. */)6 1678 1 2034 4860 t
(WORD open)1 888 1 1307 4980 t
10 S f
(_)2195 4980 w
10 R f
( \256le handle */)3 571(\256d; /*)1 509 2 2245 4980 t
(+WORD open)1 921 1 1274 5100 t
10 S f
(_)2195 5100 w
10 R f
( attributes of \256le or device */)6 1202(attribute; /*)1 538 2 2245 5100 t
(+DWORD open)1 954 1 1241 5220 t
10 S f
(_)2195 5220 w
10 R f
( last modi\256cation time */)4 1033(time; /*)1 548 2 2245 5220 t
(+DWORD open)1 954 1 1241 5340 t
10 S f
(_)2195 5340 w
10 R f
( current \256le size */)4 775(size; /*)1 525 2 2245 5340 t
(+WORD open)1 921 1 1274 5460 t
10 S f
(_)2195 5460 w
10 R f
( access permissions actually)3 1147(access; /*)1 558 2 2245 5460 t
(* allowed */)2 510 1 2628 5580 t
(+WORD open)1 921 1 1274 5700 t
10 S f
(_)2195 5700 w
10 R f
( \256le type */)3 477(type; /*)1 542 2 2245 5700 t
(+WORD open)1 921 1 1274 5820 t
10 S f
(_)2195 5820 w
10 R f
( state of IPC device \(e.g. pipe\) */)7 1373(state; /*)1 520 2 2245 5820 t
(WORD open)1 888 1 1307 5940 t
10 S f
(_)2195 5940 w
10 R f
( action taken */)3 637(action; /*)1 548 2 2245 5940 t
(DWORD open)1 921 1 1274 6060 t
10 S f
(_)2195 6060 w
10 R f
( server unique \256le id */)5 964(\256leid; /*)1 510 2 2245 6060 t
(WORD open)1 888 1 1307 6180 t
10 S f
(_)2195 6180 w
10 R f
( offset into FEAList data of \256rst)6 1331(offerror; /*)1 547 2 2245 6180 t
(* error which occured while setting)5 1456 1 2628 6300 t
(* the extended attributes. */)4 1139 1 2628 6420 t
(++DWORD open)1 954 1 1241 6540 t
10 S f
(_)2195 6540 w
10 R f
( Total EA length for opened \256le */)7 1435(EAlength; /*)1 621 2 2245 6540 t
(+returned only if bit 0 of open)6 1258 1 753 6840 t
10 S f
(_)2011 6840 w
10 R f
(\257ags2 is set in primary request)5 1264 1 2061 6840 t
(++returned only if bit 3 of open)6 1314 1 753 6960 t
10 S f
(_)2067 6960 w
10 R f
(\257ags2 is set in primary request)5 1264 1 2117 6960 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 21 21
%%Page: 22 22
save
mark
22 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 22 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.2. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(FINDFIRST)1811 840 w
10 R f
(The function code TRANSACT2)3 1404 1 720 996 t
10 S f
(_)2124 996 w
10 R f
( smb)1 218(FINDFIRST in)1 634 2 2174 996 t
10 S f
(_)3026 996 w
10 R f
(setup[0] in the primary TRANSACT2 request)5 1964 1 3076 996 t
(identi\256es a request to \256nd the \256rst \256le that matches the speci\256ed \256le speci\256cation.)13 3380 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total size of extended attribute list */)7 1541(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = maximum return data length */)7 1641(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
(bit 1 - 0)3 338 1 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for \256nd \256rst */)9 1483(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = tpscnt, parms must be in primary request */)10 2159(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB hdr to parameter bytes */)10 2149(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 1)3 421(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3277 3648 w
10 R f
(FINDFIRST */)1 617 1 3327 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(TRANSACT2)2139 4128 w
10 S f
(_)2717 4128 w
10 R f
(FINDFIRST function is the \256nd)4 1316 1 2767 4128 t
(\256rst speci\256c information in the)4 1265 1 2139 4248 t
(following format. */)2 824 1 2139 4368 t
(WORD \256nd\256rst)1 1072 1 1280 4488 t
10 S f
(_)2352 4488 w
10 R f
( Search attribute */)3 781(Attribute; /*)1 665 2 2402 4488 t
(WORD \256nd\256rst)1 1072 1 1280 4608 t
10 S f
(_)2352 4608 w
10 R f
(SearchCount;)2402 4608 w
(WORD \256nd\256rst)1 1072 1 1280 4728 t
10 S f
(_)2352 4728 w
10 R f
( \256nd \257ags */)3 522(\257ags; /*)1 625 2 2402 4728 t
(/* Bit 0: set - close search after)7 1295 1 2898 4848 t
( request.)1 346(* this)1 657 2 2931 4968 t
(* Bit 1: set - close search if end)8 1323 1 2931 5088 t
( search reached.)2 654(* of)1 595 2 2931 5208 t
(* Bit 2: set - Requester requires)6 1313 1 2931 5328 t
( key for each)3 541(* resume)1 800 2 2931 5448 t
( found.)1 291(* entry)1 717 2 2931 5568 t
(*/)2931 5688 w
(WORD \256nd\256rst)1 1072 1 1280 5808 t
10 S f
(_)2352 5808 w
10 R f
( Search level */)3 642(FileInfoLevel; /*)1 721 2 2402 5808 t
(DWORD \256nd\256rst)1 1072 1 1280 5928 t
10 S f
(_)2352 5928 w
10 R f
(rsvd;)2402 5928 w
(BYTE \256nd\256rst)1 1072 1 1280 6048 t
10 S f
(_)2352 6048 w
10 R f
(FileName[];)2402 6048 w
(BYTE smb)1 578 1 869 6168 t
10 S f
(_)1447 6168 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 6168 t
(BYTE smb)1 578 1 869 6288 t
10 S f
(_)1447 6288 w
10 R f
( Additional FileInfoLevel dependent match)4 1763(data[*]; /*)1 621 2 1497 6288 t
(* information. For a search requiring extended)6 1908 1 2073 6408 t
(* attribute matching the data buffer contains)6 1817 1 2073 6528 t
(* the FEAList data for the seach. */)7 1476 1 2073 6648 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 22 22
%%Page: 23 23
save
mark
23 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 23 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 538 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( value = 0xffff, no handle on request */)8 1625(\256d; /*)1 538 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 2220 t
(WORD smb)1 622 1 786 2340 t
10 S f
(_)1408 2340 w
10 R f
( value = 0xffff, no handle on request */)8 1625(\256d; /*)1 538 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 2580 t
10 S f
(_)3209 2580 w
10 R f
(dscnt\) */)1 355 1 3259 2580 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 23 23
%%Page: 24 24
save
mark
24 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 24 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(First Response Format :)3 983 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 10 */)4 582(tprcnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( parameter bytes returned in this buffer */)7 1716(prcnt; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 2700 t
(* TRANSACT2)1 661 1 2034 2820 t
10 S f
(_)2695 2820 w
10 R f
(FINDFIRST function response is)3 1354 1 2745 2820 t
(* the \256nd \256rst speci\256c return)5 1192 1 2034 2940 t
(* information in the following format. */)6 1678 1 2034 3060 t
(WORD \256nd\256rst)1 1039 1 1274 3180 t
10 S f
(_)2313 3180 w
10 R f
(dir)2363 3180 w
10 S f
(_)2474 3180 w
10 R f
( Directory search handle */)4 1112(handle; /*)1 504 2 2524 3180 t
(WORD \256nd\256rst)1 1039 1 1274 3300 t
10 S f
(_)2313 3300 w
10 R f
( Number of matching)3 881(searchcount; /*)1 681 2 2363 3300 t
(* entries found */)3 726 1 2859 3420 t
(WORD \256nd\256rst)1 1039 1 1274 3540 t
10 S f
(_)2313 3540 w
10 R f
( end of search indicator. */)5 1104(eos; /*)1 602 2 2363 3540 t
(WORD \256nd\256rst)1 1039 1 1274 3660 t
10 S f
(_)2313 3660 w
10 R f
( error offset if EA error */)6 1083(offerror; /*)1 613 2 2363 3660 t
(WORD \256nd\256rst)1 1039 1 1274 3780 t
10 S f
(_)2313 3780 w
10 R f
( 0 - server does not require)6 1117(lastname; /*)1 659 2 2363 3780 t
(* \256ndnext)1 543 1 2859 3900 t
10 S f
(_)3402 3900 w
10 R f
(FileName[] in order)2 814 1 3452 3900 t
( continue search.)2 689(* to)1 293 2 2859 4020 t
(* else)1 238 1 2859 4140 t
( from start of returned)4 913(* offset)1 442 2 2859 4260 t
( to \256lename of last)4 776(* data)1 381 2 2859 4380 t
( entry returned.)2 628(* found)1 448 2 2859 4500 t
(*/)2859 4620 w
(BYTE smb)1 578 1 830 4740 t
10 S f
(_)1408 4740 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 4740 t
(BYTE smb)1 578 1 830 4860 t
10 S f
(_)1408 4860 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 621 2 1458 4860 t
10 S f
(_)3563 4860 w
10 R f
(dscnt\) */)1 355 1 3613 4860 t
(/* The data block contains the level dependent)7 1911 1 2001 4980 t
(* information about the matches found in the search.)8 2169 1 2034 5100 t
(*)2034 5220 w
(* If bit 2 in the \256nd\256rst)6 982 1 2034 5340 t
10 S f
(_)3016 5340 w
10 R f
(\257ags is set, each)3 673 1 3066 5340 t
(* returned \256le descriptor block will be preceeded)7 2015 1 2034 5460 t
(* by a four byte resume key.)6 1187 1 2034 5580 t
(*/)2034 5700 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 24 24
%%Page: 25 25
save
mark
25 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 25 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Subsequent Response Format :)3 1260 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 8 */)4 532(tprcnt; /*)1 539 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 539 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0 */)4 532(prcnt; /*)1 539 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0 */)4 532(proff; /*)1 539 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 */)4 532(prdisp; /*)1 539 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 539 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 539 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 539 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 539 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 539 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 539 2 1458 2700 t
10 S f
(_)3481 2700 w
10 R f
(dscnt\) */)1 355 1 3531 2700 t
(/* The data block contains the level dependent)7 1911 1 1919 2820 t
(* information about the matches found in the search.)8 2169 1 1952 2940 t
(*)1952 3060 w
(* If bit 2 in the \256nd\256rst)6 982 1 1952 3180 t
10 S f
(_)2934 3180 w
10 R f
(\257ags is set, each)3 673 1 2984 3180 t
(* returned \256le descriptor block will be preceeded)7 2015 1 1952 3300 t
(* by a four byte resume key.)6 1187 1 1952 3420 t
(*/)1952 3540 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 25 25
%%Page: 26 26
save
mark
26 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 26 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.3. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(FINDNEXT)1811 840 w
10 R f
(The function code TRANSACT2)3 1407 1 720 996 t
10 S f
(_)2127 996 w
10 R f
(FINDNEXT in smb)2 846 1 2177 996 t
10 S f
(_)3023 996 w
10 R f
( primary TRANSACT2 request)3 1338(setup[0] in the)2 629 2 3073 996 t
(identi\256es a request to continue a \256le search started by a TRANSACT)11 2848 1 720 1116 t
10 S f
(_)3568 1116 w
10 R f
(FINDFIRST search.)1 818 1 3618 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 882 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( total param bytes being sent */)6 1297(tpscnt; /*)1 882 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 882 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 882 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = maximum return data length */)7 1641(mdrcnt; /*)1 882 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 882 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 882 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 882 2 1497 2328 t
(bit 0 - 0)3 338 1 2433 2448 t
(bit 1 - 0 */)4 449 1 2433 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for \256nd next */)9 1499(timeout; /*)1 882 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 882 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = tpscnt, parms must be in primary request */)10 2159(pscnt; /*)1 882 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB hdr to parameter bytes */)10 2149(psoff; /*)1 882 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 882 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 882 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 882 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 882 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 2)3 421(setup1; /*)1 882 4 1497 3648 t
10 S f
(_)3538 3648 w
10 R f
(FINDNEXT */)1 610 1 3588 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 882 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 882 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the TRANSACT2)6 1745(param[*]; /*)1 882 2 1497 4008 t
10 S f
(_)4124 4008 w
10 R f
(FINDNEXT)4174 4008 w
(* function is the \256nd next speci\256c information)7 1908 1 2334 4128 t
(* in the following format. */)5 1173 1 2334 4248 t
(WORD \256ndnext)1 1316 1 1313 4368 t
10 S f
(_)2629 4368 w
10 R f
( Directory search handle */)4 1112(DirHandle; /*)1 725 2 2679 4368 t
(WORD \256ndnext)1 1316 1 1313 4488 t
10 S f
(_)2629 4488 w
10 R f
( Number of entries to \256nd */)6 1186(SearchCount; /*)1 754 2 2679 4488 t
(WORD \256ndnext)1 1316 1 1313 4608 t
10 S f
(_)2629 4608 w
10 R f
(FileInfoLevel; /* Search level */)4 1330 1 2679 4608 t
(DWORD \256ndnext)1 1349 1 1280 4728 t
10 S f
(_)2629 4728 w
10 R f
( Server reserved resume key */)5 1272(ResumeKey; /*)1 759 2 2679 4728 t
(WORD \256ndnext)1 1316 1 1313 4848 t
10 S f
(_)2629 4848 w
10 R f
( \256nd \257ags */)3 522(\257ags; /*)1 592 2 2679 4848 t
(/* Bit 0: set - close search after)7 1295 1 3093 4968 t
( request.)1 346(* this)1 657 2 3126 5088 t
(* Bit 1: set - close search if end)8 1323 1 3126 5208 t
( search reached.)2 654(* of)1 595 2 3126 5328 t
(* Bit 2: set - Requester requires)6 1313 1 3126 5448 t
( key for each)3 541(* resume)1 800 2 3126 5568 t
( found.)1 291(* entry)1 717 2 3126 5688 t
(* Bit 3: set - Continue search from)7 1441 1 3126 5808 t
( entry returned.)2 628(* last)1 651 2 3126 5928 t
( - Rewind search. */)4 833(* clr)1 419 2 3126 6048 t
(BYTE \256ndnext)1 739 1 869 6168 t
10 S f
(_)1608 6168 w
10 R f
( Name of \256le to resume search from */)8 1605(FileName[]; /*)1 721 2 1658 6168 t
(BYTE smb)1 578 1 869 6288 t
10 S f
(_)1447 6288 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 882 2 1497 6288 t
(BYTE smb)1 578 1 869 6408 t
10 S f
(_)1447 6408 w
10 R f
( Additional FileInfoLevel dependent match)4 1763(data[*]; /*)1 882 2 1497 6408 t
(* information. For a search requiring extended)6 1908 1 2334 6528 t
(* attribute matching the data buffer contains)6 1817 1 2334 6648 t
(* the FEAList data for the seach.)6 1365 1 2334 6768 t
(*/)2334 6888 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 26 26
%%Page: 27 27
save
mark
27 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 27 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( total parmeter bytes sent */)5 1147(tpscnt; /*)1 538 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( search handle returned from \256nd \256rst */)7 1667(\256d; /*)1 538 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 2460 t
10 S f
(_)3209 2460 w
10 R f
(dscnt\) */)1 355 1 3259 2460 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 27 27
%%Page: 28 28
save
mark
28 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 28 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(First Response Format :)3 983 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 6 */)4 532(tprcnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( parameter bytes returned in this buffer */)7 1716(prcnt; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( The parmater block for the TRANSACT2)6 1745(param[*]; /*)1 621 2 1458 2700 t
10 S f
(_)3824 2700 w
10 R f
(FINDNEXT)3874 2700 w
(* function response is the \256nd next speci\256c return)8 2056 1 2034 2820 t
(* information in the following format. */)6 1678 1 2034 2940 t
(WORD \256ndnext)1 1088 1 1241 3060 t
10 S f
(_)2329 3060 w
10 R f
( Number of matching)3 881(searchcount; /*)1 681 2 2379 3060 t
(* entries found */)3 726 1 2826 3180 t
(WORD \256ndnext)1 1088 1 1241 3300 t
10 S f
(_)2329 3300 w
10 R f
( end of search indicator. */)5 1104(eos; /*)1 602 2 2379 3300 t
(WORD \256ndnext)1 1088 1 1241 3420 t
10 S f
(_)2329 3420 w
10 R f
( error offset if EA error */)6 1083(offerror; /*)1 613 2 2379 3420 t
(WORD \256nd\256rst)1 1072 1 1241 3540 t
10 S f
(_)2313 3540 w
10 R f
( 0 - server does not require)6 1117(lastname; /*)1 626 2 2363 3540 t
(* \256ndnext)1 543 1 2826 3660 t
10 S f
(_)3369 3660 w
10 R f
(FileName[] in order)2 814 1 3419 3660 t
( continue search.)2 689(* to)1 293 2 2826 3780 t
(* else)1 238 1 2826 3900 t
( from start of returned)4 913(* offset)1 442 2 2826 4020 t
( to \256lename of last)4 776(* data)1 381 2 2826 4140 t
( entry returned.)2 628(* found)1 448 2 2826 4260 t
(*/)2826 4380 w
(BYTE smb)1 578 1 830 4500 t
10 S f
(_)1408 4500 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 4500 t
(BYTE smb)1 578 1 830 4620 t
10 S f
(_)1408 4620 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 621 2 1458 4620 t
10 S f
(_)3563 4620 w
10 R f
(dscnt\) */)1 355 1 3613 4620 t
(/* The data block contains the level dependent)7 1911 1 2001 4740 t
(* information about the matches found in the search.)8 2169 1 2034 4860 t
(*)2034 4980 w
(* If bit 2 in the \256nd\256rst)6 982 1 2034 5100 t
10 S f
(_)3016 5100 w
10 R f
(\257ags is set, each)3 673 1 3066 5100 t
(* returned \256le descriptor block will be preceeded)7 2015 1 2034 5220 t
(* by a four byte resume key.)6 1187 1 2034 5340 t
(*/)2034 5460 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 28 28
%%Page: 29 29
save
mark
29 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 29 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Subsequent Response Format :)3 1260 1 720 840 t
(BYTE smb)1 578 1 830 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( value = 6 */)4 532(tprcnt; /*)1 539 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 539 3 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0 */)4 532(prcnt; /*)1 539 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 */)4 532(proff; /*)1 539 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( value = 0 */)4 532(prdisp; /*)1 539 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 539 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 539 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 539 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 2460 t
(WORD smb)1 622 1 786 2580 t
10 S f
(_)1408 2580 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 539 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 539 2 1458 2700 t
(BYTE smb)1 578 1 830 2820 t
10 S f
(_)1408 2820 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 539 2 1458 2820 t
10 S f
(_)3481 2820 w
10 R f
(dscnt\) */)1 355 1 3531 2820 t
(/* The data block contains the level dependent)7 1911 1 1919 2940 t
(* information about the matches found in the search.)8 2169 1 1952 3060 t
(*)1952 3180 w
(* If bit 2 in the \256nd\256rst)6 982 1 1952 3300 t
10 S f
(_)2934 3300 w
10 R f
(\257ags is set, each)3 673 1 2984 3300 t
(* returned \256le descriptor block will be preceeded)7 2015 1 1952 3420 t
(* by a four byte resume key.)6 1187 1 1952 3540 t
(*/)1952 3660 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 29 29
%%Page: 30 30
save
mark
30 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 30 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.4. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(QFSINFO)1811 840 w
10 R f
(The function code TRANSACT2)3 1419 1 720 996 t
10 S f
(_)2139 996 w
10 R f
( smb)1 223(QFSINFO in)1 550 2 2189 996 t
10 S f
(_)2962 996 w
10 R f
(setup[0] in the primary TRANSACT2 requests)5 2028 1 3012 996 t
(identi\256es a request to query information about a \256le system.)9 2470 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = 2, total parameter bytes being sent */)9 1892(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( maximum data length to return */)6 1414(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
( */)1 177(bit 1 - 0)3 338 2 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for qfsinfo */)8 1421(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = 2, params are in primary request */)9 1813(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB Hdr to parameter bytes */)10 2171(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( value = 0, no data sent with qfsinfo */)9 1610(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( value = 0, no data sent with qfsinfo */)9 1610(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 3)3 421(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3277 3648 w
10 R f
(QFSINFO */)1 528 1 3327 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(* TRANSACT2)1 661 1 2073 4128 t
10 S f
(_)2734 4128 w
10 R f
(QFSINFO function is)2 883 1 2784 4128 t
(* the qfsinfo speci\256c information)4 1364 1 2073 4248 t
(* in the following format. */)5 1173 1 2073 4368 t
(WORD qfsinfo)1 1043 1 1280 4488 t
10 S f
(_)2323 4488 w
10 R f
( Level of information required */)5 1357(FSInfoLevel; /*)1 677 2 2373 4488 t
(Response Format \(One or more of these\) :)7 1739 1 720 4908 t
(BYTE smb)1 578 1 830 5088 t
10 S f
(_)1408 5088 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 5088 t
(WORD smb)1 622 1 786 5208 t
10 S f
(_)1408 5208 w
10 R f
( value = 0 */)4 532(tprcnt; /*)1 539 2 1458 5208 t
(WORD smb)1 622 1 786 5328 t
10 S f
(_)1408 5328 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 539 3 1458 5328 t
(WORD smb)1 622 1 786 5448 t
10 S f
(_)1408 5448 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 5448 t
(WORD smb)1 622 1 786 5568 t
10 S f
(_)1408 5568 w
10 R f
( value = 0, no return param bytes for QFSINFO */)10 2086(prcnt; /*)1 539 2 1458 5568 t
(WORD smb)1 622 1 786 5688 t
10 S f
(_)1408 5688 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 539 2 1458 5688 t
(WORD smb)1 622 1 786 5808 t
10 S f
(_)1408 5808 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 539 2 1458 5808 t
(WORD smb)1 622 1 786 5928 t
10 S f
(_)1408 5928 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 539 2 1458 5928 t
(WORD smb)1 622 1 786 6048 t
10 S f
(_)1408 6048 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 539 2 1458 6048 t
(WORD smb)1 622 1 786 6168 t
10 S f
(_)1408 6168 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 539 2 1458 6168 t
(BYTE smb)1 578 1 830 6288 t
10 S f
(_)1408 6288 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 6288 t
(BYTE smb)1 578 1 830 6408 t
10 S f
(_)1408 6408 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 6408 t
(WORD smb)1 622 1 786 6528 t
10 S f
(_)1408 6528 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 539 2 1458 6528 t
(BYTE smb)1 578 1 830 6648 t
10 S f
(_)1408 6648 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 539 2 1458 6648 t
(BYTE smb)1 578 1 830 6768 t
10 S f
(_)1408 6768 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 539 2 1458 6768 t
10 S f
(_)3481 6768 w
10 R f
(dscnt\) */)1 355 1 3531 6768 t
(/* The data block contains the level dependent)7 1911 1 1919 6888 t
(* information about the \256le system.)5 1462 1 1952 7008 t
(*/)1952 7128 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 30 30
%%Page: 31 31
save
mark
31 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 31 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.5. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(SETFSINFO)1811 840 w
10 R f
(The function code TRANSACT2)3 1389 1 720 996 t
10 S f
(_)2109 996 w
10 R f
(SETFSINFO in smb)2 858 1 2159 996 t
10 S f
(_)3017 996 w
10 R f
(setup[0] in the primary TRANSACT2 requests)5 1973 1 3067 996 t
(identi\256es a request to set information for a \256le system device.)10 2541 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = 2,total number of param bytes being sent */)10 2164(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = 0. No data returned */)7 1276(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
(bit 1 - 0 */)4 449 1 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for setfsinfo */)8 1482(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = 4, all params are in primary request */)10 1946(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB Hdr to parameter bytes */)10 2171(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 4)3 421(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3277 3648 w
10 R f
(SETFSINFO */)1 634 1 3327 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(* TRANSACT2)1 661 1 2073 4128 t
10 S f
(_)2734 4128 w
10 R f
(SETFSINFO function is)2 989 1 2784 4128 t
(* the setfsinfo speci\256c information)4 1425 1 2073 4248 t
(* in the following format. */)5 1173 1 2073 4368 t
(WORD setfsinfo)1 1104 1 1280 4488 t
10 S f
(_)2384 4488 w
10 R f
( Level of information)3 881(FSInfoLevel; /*)1 677 2 2434 4488 t
(* provided */)2 549 1 2865 4608 t
(BYTE smb)1 578 1 869 4728 t
10 S f
(_)1447 4728 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 4728 t
(BYTE smb)1 578 1 869 4848 t
10 S f
(_)1447 4848 w
10 R f
( Level dependent \256le system information */)6 1791(data[*]; /*)1 621 2 1497 4848 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 5148 t
(BYTE smb)1 578 1 830 5328 t
10 S f
(_)1408 5328 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 5328 t
(WORD smb)1 622 1 786 5448 t
10 S f
(_)1408 5448 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 538 2 1458 5448 t
(WORD smb)1 622 1 786 5568 t
10 S f
(_)1408 5568 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 5568 t
(WORD smb)1 622 1 786 5688 t
10 S f
(_)1408 5688 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 5688 t
(WORD smb)1 622 1 786 5808 t
10 S f
(_)1408 5808 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 5808 t
(WORD smb)1 622 1 786 5928 t
10 S f
(_)1408 5928 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 5928 t
(WORD smb)1 622 1 786 6048 t
10 S f
(_)1408 6048 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 6048 t
(WORD smb)1 622 1 786 6168 t
10 S f
(_)1408 6168 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 6168 t
(WORD smb)1 622 1 786 6288 t
10 S f
(_)1408 6288 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 6288 t
(WORD smb)1 622 1 786 6408 t
10 S f
(_)1408 6408 w
10 R f
( value = 0xffff, no handle on request */)8 1625(\256d; /*)1 538 2 1458 6408 t
(WORD smb)1 622 1 786 6528 t
10 S f
(_)1408 6528 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 6528 t
(BYTE smb)1 578 1 830 6648 t
10 S f
(_)1408 6648 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 6648 t
(BYTE smb)1 578 1 830 6768 t
10 S f
(_)1408 6768 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 6768 t
10 S f
(_)3209 6768 w
10 R f
(dscnt\) */)1 355 1 3259 6768 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 31 31
%%Page: 32 32
save
mark
32 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 32 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Response Format \(one only\):)3 1187 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 0 */)4 532(tprcnt; /*)1 539 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = 0 no data bytes)6 997(tdrcnt; /*)1 539 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0 no return parameters for setfsinfo */)9 1932(prcnt; /*)1 539 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 539 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 539 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( value = 0 no data bytes */)7 1108(drcnt; /*)1 539 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( value = 0 no data bytes */)7 1108(droff; /*)1 539 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( value = 0 no data bytes */)7 1108(drdisp; /*)1 539 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( value = 0 */)4 532(bcc; /*)1 539 2 1458 2460 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 32 32
%%Page: 33 33
save
mark
33 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 33 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.6. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(QPATHINFO)1811 840 w
10 R f
(The function code TRANSACT2)3 1374 1 720 996 t
10 S f
(_)2094 996 w
10 R f
(QPATHINFO in smb)2 893 1 2144 996 t
10 S f
(_)3037 996 w
10 R f
(setup[0] in the primary TRANSACT2 requests)5 1953 1 3087 996 t
(identi\256es a request to query information about speci\256c \256le or subdirectory.)10 3068 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1452 t
10 S f
(_)1447 1452 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1452 t
(WORD smb)1 622 1 825 1572 t
10 S f
(_)1447 1572 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1572 t
(WORD smb)1 622 1 825 1692 t
10 S f
(_)1447 1692 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1692 t
(WORD smb)1 622 1 825 1812 t
10 S f
(_)1447 1812 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1812 t
(WORD smb)1 622 1 825 1932 t
10 S f
(_)1447 1932 w
10 R f
( maximum data length to return */)6 1414(mdrcnt; /*)1 621 2 1497 1932 t
(BYTE smb)1 578 1 869 2052 t
10 S f
(_)1447 2052 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2052 t
(BYTE smb)1 578 1 869 2172 t
10 S f
(_)1447 2172 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2172 t
(WORD smb)1 622 1 825 2292 t
10 S f
(_)1447 2292 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2292 t
(bit 0 - 0)3 338 1 2172 2412 t
(bit 1 - 0 */)4 449 1 2172 2532 t
(DWORD smb)1 694 1 753 2652 t
10 S f
(_)1447 2652 w
10 R f
( value = 0. Not used for qpathinfo */)8 1521(timeout; /*)1 621 2 1497 2652 t
(WORD smb)1 622 1 825 2772 t
10 S f
(_)1447 2772 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2772 t
(WORD smb)1 622 1 825 2892 t
10 S f
(_)1447 2892 w
10 R f
( value = tpscnt, all params are in primary request */)10 2135(pscnt; /*)1 621 2 1497 2892 t
(WORD smb)1 622 1 825 3012 t
10 S f
(_)1447 3012 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(psoff; /*)1 621 2 1497 3012 t
(WORD smb)1 622 1 825 3132 t
10 S f
(_)1447 3132 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3132 t
(WORD smb)1 622 1 825 3252 t
10 S f
(_)1447 3252 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3252 t
(BYTE smb)1 578 1 869 3372 t
10 S f
(_)1447 3372 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3372 t
(BYTE smb)1 578 1 869 3492 t
10 S f
(_)1447 3492 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3492 t
(WORD smb)1 622 1 825 3612 t
10 S f
(_)1447 3612 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 5)3 421(setup1; /*)1 621 4 1497 3612 t
10 S f
(_)3277 3612 w
10 R f
(QPATHINFO */)1 677 1 3327 3612 t
(WORD smb)1 622 1 825 3732 t
10 S f
(_)1447 3732 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3732 t
(BYTE smb)1 578 1 869 3852 t
10 S f
(_)1447 3852 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3852 t
(BYTE smb)1 578 1 869 3972 t
10 S f
(_)1447 3972 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 3972 t
(* TRANSACT2)1 661 1 2073 4092 t
10 S f
(_)2734 4092 w
10 R f
(QPATHINFO function is the)3 1187 1 2784 4092 t
(* qpathinfo speci\256c information)3 1309 1 2073 4212 t
(* in the following format. */)5 1173 1 2073 4332 t
(WORD qpathinfo)1 1110 1 1313 4452 t
10 S f
(_)2423 4452 w
10 R f
(PathInfoLevel; /* Info level required. */)5 1637 1 2473 4452 t
(DWORD qpathinfo)1 1143 1 1280 4572 t
10 S f
(_)2423 4572 w
10 R f
( Reserved.)1 429(rsvd; /*)1 608 2 2473 4572 t
(* Must be zero. */)4 756 1 2898 4692 t
(BYTE qpathinfo)1 1143 1 1280 4812 t
10 S f
(_)2423 4812 w
10 R f
( File/directory name. */)3 962(PathName[]; /*)1 720 2 2473 4812 t
(BYTE smb)1 578 1 869 4932 t
10 S f
(_)1447 4932 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 4932 t
(BYTE smb)1 578 1 869 5052 t
10 S f
(_)1447 5052 w
10 R f
( Additional FileInfoLevel dependent information */)5 2102(data[*]; /*)1 621 2 1497 5052 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 5352 t
(BYTE smb)1 578 1 830 5532 t
10 S f
(_)1408 5532 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 5532 t
(WORD smb)1 622 1 786 5652 t
10 S f
(_)1408 5652 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 538 2 1458 5652 t
(WORD smb)1 622 1 786 5772 t
10 S f
(_)1408 5772 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 5772 t
(WORD smb)1 622 1 786 5892 t
10 S f
(_)1408 5892 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 5892 t
(WORD smb)1 622 1 786 6012 t
10 S f
(_)1408 6012 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 6012 t
(WORD smb)1 622 1 786 6132 t
10 S f
(_)1408 6132 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 6132 t
(WORD smb)1 622 1 786 6252 t
10 S f
(_)1408 6252 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 6252 t
(WORD smb)1 622 1 786 6372 t
10 S f
(_)1408 6372 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 6372 t
(WORD smb)1 622 1 786 6492 t
10 S f
(_)1408 6492 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 6492 t
(WORD smb)1 622 1 786 6612 t
10 S f
(_)1408 6612 w
10 R f
( value = 0xffff, no handle on request */)8 1625(\256d; /*)1 538 2 1458 6612 t
(WORD smb)1 622 1 786 6732 t
10 S f
(_)1408 6732 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 6732 t
(BYTE smb)1 578 1 830 6852 t
10 S f
(_)1408 6852 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 6852 t
(BYTE smb)1 578 1 830 6972 t
10 S f
(_)1408 6972 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 6972 t
10 S f
(_)3209 6972 w
10 R f
(dscnt\) */)1 355 1 3259 6972 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 33 33
%%Page: 34 34
save
mark
34 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 34 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(First Response Format :)3 983 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 2 */)4 532(tprcnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 2 param bytes returned for QFSINFO */)9 2022(prcnt; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 2700 t
(* TRANSACT2)1 661 1 2034 2820 t
10 S f
(_)2695 2820 w
10 R f
(QPATHINFO response is)2 1048 1 2745 2820 t
(* the qpathinfo speci\256c return)4 1230 1 2034 2940 t
(* information in the following format. */)6 1678 1 2034 3060 t
(WORD qpathinfo)1 1110 1 1274 3180 t
10 S f
(_)2384 3180 w
10 R f
( error offset if EA error */)6 1083(offerror; /*)1 613 2 2434 3180 t
(BYTE smb)1 578 1 830 3300 t
10 S f
(_)1408 3300 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 3300 t
(BYTE smb)1 578 1 830 3420 t
10 S f
(_)1408 3420 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 621 2 1458 3420 t
10 S f
(_)3563 3420 w
10 R f
(dscnt\) */)1 355 1 3613 3420 t
(/* The data block contains the requested level)7 1883 1 2001 3540 t
(* dependent information about the path.)5 1638 1 2034 3660 t
(*/)2034 3780 w
(Subsequent Response Format :)3 1260 1 720 4080 t
(BYTE smb)1 578 1 830 4260 t
10 S f
(_)1408 4260 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 4260 t
(WORD smb)1 622 1 786 4380 t
10 S f
(_)1408 4380 w
10 R f
( value = 2 */)4 532(tprcnt; /*)1 539 2 1458 4380 t
(WORD smb)1 622 1 786 4500 t
10 S f
(_)1408 4500 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 539 3 1458 4500 t
(WORD smb)1 622 1 786 4620 t
10 S f
(_)1408 4620 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 4620 t
(WORD smb)1 622 1 786 4740 t
10 S f
(_)1408 4740 w
10 R f
( value = 0 */)4 532(prcnt; /*)1 539 2 1458 4740 t
(WORD smb)1 622 1 786 4860 t
10 S f
(_)1408 4860 w
10 R f
( value = 0 */)4 532(proff; /*)1 539 2 1458 4860 t
(WORD smb)1 622 1 786 4980 t
10 S f
(_)1408 4980 w
10 R f
( value = 0 */)4 532(prdisp; /*)1 539 2 1458 4980 t
(WORD smb)1 622 1 786 5100 t
10 S f
(_)1408 5100 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 539 2 1458 5100 t
(WORD smb)1 622 1 786 5220 t
10 S f
(_)1408 5220 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 539 2 1458 5220 t
(WORD smb)1 622 1 786 5340 t
10 S f
(_)1408 5340 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 539 2 1458 5340 t
(BYTE smb)1 578 1 830 5460 t
10 S f
(_)1408 5460 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 5460 t
(BYTE smb)1 578 1 830 5580 t
10 S f
(_)1408 5580 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 5580 t
(WORD smb)1 622 1 786 5700 t
10 S f
(_)1408 5700 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 539 2 1458 5700 t
(BYTE smb)1 578 1 830 5820 t
10 S f
(_)1408 5820 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 539 2 1458 5820 t
(BYTE smb)1 578 1 830 5940 t
10 S f
(_)1408 5940 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 539 2 1458 5940 t
10 S f
(_)3481 5940 w
10 R f
(dscnt\) */)1 355 1 3531 5940 t
(/* The data block contains the requested level)7 1883 1 1919 6060 t
(* dependent information about the path.)5 1638 1 1952 6180 t
(*/)1952 6300 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 34 34
%%Page: 35 35
save
mark
35 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 35 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.7. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(SETPATHINFO)1811 840 w
10 R f
( TRANSACT2)1 648(The function code)2 814 2 720 996 t
10 S f
(_)2182 996 w
10 R f
(SETPATHINFO in smb)2 1057 1 2232 996 t
10 S f
(_)3289 996 w
10 R f
(setup[0] in the primary TRANSACT2)4 1701 1 3339 996 t
(requests identi\256es a request to set information for a \256le or directory.)11 2806 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = 0. No data returned */)7 1276(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
( */)1 144(bit 1 - 0)3 338 2 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for setpathinfo */)8 1582(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = tpscnt, params are in primary request */)9 2002(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB Hdr to param bytes */)10 2022(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 6)3 421(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3277 3648 w
10 R f
(SETPATHINFO */)1 783 1 3327 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(* TRANSACT2)1 661 1 2073 4128 t
10 S f
(_)2734 4128 w
10 R f
(SETPATHINFO function is)2 1138 1 2784 4128 t
(* the setpathinfo speci\256c information)4 1525 1 2073 4248 t
(* in the following format. */)5 1173 1 2073 4368 t
(WORD setpathinfo)1 1171 1 1313 4488 t
10 S f
(_)2484 4488 w
10 R f
( Info level supplied. */)4 934(PathInfoLevel; /*)1 743 2 2534 4488 t
(DWORD setpathinfo)1 1204 1 1280 4608 t
10 S f
(_)2484 4608 w
10 R f
( Reserved.)1 429(rsvd; /*)1 641 2 2534 4608 t
(* Must be zero. */)4 756 1 2997 4728 t
(BYTE setpathinfo)1 1171 1 1313 4848 t
10 S f
(_)2484 4848 w
10 R f
( path name to set)4 709(pathname[]; /*)1 725 2 2534 4848 t
(* information on */)3 799 1 2997 4968 t
(BYTE smb)1 578 1 869 5088 t
10 S f
(_)1447 5088 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 5088 t
(BYTE smb)1 578 1 869 5208 t
10 S f
(_)1447 5208 w
10 R f
( Additional FileInfoLevel dependent information. */)5 2127(data[*]; /*)1 621 2 1497 5208 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 5508 t
(BYTE smb)1 578 1 830 5688 t
10 S f
(_)1408 5688 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 5688 t
(WORD smb)1 622 1 786 5808 t
10 S f
(_)1408 5808 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 538 2 1458 5808 t
(WORD smb)1 622 1 786 5928 t
10 S f
(_)1408 5928 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 5928 t
(WORD smb)1 622 1 786 6048 t
10 S f
(_)1408 6048 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 6048 t
(WORD smb)1 622 1 786 6168 t
10 S f
(_)1408 6168 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 6168 t
(WORD smb)1 622 1 786 6288 t
10 S f
(_)1408 6288 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 6288 t
(WORD smb)1 622 1 786 6408 t
10 S f
(_)1408 6408 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 6408 t
(WORD smb)1 622 1 786 6528 t
10 S f
(_)1408 6528 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 6528 t
(WORD smb)1 622 1 786 6648 t
10 S f
(_)1408 6648 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 6648 t
(WORD smb)1 622 1 786 6768 t
10 S f
(_)1408 6768 w
10 R f
( value = 0xffff, no handle on request */)8 1625(\256d; /*)1 538 2 1458 6768 t
(WORD smb)1 622 1 786 6888 t
10 S f
(_)1408 6888 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 6888 t
(BYTE smb)1 578 1 830 7008 t
10 S f
(_)1408 7008 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 7008 t
(BYTE smb)1 578 1 830 7128 t
10 S f
(_)1408 7128 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 7128 t
10 S f
(_)3209 7128 w
10 R f
(dscnt\) */)1 355 1 3259 7128 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 35 35
%%Page: 36 36
save
mark
36 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 36 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Response Format \(one only\):)3 1187 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 2 */)4 532(tprcnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = 0 no data bytes)6 997(tdrcnt; /*)1 621 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 2 parameter bytes being returned */)8 1827(prcnt; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( value = 0 no data bytes */)7 1108(drcnt; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( value = 0 no data bytes */)7 1108(droff; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( value = 0 no data bytes */)7 1108(drdisp; /*)1 621 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 2700 t
(* TRANSACT2)1 661 1 2034 2820 t
10 S f
(_)2695 2820 w
10 R f
(SETPATHINFO function)1 1038 1 2745 2820 t
(* response is the setpathinfo)4 1164 1 2034 2940 t
(* speci\256c return information in)4 1275 1 2034 3060 t
(* the following format. */)4 1062 1 2034 3180 t
(WORD setpathinfo)1 1204 1 1241 3300 t
10 S f
(_)2445 3300 w
10 R f
( offset into FEAList data)4 1026(offerror; /*)1 481 2 2495 3300 t
(* of \256rst error which)4 858 1 2793 3420 t
(* occured while setting)3 953 1 2793 3540 t
(* the extended attributes. */)4 1139 1 2793 3660 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 36 36
%%Page: 37 37
save
mark
37 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 37 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.8. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(QFILEINFO)1811 840 w
10 R f
(The function code TRANSACT2)3 1389 1 720 996 t
10 S f
(_)2109 996 w
10 R f
(QFILEINFO in smb)2 853 1 2159 996 t
10 S f
(_)3012 996 w
10 R f
(setup[0] in the primary TRANSACT2 requests)5 1978 1 3062 996 t
(identi\256es a request to query information about speci\256c \256le.)8 2420 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = 4,total number of param bytes being sent */)10 2164(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( maximum data length to return */)6 1414(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
( */)1 144(bit 1 - 0)3 338 2 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for q\256leinfo */)8 1477(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = 4, all params are in primary request */)10 1946(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 7)3 421(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3277 3648 w
10 R f
(QFILEINFO */)1 627 1 3327 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(* TRANSACT2)1 661 1 2040 4128 t
10 S f
(_)2701 4128 w
10 R f
(QFILEINFO function)1 882 1 2751 4128 t
(* is the q\256leinfo speci\256c information)5 1520 1 2040 4248 t
(* in the following format. */)5 1173 1 2040 4368 t
(WORD q\256leinfo)1 1099 1 1280 4488 t
10 S f
(_)2379 4488 w
10 R f
( File handle. */)3 624(FileHandle; /*)1 682 2 2429 4488 t
(WORD q\256leinfo)1 1099 1 1280 4608 t
10 S f
(_)2379 4608 w
10 R f
(FileInfoLevel; /* Info level required. */)5 1615 1 2429 4608 t
(BYTE smb)1 578 1 869 4728 t
10 S f
(_)1447 4728 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 4728 t
(BYTE smb)1 578 1 869 4848 t
10 S f
(_)1447 4848 w
10 R f
( Additional FileInfoLevel dependent information. */)5 2127(data[*]; /*)1 621 2 1497 4848 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 5268 t
(BYTE smb)1 578 1 830 5448 t
10 S f
(_)1408 5448 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 5448 t
(WORD smb)1 622 1 786 5568 t
10 S f
(_)1408 5568 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 538 2 1458 5568 t
(WORD smb)1 622 1 786 5688 t
10 S f
(_)1408 5688 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 5688 t
(WORD smb)1 622 1 786 5808 t
10 S f
(_)1408 5808 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 5808 t
(WORD smb)1 622 1 786 5928 t
10 S f
(_)1408 5928 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 5928 t
(WORD smb)1 622 1 786 6048 t
10 S f
(_)1408 6048 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 6048 t
(WORD smb)1 622 1 786 6168 t
10 S f
(_)1408 6168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 6168 t
(WORD smb)1 622 1 786 6288 t
10 S f
(_)1408 6288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 6288 t
(WORD smb)1 622 1 786 6408 t
10 S f
(_)1408 6408 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 6408 t
(WORD smb)1 622 1 786 6528 t
10 S f
(_)1408 6528 w
10 R f
( \256le handle */)3 571(\256d; /*)1 538 2 1458 6528 t
(WORD smb)1 622 1 786 6648 t
10 S f
(_)1408 6648 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 6648 t
(BYTE smb)1 578 1 830 6768 t
10 S f
(_)1408 6768 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 6768 t
(BYTE smb)1 578 1 830 6888 t
10 S f
(_)1408 6888 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 6888 t
10 S f
(_)3209 6888 w
10 R f
(dscnt\) */)1 355 1 3259 6888 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 37 37
%%Page: 38 38
save
mark
38 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 38 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(First Response Format :)3 983 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 2 */)4 532(tprcnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 2 no param bytes returned for q\256leinfo */)10 2077(prcnt; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 2700 t
(* TRANSACT2)1 661 1 2034 2820 t
10 S f
(_)2695 2820 w
10 R f
(QFILEINFO response is)2 998 1 2745 2820 t
(* the q\256leinfo speci\256c return)4 1186 1 2034 2940 t
(* information in the following format. */)6 1678 1 2034 3060 t
(WORD q\256leinfo)1 1165 1 1274 3180 t
10 S f
(_)2439 3180 w
10 R f
( error offset if EA error */)6 1083(offerror; /*)1 613 2 2489 3180 t
(BYTE smb)1 578 1 830 3300 t
10 S f
(_)1408 3300 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 3300 t
(BYTE smb)1 578 1 830 3420 t
10 S f
(_)1408 3420 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 621 2 1458 3420 t
10 S f
(_)3563 3420 w
10 R f
(dscnt\) */)1 355 1 3613 3420 t
(/* The data block contains the requested level)7 1883 1 2001 3540 t
(* dependent information about the \256le. */)6 1705 1 2034 3660 t
(Subsequent Response Format :)3 1260 1 720 3960 t
(BYTE smb)1 578 1 830 4140 t
10 S f
(_)1408 4140 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 4140 t
(WORD smb)1 622 1 786 4260 t
10 S f
(_)1408 4260 w
10 R f
( value = 2 */)4 532(tprcnt; /*)1 539 2 1458 4260 t
(WORD smb)1 622 1 786 4380 t
10 S f
(_)1408 4380 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 539 3 1458 4380 t
(WORD smb)1 622 1 786 4500 t
10 S f
(_)1408 4500 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 4500 t
(WORD smb)1 622 1 786 4620 t
10 S f
(_)1408 4620 w
10 R f
( value = 0 */)4 532(prcnt; /*)1 539 2 1458 4620 t
(WORD smb)1 622 1 786 4740 t
10 S f
(_)1408 4740 w
10 R f
( value = 0 */)4 532(proff; /*)1 539 2 1458 4740 t
(WORD smb)1 622 1 786 4860 t
10 S f
(_)1408 4860 w
10 R f
( value = 0 */)4 532(prdisp; /*)1 539 2 1458 4860 t
(WORD smb)1 622 1 786 4980 t
10 S f
(_)1408 4980 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 539 2 1458 4980 t
(WORD smb)1 622 1 786 5100 t
10 S f
(_)1408 5100 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 539 2 1458 5100 t
(WORD smb)1 622 1 786 5220 t
10 S f
(_)1408 5220 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 539 2 1458 5220 t
(BYTE smb)1 578 1 830 5340 t
10 S f
(_)1408 5340 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 5340 t
(BYTE smb)1 578 1 830 5460 t
10 S f
(_)1408 5460 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 5460 t
(WORD smb)1 622 1 786 5580 t
10 S f
(_)1408 5580 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 539 2 1458 5580 t
(BYTE smb)1 578 1 830 5700 t
10 S f
(_)1408 5700 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 539 2 1458 5700 t
(BYTE smb)1 578 1 830 5820 t
10 S f
(_)1408 5820 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 539 2 1458 5820 t
10 S f
(_)3481 5820 w
10 R f
(dscnt\) */)1 355 1 3531 5820 t
(/* The data block contains the requested level)7 1883 1 1919 5940 t
(* dependent information about the \256le. */)6 1705 1 1952 6060 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 38 38
%%Page: 39 39
save
mark
39 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 39 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.9. TRANSACT2)1 1041 1 720 840 t
10 S f
(_)1761 840 w
10 B f
(SETFILEINFO)1811 840 w
10 R f
(The function code TRANSACT2)3 1359 1 720 996 t
10 S f
(_)2079 996 w
10 R f
(SETFILEINFO in smb)2 937 1 2129 996 t
10 S f
(_)3066 996 w
10 R f
( requests)1 363(setup[0] in the primary TRANSACT2)4 1561 2 3116 996 t
(identi\256es a request to set information for a speci\256c \256le.)9 2275 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = 6, total param bytes being sent */)9 1743(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = 0. No data returned */)7 1276(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
( */)1 144(bit 1 - 0)3 338 2 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for set\256leinfo */)8 1538(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = 6, parms must be in primary request */)10 1970(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB Hdr to parameter bytes */)10 2171(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 8)3 421(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3277 3648 w
10 R f
(SETFILEINFO */)1 733 1 3327 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(* TRANSACT2)1 661 1 2073 4128 t
10 S f
(_)2734 4128 w
10 R f
(SETFILEINFO function is)2 1088 1 2784 4128 t
(* the set\256leinfo speci\256c information)4 1481 1 2073 4248 t
(* in the following format. */)5 1173 1 2073 4368 t
(WORD set\256leinfo)1 1160 1 1280 4488 t
10 S f
(_)2440 4488 w
10 R f
( File handle. */)3 624(FileHandle; /*)1 682 2 2490 4488 t
(WORD set\256leinfo)1 1160 1 1280 4608 t
10 S f
(_)2440 4608 w
10 R f
(FileInfoLevel; /* Info level supplied. */)5 1622 1 2490 4608 t
(WORD set\256leinfo)1 1160 1 1280 4728 t
10 S f
(_)2440 4728 w
10 R f
( Flag)1 211(IOFlag; /*)1 653 2 2490 4728 t
(* 0x0010 - Write through)4 1053 1 2964 4848 t
(* 0x0020 - No cache */)5 974 1 2964 4968 t
(BYTE smb)1 578 1 869 5088 t
10 S f
(_)1447 5088 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 5088 t
(BYTE smb)1 578 1 869 5208 t
10 S f
(_)1447 5208 w
10 R f
( Additional FileInfoLevel dependent information.)4 2016(data[*]; /*)1 621 2 1497 5208 t
(/* For level = 2, smb)5 874 1 2040 5328 t
10 S f
(_)2914 5328 w
10 R f
(data[] contains the FEAList)3 1131 1 2964 5328 t
(* structure to set for this \256le. */)7 1311 1 2073 5448 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 39 39
%%Page: 40 40
save
mark
40 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 40 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 4 */)4 532(tpscnt; /*)1 538 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( \256le handle */)3 571(\256d; /*)1 538 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 2460 t
10 S f
(_)3209 2460 w
10 R f
(dscnt\) */)1 355 1 3259 2460 t
(Response Format \(one only\):)3 1187 1 720 2760 t
(BYTE smb)1 578 1 830 2940 t
10 S f
(_)1408 2940 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 2940 t
(WORD smb)1 622 1 786 3060 t
10 S f
(_)1408 3060 w
10 R f
( value = 2 */)4 532(tprcnt; /*)1 621 2 1458 3060 t
(WORD smb)1 622 1 786 3180 t
10 S f
(_)1408 3180 w
10 R f
( */)1 144( value = 0 no data bytes)6 997(tdrcnt; /*)1 621 3 1458 3180 t
(WORD smb)1 622 1 786 3300 t
10 S f
(_)1408 3300 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 3300 t
(WORD smb)1 622 1 786 3420 t
10 S f
(_)1408 3420 w
10 R f
( value = 2 parameter bytes being returned */)8 1827(prcnt; /*)1 621 2 1458 3420 t
(WORD smb)1 622 1 786 3540 t
10 S f
(_)1408 3540 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 3540 t
(WORD smb)1 622 1 786 3660 t
10 S f
(_)1408 3660 w
10 R f
( value = 0, byte displacement for these params */)9 2030(prdisp; /*)1 621 2 1458 3660 t
(WORD smb)1 622 1 786 3780 t
10 S f
(_)1408 3780 w
10 R f
( value = 0 no data bytes */)7 1108(drcnt; /*)1 621 2 1458 3780 t
(WORD smb)1 622 1 786 3900 t
10 S f
(_)1408 3900 w
10 R f
( value = 0 no data bytes */)7 1108(droff; /*)1 621 2 1458 3900 t
(WORD smb)1 622 1 786 4020 t
10 S f
(_)1408 4020 w
10 R f
( value = 0 no data bytes */)7 1108(drdisp; /*)1 621 2 1458 4020 t
(BYTE smb)1 578 1 830 4140 t
10 S f
(_)1408 4140 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 4140 t
(BYTE smb)1 578 1 830 4260 t
10 S f
(_)1408 4260 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 4260 t
(WORD smb)1 622 1 786 4380 t
10 S f
(_)1408 4380 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 4380 t
(BYTE smb)1 578 1 830 4500 t
10 S f
(_)1408 4500 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 4500 t
(BYTE smb)1 578 1 830 4620 t
10 S f
(_)1408 4620 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 4620 t
(* TRANSACT2)1 661 1 2034 4740 t
10 S f
(_)2695 4740 w
10 R f
(SETFILEINFO function)1 988 1 2745 4740 t
(* response is the set\256leinfo speci\256c)5 1458 1 2034 4860 t
(* return information in the)4 1092 1 2034 4980 t
(* following format. */)3 907 1 2034 5100 t
(WORD set\256leinfo)1 1160 1 1241 5220 t
10 S f
(_)2401 5220 w
10 R f
( offset into FEAList)3 827(offerror; /*)1 481 2 2451 5220 t
(* data of \256rst error)4 780 1 2793 5340 t
(* which occured while)3 930 1 2793 5460 t
(* setting the extended)3 898 1 2793 5580 t
(* attributes. */)2 591 1 2793 5700 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 40 40
%%Page: 41 41
save
mark
41 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 41 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.10. TRANSACT2)1 1091 1 720 840 t
10 S f
(_)1811 840 w
10 B f
(FSCTL)1861 840 w
10 R f
(The function code TRANSACT2)3 1455 1 720 996 t
10 S f
(_)2175 996 w
10 R f
(FSCTL in smb)2 680 1 2225 996 t
10 S f
(_)2905 996 w
10 R f
( TRANSACT2 requests)2 1041(setup[0] in the primary)3 1044 2 2955 996 t
(identi\256es a \256le system control request.)5 1578 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 14 + value of smb)7 1125(wct; /*)1 621 2 1497 1488 t
10 S f
(_)3243 1488 w
10 R f
(suwcnt */)1 394 1 3293 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( maximum data length to return */)6 1414(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 1. Function return code */)7 1438(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
(bit 1 - 0 */)4 449 1 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for fsctl */)8 1310(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( number of param bytes being sent in this buffer */)10 2105(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = number of setup words in this buffer */)10 1989(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( The setup word array for the)6 1211(setup[]; /*)1 621 2 1497 3648 t
(* TRANSACT2)1 661 1 2073 3768 t
10 S f
(_)2734 3768 w
10 R f
(FSINFO function is the)3 966 1 2784 3768 t
(* fsctl speci\256c information)3 1098 1 2073 3888 t
(* in the following format. */)5 1173 1 2073 4008 t
( :- TRANSACT2)2 705(WORD 9)1 810 2 1280 4128 t
10 S f
(_)2795 4128 w
10 R f
( TRANS2 command code. */)4 1195(FSCTL; /*)1 506 2 2845 4128 t
(WORD fsctl)1 932 1 1280 4248 t
10 S f
(_)2212 4248 w
10 R f
( File handle. */)3 624(FileHandle; /*)1 781 2 2262 4248 t
(WORD fsctl)1 932 1 1280 4368 t
10 S f
(_)2212 4368 w
10 R f
( FsCtl function code */)4 949( /*)1 210(Function code;)1 605 3 2262 4368 t
(WORD fsctl)1 932 1 1280 4488 t
10 S f
(_)2212 4488 w
10 R f
( Method for routing. */)4 951(RouteMethod; /*)1 854 2 2262 4488 t
(BYTE fsctl)1 932 1 1280 4608 t
10 S f
(_)2212 4608 w
10 R f
( The route name byte)4 880(RouteName[]; /*)1 847 2 2262 4608 t
(* array is zero padded)4 912 1 2865 4728 t
(* to an even length. */)5 928 1 2865 4848 t
(WORD smb)1 622 1 825 4968 t
10 S f
(_)1447 4968 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 4968 t
(BYTE smb)1 578 1 869 5088 t
10 S f
(_)1447 5088 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 5088 t
(BYTE smb)1 578 1 869 5208 t
10 S f
(_)1447 5208 w
10 R f
( File system speci\256c parameter block. */)6 1660(param[*]; /*)1 621 2 1497 5208 t
(BYTE smb)1 578 1 869 5328 t
10 S f
(_)1447 5328 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 5328 t
(BYTE smb)1 578 1 869 5448 t
10 S f
(_)1447 5448 w
10 R f
( File system speci\256c data block. */)6 1428(data[*]; /*)1 621 2 1497 5448 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 41 41
%%Page: 42 42
save
mark
42 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 42 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( number of parameter bytes being sent this buffer */)9 2143(pscnt; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(psoff; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( byte displacement for these parameter bytes */)7 1938(psdisp; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( \256le handle */)3 571(\256d; /*)1 621 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( File system speci\256c parameter block. */)6 1660(param[*]; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 621 2 1458 2700 t
10 S f
(_)3292 2700 w
10 R f
(dscnt\) */)1 355 1 3342 2700 t
(Response Format :)2 766 1 720 3000 t
(BYTE smb)1 578 1 830 3180 t
10 S f
(_)1408 3180 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 3180 t
(WORD smb)1 622 1 786 3300 t
10 S f
(_)1408 3300 w
10 R f
( */)1 144( value = total length of return parameter buffer)8 1926(tprcnt; /*)1 621 3 1458 3300 t
(WORD smb)1 622 1 786 3420 t
10 S f
(_)1408 3420 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 3420 t
(WORD smb)1 622 1 786 3540 t
10 S f
(_)1408 3540 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 3540 t
(WORD smb)1 622 1 786 3660 t
10 S f
(_)1408 3660 w
10 R f
( parameter bytes returned in this buffer */)7 1716(prcnt; /*)1 621 2 1458 3660 t
(WORD smb)1 622 1 786 3780 t
10 S f
(_)1408 3780 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(proff; /*)1 621 2 1458 3780 t
(WORD smb)1 622 1 786 3900 t
10 S f
(_)1408 3900 w
10 R f
( value = 0 byte displacement for these param bytes */)10 2210(prdisp; /*)1 621 2 1458 3900 t
(WORD smb)1 622 1 786 4020 t
10 S f
(_)1408 4020 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 4020 t
(WORD smb)1 622 1 786 4140 t
10 S f
(_)1408 4140 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 4140 t
(WORD smb)1 622 1 786 4260 t
10 S f
(_)1408 4260 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 4260 t
(BYTE smb)1 578 1 830 4380 t
10 S f
(_)1408 4380 w
10 R f
( value = 0, no set up return words */)9 1515(suwcnt; /*)1 621 2 1458 4380 t
(BYTE smb)1 578 1 830 4500 t
10 S f
(_)1408 4500 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 4500 t
(WORD smb)1 622 1 786 4620 t
10 S f
(_)1408 4620 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 4620 t
(BYTE smb)1 578 1 830 4740 t
10 S f
(_)1408 4740 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 4740 t
(BYTE smb)1 578 1 830 4860 t
10 S f
(_)1408 4860 w
10 R f
( File system speci\256c return parameter block */)7 1906(param[*]; /*)1 621 2 1458 4860 t
(BYTE smb)1 578 1 830 4980 t
10 S f
(_)1408 4980 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 4980 t
(BYTE smb)1 578 1 830 5100 t
10 S f
(_)1408 5100 w
10 R f
( File system speci\256c return data block. */)7 1699(data[*]; /*)1 621 2 1458 5100 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 42 42
%%Page: 43 43
save
mark
43 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 43 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.11. TRANSACT2)1 1091 1 720 840 t
10 S f
(_)1811 840 w
10 B f
(IOCTL)1861 840 w
10 R f
( code TRANSACT2)2 902(The function)1 555 2 720 996 t
10 S f
(_)2177 996 w
10 R f
(IOCTL in smb)2 675 1 2227 996 t
10 S f
(_)2902 996 w
10 R f
(setup[0] in the primary TRANSACT2 requests)5 2088 1 2952 996 t
(identi\256es a device control request.)4 1399 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 18 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( maximum data length to return */)6 1414(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 1. Function return code */)7 1438(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
(bit 1 - 0 */)4 449 1 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for fsctl */)8 1310(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( number of param bytes being sent in this buffer */)10 2105(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = number of setup words in this buffer */)10 1989(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( The setup word array for the)6 1211(setup[]; /*)1 621 2 1497 3648 t
(* TRANSACT2)1 661 1 2073 3768 t
10 S f
(_)2734 3768 w
10 R f
(IOCTL function is the ioctl)4 1126 1 2784 3768 t
(* functiom speci\256c information)3 1287 1 2073 3888 t
(* in the following format. */)5 1173 1 2073 4008 t
( :- TRANSACT2)2 705(WORD 10)1 860 2 1280 4128 t
10 S f
(_)2845 4128 w
10 R f
( Function code. */)3 746(IOCTL; /*)1 466 2 2895 4128 t
(WORD ioctl)1 938 1 1280 4248 t
10 S f
(_)2218 4248 w
10 R f
( Device handle. */)3 750(DevHandle; /*)1 824 2 2268 4248 t
(WORD ioctl)1 938 1 1280 4368 t
10 S f
(_)2218 4368 w
10 R f
( Device catgory. */)3 783(Category; /*)1 769 2 2268 4368 t
(WORD ioctl)1 938 1 1280 4488 t
10 S f
(_)2218 4488 w
10 R f
( Device function. */)3 817(Function; /*)1 759 2 2268 4488 t
(WORD smb)1 622 1 825 4608 t
10 S f
(_)1447 4608 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 4608 t
(BYTE smb)1 578 1 869 4728 t
10 S f
(_)1447 4728 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 4728 t
(BYTE smb)1 578 1 869 4848 t
10 S f
(_)1447 4848 w
10 R f
( Device/function speci\256c parameter block. */)5 1836(param[*]; /*)1 621 2 1497 4848 t
(BYTE smb)1 578 1 869 4968 t
10 S f
(_)1447 4968 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 4968 t
(BYTE smb)1 578 1 869 5088 t
10 S f
(_)1447 5088 w
10 R f
( Device/function speci\256c data block. */)5 1604(data[*]; /*)1 621 2 1497 5088 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 43 43
%%Page: 44 44
save
mark
44 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 44 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( number of parameter bytes being sent this buffer */)9 2143(pscnt; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(psoff; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( byte displacement for these parameter bytes */)7 1938(psdisp; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( \256le handle */)3 571(\256d; /*)1 621 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( Device/function speci\256c parameter block. */)5 1836(param[*]; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 621 2 1458 2700 t
10 S f
(_)3292 2700 w
10 R f
(dscnt\) */)1 355 1 3342 2700 t
(Response Format :)2 766 1 720 3000 t
(BYTE smb)1 578 1 830 3180 t
10 S f
(_)1408 3180 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 3180 t
(WORD smb)1 622 1 786 3300 t
10 S f
(_)1408 3300 w
10 R f
( */)1 144( value = total length of return parameter buffer)8 1926(tprcnt; /*)1 621 3 1458 3300 t
(WORD smb)1 622 1 786 3420 t
10 S f
(_)1408 3420 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 3420 t
(WORD smb)1 622 1 786 3540 t
10 S f
(_)1408 3540 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 3540 t
(WORD smb)1 622 1 786 3660 t
10 S f
(_)1408 3660 w
10 R f
( parameter bytes returned in this buffer */)7 1716(prcnt; /*)1 621 2 1458 3660 t
(WORD smb)1 622 1 786 3780 t
10 S f
(_)1408 3780 w
10 R f
( offset \(from start of SMB hdr\) to parameter bytes */)10 2182(proff; /*)1 621 2 1458 3780 t
(WORD smb)1 622 1 786 3900 t
10 S f
(_)1408 3900 w
10 R f
( value = 0 byte displacement for these param bytes */)10 2210(prdisp; /*)1 621 2 1458 3900 t
(WORD smb)1 622 1 786 4020 t
10 S f
(_)1408 4020 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 4020 t
(WORD smb)1 622 1 786 4140 t
10 S f
(_)1408 4140 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 4140 t
(WORD smb)1 622 1 786 4260 t
10 S f
(_)1408 4260 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 4260 t
(BYTE smb)1 578 1 830 4380 t
10 S f
(_)1408 4380 w
10 R f
( value = 0, no set up return words */)9 1515(suwcnt; /*)1 621 2 1458 4380 t
(BYTE smb)1 578 1 830 4500 t
10 S f
(_)1408 4500 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 4500 t
(WORD smb)1 622 1 786 4620 t
10 S f
(_)1408 4620 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 4620 t
(BYTE smb)1 578 1 830 4740 t
10 S f
(_)1408 4740 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 4740 t
(BYTE smb)1 578 1 830 4860 t
10 S f
(_)1408 4860 w
10 R f
( Device/function speci\256c return parameter block */)6 2082(param[*]; /*)1 621 2 1458 4860 t
(BYTE smb)1 578 1 830 4980 t
10 S f
(_)1408 4980 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 4980 t
(BYTE smb)1 578 1 830 5100 t
10 S f
(_)1408 5100 w
10 R f
( Device/function speci\256c return data block. */)6 1875(data[*]; /*)1 621 2 1458 5100 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 44 44
%%Page: 45 45
save
mark
45 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 45 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.12. TRANSACT2)1 1091 1 720 840 t
10 S f
(_)1811 840 w
10 B f
(FINDNOTIFYFIRST)1861 840 w
10 R f
(The function code TRANSACT2)3 1395 1 720 996 t
10 S f
(_)2115 996 w
10 R f
( smb)1 215(FINDNOTIFYFIRST in)1 997 2 2165 996 t
10 S f
(_)3377 996 w
10 R f
(setup[0] in the primary TRANSACT2)4 1613 1 3427 996 t
(request identi\256es a request to commence monitoring changes to a speci\256c \256le or directory.)13 3715 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total size of extended attribute list */)7 1541(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = maximum return data length */)7 1641(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
(bit 0 - 0)3 338 1 2172 2448 t
(bit 1 - 0)3 338 1 2172 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( Speci\256es duration to wait for changes */)7 1690(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = tpscnt, parms must be in primary request */)10 2159(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB hdr to parameter bytes */)10 2149(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 11)3 471(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3327 3648 w
10 R f
(FINDNOTIFYFIRST */)1 983 1 3377 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(TRANSACT2)2139 4128 w
10 S f
(_)2717 4128 w
10 R f
(FINDNOTIFYFIRST function is the \256nd)4 1682 1 2767 4128 t
(\256rst speci\256c information in the)4 1265 1 2139 4248 t
(following format. */)2 824 1 2139 4368 t
(WORD \256ndn\256rst)1 1089 1 1313 4488 t
10 S f
(_)2402 4488 w
10 R f
( Search attribute */)3 781(Attribute; /*)1 632 2 2452 4488 t
(WORD \256ndn\256rst)1 1089 1 1313 4608 t
10 S f
(_)2402 4608 w
10 R f
( Number of changes)3 830(ChangeCount; /*)1 755 2 2452 4608 t
(* to wait for */)4 626 1 2931 4728 t
(WORD \256ndn\256rst)1 1089 1 1313 4848 t
10 S f
(_)2402 4848 w
10 R f
( Info level required */)4 902(Level; /*)1 630 2 2452 4848 t
(DWORD \256nd\256rst)1 1072 1 1280 4968 t
10 S f
(_)2352 4968 w
10 R f
( Reserved \(must be zero\) */)5 1140(rsvd; /*)1 641 2 2402 4968 t
(BYTE \256ndn\256rst)1 1089 1 1313 5088 t
10 S f
(_)2402 5088 w
10 R f
(PathSpec[];)2452 5088 w
(BYTE smb)1 578 1 869 5208 t
10 S f
(_)1447 5208 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 5208 t
(BYTE smb)1 578 1 869 5328 t
10 S f
(_)1447 5328 w
10 R f
( Additional level dependent match data */)6 1718(data[*]; /*)1 621 2 1497 5328 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 45 45
%%Page: 46 46
save
mark
46 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 46 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 538 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( value = 0xffff no handle on request */)8 1600(\256d; /*)1 538 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 2460 t
10 S f
(_)3209 2460 w
10 R f
(dscnt\) */)1 355 1 3259 2460 t
(First Response Format :)3 983 1 720 2760 t
(BYTE smb)1 578 1 830 2940 t
10 S f
(_)1408 2940 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 2940 t
(WORD smb)1 622 1 786 3060 t
10 S f
(_)1408 3060 w
10 R f
( value = 6 */)4 532(tprcnt; /*)1 621 2 1458 3060 t
(WORD smb)1 622 1 786 3180 t
10 S f
(_)1408 3180 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 3180 t
(WORD smb)1 622 1 786 3300 t
10 S f
(_)1408 3300 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 3300 t
(WORD smb)1 622 1 786 3420 t
10 S f
(_)1408 3420 w
10 R f
( parameter bytes returned in this buffer */)7 1716(prcnt; /*)1 621 2 1458 3420 t
(WORD smb)1 622 1 786 3540 t
10 S f
(_)1408 3540 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 3540 t
(WORD smb)1 622 1 786 3660 t
10 S f
(_)1408 3660 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 3660 t
(WORD smb)1 622 1 786 3780 t
10 S f
(_)1408 3780 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 3780 t
(WORD smb)1 622 1 786 3900 t
10 S f
(_)1408 3900 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 3900 t
(WORD smb)1 622 1 786 4020 t
10 S f
(_)1408 4020 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 4020 t
(BYTE smb)1 578 1 830 4140 t
10 S f
(_)1408 4140 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 4140 t
(BYTE smb)1 578 1 830 4260 t
10 S f
(_)1408 4260 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 4260 t
(WORD smb)1 622 1 786 4380 t
10 S f
(_)1408 4380 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 4380 t
(BYTE smb)1 578 1 830 4500 t
10 S f
(_)1408 4500 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 4500 t
(BYTE smb)1 578 1 830 4620 t
10 S f
(_)1408 4620 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 4620 t
(* TRANSACT2)1 661 1 2034 4740 t
10 S f
(_)2695 4740 w
10 R f
(FINDNOTIFYFIRST function response is)3 1720 1 2745 4740 t
(* the \256nd \256rst speci\256c return)5 1192 1 2034 4860 t
(* information in the following format. */)6 1678 1 2034 4980 t
(WORD \256ndn\256rst)1 1089 1 1274 5100 t
10 S f
(_)2363 5100 w
10 R f
( Mointor handle */)3 771(handle; /*)1 603 2 2413 5100 t
(WORD \256ndn\256rst)1 1089 1 1274 5220 t
10 S f
(_)2363 5220 w
10 R f
( Number of changes which)4 1107(changecount; /*)1 676 2 2413 5220 t
(* occured within timeout */)4 1137 1 2859 5340 t
(WORD \256ndn\256rst)1 1089 1 1274 5460 t
10 S f
(_)2363 5460 w
10 R f
( error offset if EA error */)6 1083(offerror; /*)1 613 2 2413 5460 t
(BYTE smb)1 578 1 830 5580 t
10 S f
(_)1408 5580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 5580 t
(BYTE smb)1 578 1 830 5700 t
10 S f
(_)1408 5700 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 621 2 1458 5700 t
10 S f
(_)3563 5700 w
10 R f
(dscnt\) */)1 355 1 3613 5700 t
(/* The data block contains the level dependent)7 1911 1 2001 5820 t
(* information about the changes which occurred)6 1977 1 2034 5940 t
(*/)2034 6060 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 46 46
%%Page: 47 47
save
mark
47 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 47 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Subsequent Response Format :)3 1260 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 6 */)4 532(tprcnt; /*)1 539 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 539 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0 */)4 532(prcnt; /*)1 539 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0 */)4 532(proff; /*)1 539 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 */)4 532(prdisp; /*)1 539 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 539 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 539 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 539 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 539 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 539 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 539 2 1458 2700 t
10 S f
(_)3481 2700 w
10 R f
(dscnt\) */)1 355 1 3531 2700 t
(/* The data block contains the level dependent)7 1911 1 1919 2820 t
(* information about the changes which occurred)6 1977 1 1952 2940 t
(*/)1952 3060 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 47 47
%%Page: 48 48
save
mark
48 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 48 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.13. TRANSACT2)1 1091 1 720 840 t
10 S f
(_)1811 840 w
10 B f
(FINDNOTIFYNEXT)1861 840 w
10 R f
(The function code TRANSACT2)3 1398 1 720 1236 t
10 S f
(_)2118 1236 w
10 R f
(FINDNOTIFYNEXT in smb)2 1206 1 2168 1236 t
10 S f
(_)3374 1236 w
10 R f
( the primary TRANSACT2)3 1163(setup[0] in)1 453 2 3424 1236 t
( a \256le or directory speci\256ed by a)7 1555(request identi\256es a request to continue monitoring changes to)8 2765 2 720 1356 t
(TRANSACT)720 1476 w
10 S f
(_)1248 1476 w
10 R f
(FINDNOTIFYFIRST request.)1 1218 1 1298 1476 t
(Primary Request Format:)2 1027 1 720 1752 t
(BYTE smb)1 578 1 869 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1968 t
(WORD smb)1 622 1 825 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 4, total param bytes being sent */)9 1743(tpscnt; /*)1 621 2 1497 2088 t
(WORD smb)1 622 1 825 2208 t
10 S f
(_)1447 2208 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 2328 t
(WORD smb)1 622 1 825 2448 t
10 S f
(_)1447 2448 w
10 R f
( value = maximum return data length */)7 1641(mdrcnt; /*)1 621 2 1497 2448 t
(BYTE smb)1 578 1 869 2568 t
10 S f
(_)1447 2568 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2568 t
(BYTE smb)1 578 1 869 2688 t
10 S f
(_)1447 2688 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2808 t
(bit 0 - 0)3 338 1 2172 2928 t
(bit 1 - 0 */)4 449 1 2172 3048 t
(DWORD smb)1 694 1 753 3168 t
10 S f
(_)1447 3168 w
10 R f
( Duration of monitor period */)5 1253(timeout; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 3288 t
(WORD smb)1 622 1 825 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = tpscnt, parms must be in primary request */)10 2159(pscnt; /*)1 621 2 1497 3408 t
(WORD smb)1 622 1 825 3528 t
10 S f
(_)1447 3528 w
10 R f
( offset \(from start of SMB hdr to parameter bytes */)10 2149(psoff; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 4008 t
(WORD smb)1 622 1 825 4128 t
10 S f
(_)1447 4128 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 12)3 471(setup1; /*)1 621 4 1497 4128 t
10 S f
(_)3327 4128 w
10 R f
(FINDNOTIFYNEXT */)1 976 1 3377 4128 t
(WORD smb)1 622 1 825 4248 t
10 S f
(_)1447 4248 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 4248 t
(BYTE smb)1 578 1 869 4368 t
10 S f
(_)1447 4368 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 4368 t
(BYTE smb)1 578 1 869 4488 t
10 S f
(_)1447 4488 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4488 t
(* TRANSACT2)1 661 1 2073 4608 t
10 S f
(_)2734 4608 w
10 R f
(FINDNOTIFYNEXT function)1 1231 1 2784 4608 t
(* is the \256nd next speci\256c information)6 1542 1 2073 4728 t
(* in the following format. */)5 1173 1 2073 4848 t
(WORD \256ndnnext)1 1105 1 1313 4968 t
10 S f
(_)2418 4968 w
10 R f
( Directory monitor handle */)4 1175(DirHandle; /*)1 725 2 2468 4968 t
(WORD \256ndnnext)1 1105 1 1313 5088 t
10 S f
(_)2418 5088 w
10 R f
( Number of changes to wait for */)7 1406(ChangeCount; /*)1 788 2 2468 5088 t
(BYTE smb)1 578 1 869 5208 t
10 S f
(_)1447 5208 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 5208 t
(BYTE smb)1 578 1 869 5328 t
10 S f
(_)1447 5328 w
10 R f
( Additional level dependent monitor)4 1481(data[*]; /*)1 621 2 1497 5328 t
(* information.)1 580 1 2073 5448 t
(*/)2073 5568 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 48 48
%%Page: 49 49
save
mark
49 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 49 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 4 total parmeter bytes sent */)8 1568(tpscnt; /*)1 538 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( search handle */)3 697(\256d; /*)1 538 2 1458 2100 t
(WORD smb)1 622 1 786 2220 t
10 S f
(_)1408 2220 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 2340 t
(BYTE smb)1 578 1 830 2460 t
10 S f
(_)1408 2460 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 2460 t
10 S f
(_)3209 2460 w
10 R f
(dscnt\) */)1 355 1 3259 2460 t
(First Response Format :)3 983 1 720 2760 t
(BYTE smb)1 578 1 830 2940 t
10 S f
(_)1408 2940 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 2940 t
(WORD smb)1 622 1 786 3060 t
10 S f
(_)1408 3060 w
10 R f
( value = 4 */)4 532(tprcnt; /*)1 621 2 1458 3060 t
(WORD smb)1 622 1 786 3180 t
10 S f
(_)1408 3180 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 621 3 1458 3180 t
(WORD smb)1 622 1 786 3300 t
10 S f
(_)1408 3300 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 3300 t
(WORD smb)1 622 1 786 3420 t
10 S f
(_)1408 3420 w
10 R f
( parameter bytes returned in this buffer */)7 1716(prcnt; /*)1 621 2 1458 3420 t
(WORD smb)1 622 1 786 3540 t
10 S f
(_)1408 3540 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 3540 t
(WORD smb)1 622 1 786 3660 t
10 S f
(_)1408 3660 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 3660 t
(WORD smb)1 622 1 786 3780 t
10 S f
(_)1408 3780 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 621 2 1458 3780 t
(WORD smb)1 622 1 786 3900 t
10 S f
(_)1408 3900 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 621 2 1458 3900 t
(WORD smb)1 622 1 786 4020 t
10 S f
(_)1408 4020 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 621 2 1458 4020 t
(BYTE smb)1 578 1 830 4140 t
10 S f
(_)1408 4140 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 4140 t
(BYTE smb)1 578 1 830 4260 t
10 S f
(_)1408 4260 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 4260 t
(WORD smb)1 622 1 786 4380 t
10 S f
(_)1408 4380 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 4380 t
(BYTE smb)1 578 1 830 4500 t
10 S f
(_)1408 4500 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 4500 t
(BYTE smb)1 578 1 830 4620 t
10 S f
(_)1408 4620 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 4620 t
(* TRANSACT2)1 661 1 2034 4740 t
10 S f
(_)2695 4740 w
10 R f
(FINDNOTIFYNEXT function)1 1231 1 2745 4740 t
(* response is the \256nd notify next speci\256c return)8 1962 1 2034 4860 t
(* information in the following format. */)6 1678 1 2034 4980 t
(WORD \256ndnnext)1 1138 1 1241 5100 t
10 S f
(_)2379 5100 w
10 R f
( Number of changes which)4 1107(changecount; /*)1 676 2 2429 5100 t
(* during the monitor period. */)5 1273 1 2826 5220 t
(WORD \256ndnnext)1 1138 1 1241 5340 t
10 S f
(_)2379 5340 w
10 R f
(offerror;)2429 5340 w
(BYTE smb)1 578 1 830 5460 t
10 S f
(_)1408 5460 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1458 5460 t
(BYTE smb)1 578 1 830 5580 t
10 S f
(_)1408 5580 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 621 2 1458 5580 t
10 S f
(_)3563 5580 w
10 R f
(dscnt\) */)1 355 1 3613 5580 t
(/* The data block contains the level dependent)7 1911 1 2001 5700 t
(* information about the changes which occurred.)6 2002 1 2034 5820 t
(*/)2034 5940 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 49 49
%%Page: 50 50
save
mark
50 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 50 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Subsequent Response Format :)3 1260 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 539 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 4 */)4 532(tprcnt; /*)1 539 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = total length of return data buffer)8 1694(tdrcnt; /*)1 539 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 539 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 0 */)4 532(prcnt; /*)1 539 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( value = 0 */)4 532(proff; /*)1 539 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 */)4 532(prdisp; /*)1 539 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( data bytes returned in this buffer */)7 1484(drcnt; /*)1 539 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(droff; /*)1 539 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( byte displacement for these data bytes */)7 1706(drdisp; /*)1 539 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 539 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 539 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 539 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 539 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( return data bytes \(* = value of smb)8 1484(data[*]; /*)1 539 2 1458 2700 t
10 S f
(_)3481 2700 w
10 R f
(dscnt\) */)1 355 1 3531 2700 t
(/* The data block contains the level dependent)7 1911 1 1919 2820 t
(* information about the changes which occurred.)6 2002 1 1952 2940 t
(*/)1952 3060 w
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 50 50
%%Page: 51 51
save
mark
51 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 51 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
(6.0.1.1.14. TRANSACT2)1 1091 1 720 840 t
10 S f
(_)1811 840 w
10 B f
(MKDIR)1861 840 w
10 R f
(The function code TRANSACT2)3 1446 1 720 996 t
10 S f
(_)2166 996 w
10 R f
(MKDIR in smb)2 706 1 2216 996 t
10 S f
(_)2922 996 w
10 R f
(setup[0] in the primary TRANSACT2 requests)5 2068 1 2972 996 t
(identi\256es a request to create a directory with extended attributes.)9 2650 1 720 1116 t
(Primary Request Format:)2 1027 1 720 1272 t
(BYTE smb)1 578 1 869 1488 t
10 S f
(_)1447 1488 w
10 R f
( value = 15 */)4 582(wct; /*)1 621 2 1497 1488 t
(WORD smb)1 622 1 825 1608 t
10 S f
(_)1447 1608 w
10 R f
( value = total number of param bytes being sent */)10 2089(tpscnt; /*)1 621 2 1497 1608 t
(WORD smb)1 622 1 825 1728 t
10 S f
(_)1447 1728 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 621 2 1497 1728 t
(WORD smb)1 622 1 825 1848 t
10 S f
(_)1447 1848 w
10 R f
( value = maximum return parameter length */)7 1873(mprcnt; /*)1 621 2 1497 1848 t
(WORD smb)1 622 1 825 1968 t
10 S f
(_)1447 1968 w
10 R f
( value = 0. No data returned */)7 1276(mdrcnt; /*)1 621 2 1497 1968 t
(BYTE smb)1 578 1 869 2088 t
10 S f
(_)1447 2088 w
10 R f
( value = 0. No setup words to return */)9 1615(msrcnt; /*)1 621 2 1497 2088 t
(BYTE smb)1 578 1 869 2208 t
10 S f
(_)1447 2208 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd; /*)1 621 2 1497 2208 t
(WORD smb)1 622 1 825 2328 t
10 S f
(_)1447 2328 w
10 R f
( additional information:)2 966(\257ags; /*)1 621 2 1497 2328 t
( 0 - 0)3 232(* bit)1 288 2 2073 2448 t
( 1 - 0 */)4 343(* bit)1 288 2 2073 2568 t
(DWORD smb)1 694 1 753 2688 t
10 S f
(_)1447 2688 w
10 R f
( value = 0. Not used for mkdir */)8 1377(timeout; /*)1 621 2 1497 2688 t
(WORD smb)1 622 1 825 2808 t
10 S f
(_)1447 2808 w
10 R f
( reserved */)2 481(rsvd1; /*)1 621 2 1497 2808 t
(WORD smb)1 622 1 825 2928 t
10 S f
(_)1447 2928 w
10 R f
( value = tpscnt, parms must be in primary request */)10 2159(pscnt; /*)1 621 2 1497 2928 t
(WORD smb)1 622 1 825 3048 t
10 S f
(_)1447 3048 w
10 R f
( offset \(from start of SMB Hdr to parameter bytes */)10 2171(psoff; /*)1 621 2 1497 3048 t
(WORD smb)1 622 1 825 3168 t
10 S f
(_)1447 3168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 621 2 1497 3168 t
(WORD smb)1 622 1 825 3288 t
10 S f
(_)1447 3288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 621 2 1497 3288 t
(BYTE smb)1 578 1 869 3408 t
10 S f
(_)1447 3408 w
10 R f
( value = 1 */)4 532(suwcnt; /*)1 621 2 1497 3408 t
(BYTE smb)1 578 1 869 3528 t
10 S f
(_)1447 3528 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd2; /*)1 621 2 1497 3528 t
(WORD smb)1 622 1 825 3648 t
10 S f
(_)1447 3648 w
10 R f
( TRANSACT2)1 611( :-)1 127( value = 13)3 471(setup1; /*)1 621 4 1497 3648 t
10 S f
(_)3327 3648 w
10 R f
(MKDIR */)1 444 1 3377 3648 t
(WORD smb)1 622 1 825 3768 t
10 S f
(_)1447 3768 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1497 3768 t
(BYTE smb)1 578 1 869 3888 t
10 S f
(_)1447 3888 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1497 3888 t
(BYTE smb)1 578 1 869 4008 t
10 S f
(_)1447 4008 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1497 4008 t
(* TRANSACT2)1 661 1 2073 4128 t
10 S f
(_)2734 4128 w
10 R f
(MKDIR function is)2 799 1 2784 4128 t
(* the mkdir speci\256c information)4 1320 1 2073 4248 t
(* in the following format. */)5 1173 1 2073 4368 t
(DWORD mkdir)1 1065 1 1280 4488 t
10 S f
(_)2345 4488 w
10 R f
( Reserved. Must be zero. */)5 1135(rsvd; /*)1 509 2 2395 4488 t
(BYTE mkdir)1 1065 1 1280 4608 t
10 S f
(_)2345 4608 w
10 R f
( Directory name */)3 775(dirname[]; /*)1 565 2 2395 4608 t
(BYTE smb)1 578 1 869 4728 t
10 S f
(_)1447 4728 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad1[]; /*)1 621 2 1497 4728 t
(BYTE smb)1 578 1 869 4848 t
10 S f
(_)1447 4848 w
10 R f
( FEAList structure for the directory)5 1457(data[*]; /*)1 621 2 1497 4848 t
(* to be created */)4 719 1 2073 4968 t
(Secondary Request Format \(more data - may be zero or more of these\):)12 2939 1 720 5268 t
(BYTE smb)1 578 1 830 5448 t
10 S f
(_)1408 5448 w
10 R f
( value = 9 */)4 532(wct; /*)1 538 2 1458 5448 t
(WORD smb)1 622 1 786 5568 t
10 S f
(_)1408 5568 w
10 R f
( totalnumber of parameter bytes being sent */)7 1867(tpscnt; /*)1 538 2 1458 5568 t
(WORD smb)1 622 1 786 5688 t
10 S f
(_)1408 5688 w
10 R f
( total number of data bytes being sent */)8 1668(tdscnt; /*)1 538 2 1458 5688 t
(WORD smb)1 622 1 786 5808 t
10 S f
(_)1408 5808 w
10 R f
( value = 0. All params in primary request */)9 1820(pscnt; /*)1 538 2 1458 5808 t
(WORD smb)1 622 1 786 5928 t
10 S f
(_)1408 5928 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psoff; /*)1 538 2 1458 5928 t
(WORD smb)1 622 1 786 6048 t
10 S f
(_)1408 6048 w
10 R f
( value = 0. No parameters in secondary request. */)9 2076(psdisp; /*)1 538 2 1458 6048 t
(WORD smb)1 622 1 786 6168 t
10 S f
(_)1408 6168 w
10 R f
( number of data bytes being sent this buffer */)9 1911(dscnt; /*)1 538 2 1458 6168 t
(WORD smb)1 622 1 786 6288 t
10 S f
(_)1408 6288 w
10 R f
( offset \(from start of SMB hdr\) to data bytes */)10 1950(dsoff; /*)1 538 2 1458 6288 t
(WORD smb)1 622 1 786 6408 t
10 S f
(_)1408 6408 w
10 R f
( byte displacement for these data bytes */)7 1706(dsdisp; /*)1 538 2 1458 6408 t
(WORD smb)1 622 1 786 6528 t
10 S f
(_)1408 6528 w
10 R f
( value = 0xffff, no handle on request */)8 1625(\256d; /*)1 538 2 1458 6528 t
(WORD smb)1 622 1 786 6648 t
10 S f
(_)1408 6648 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 538 2 1458 6648 t
(BYTE smb)1 578 1 830 6768 t
10 S f
(_)1408 6768 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 538 2 1458 6768 t
(BYTE smb)1 578 1 830 6888 t
10 S f
(_)1408 6888 w
10 R f
( data bytes \(* = value of smb)7 1213(data[*]; /*)1 538 2 1458 6888 t
10 S f
(_)3209 6888 w
10 R f
(dscnt\) */)1 355 1 3259 6888 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 51 51
%%Page: 52 52
save
mark
52 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 52 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(Response Format \(one only\):)3 1187 1 720 840 t
(BYTE smb)1 578 1 830 1020 t
10 S f
(_)1408 1020 w
10 R f
( value = 10 */)4 582(wct; /*)1 621 2 1458 1020 t
(WORD smb)1 622 1 786 1140 t
10 S f
(_)1408 1140 w
10 R f
( value = 2 */)4 532(tprcnt; /*)1 621 2 1458 1140 t
(WORD smb)1 622 1 786 1260 t
10 S f
(_)1408 1260 w
10 R f
( */)1 144( value = 0 no data bytes)6 997(tdrcnt; /*)1 621 3 1458 1260 t
(WORD smb)1 622 1 786 1380 t
10 S f
(_)1408 1380 w
10 R f
( reserved */)2 481(rsvd; /*)1 621 2 1458 1380 t
(WORD smb)1 622 1 786 1500 t
10 S f
(_)1408 1500 w
10 R f
( value = 2, parameter bytes being returned */)8 1852(prcnt; /*)1 621 2 1458 1500 t
(WORD smb)1 622 1 786 1620 t
10 S f
(_)1408 1620 w
10 R f
( offset \(from start of SMB hdr\) to param bytes */)10 2033(proff; /*)1 621 2 1458 1620 t
(WORD smb)1 622 1 786 1740 t
10 S f
(_)1408 1740 w
10 R f
( value = 0 byte displacement for param bytes */)9 1972(prdisp; /*)1 621 2 1458 1740 t
(WORD smb)1 622 1 786 1860 t
10 S f
(_)1408 1860 w
10 R f
( value = 0 no data bytes */)7 1108(drcnt; /*)1 621 2 1458 1860 t
(WORD smb)1 622 1 786 1980 t
10 S f
(_)1408 1980 w
10 R f
( value = 0 no data bytes */)7 1108(droff; /*)1 621 2 1458 1980 t
(WORD smb)1 622 1 786 2100 t
10 S f
(_)1408 2100 w
10 R f
( value = 0 no data bytes */)7 1108(drdisp; /*)1 621 2 1458 2100 t
(BYTE smb)1 578 1 830 2220 t
10 S f
(_)1408 2220 w
10 R f
( value = 0 no set up return words */)9 1490(suwcnt; /*)1 621 2 1458 2220 t
(BYTE smb)1 578 1 830 2340 t
10 S f
(_)1408 2340 w
10 R f
( reserved \(pad above to word\) */)6 1344(rsvd1; /*)1 621 2 1458 2340 t
(WORD smb)1 622 1 786 2460 t
10 S f
(_)1408 2460 w
10 R f
( total bytes \(including pad bytes\) following */)7 1886(bcc; /*)1 621 2 1458 2460 t
(BYTE smb)1 578 1 830 2580 t
10 S f
(_)1408 2580 w
10 R f
( \(optional\) to pad to word or dword boundary */)9 1989(pad[]; /*)1 621 2 1458 2580 t
(BYTE smb)1 578 1 830 2700 t
10 S f
(_)1408 2700 w
10 R f
( The parmater block for the)5 1134(param[*]; /*)1 621 2 1458 2700 t
(* TRANSACT2)1 661 1 2034 2820 t
10 S f
(_)2695 2820 w
10 R f
(MKDIR function response)2 1081 1 2745 2820 t
(* is the mkdir speci\256c return)5 1186 1 2034 2940 t
(* information in the following format. */)6 1678 1 2034 3060 t
(WORD mkdir)1 1065 1 1241 3180 t
10 S f
(_)2306 3180 w
10 R f
( offset into FEAList data of \256rst)6 1331(offerror; /*)1 580 2 2356 3180 t
(* error which occured while setting)5 1456 1 2760 3300 t
(* the extended attributes. */)4 1139 1 2760 3420 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 52 52
%%Page: 53 53
save
mark
53 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 53 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( NOTIFY CLOSE)2 795(6.0.2. FIND)1 535 2 720 840 t
10 R f
(Request Format:)1 672 1 720 996 t
(BYTE smb)1 578 1 830 1176 t
10 S f
(_)1408 1176 w
10 R f
( value = 1 */)4 532(wct; /*)1 522 2 1458 1176 t
(WORD smb)1 622 1 786 1296 t
10 S f
(_)1408 1296 w
10 R f
( Find notify handle */)4 899(handle; /*)1 522 2 1458 1296 t
(WORD smb)1 622 1 786 1416 t
10 S f
(_)1408 1416 w
10 R f
( value = 0 */)4 532(bcc; /*)1 522 2 1458 1416 t
(Response Format:)1 733 1 720 1872 t
(BYTE smb)1 578 1 830 2052 t
10 S f
(_)1408 2052 w
10 R f
( value = 0 */)4 532(wct; /*)1 400 2 1458 2052 t
(WORD smb)1 622 1 786 2172 t
10 S f
(_)1408 2172 w
10 R f
( value = 0 */)4 532(bcc; /*)1 400 2 1458 2172 t
(Service:)720 2628 w
( association between a directory handle returned following a)8 2547(The Find Notify Close protocol closes the)6 1773 2 720 2784 t
(resourse monitor established using a TRANSACT2)5 2147 1 720 2904 t
10 S f
(_)2867 2904 w
10 R f
( the server and the)4 799(FINDNOTIFYFIRST request to)2 1324 2 2917 2904 t
( request allows the server to free any resources held in support)11 2656(resulting system directory monitor. This)4 1664 2 720 3024 t
(of the open handle.)3 789 1 720 3144 t
(The Find Close protocol is used to match the DosFindNotifyClose OS/2 system call.)12 3477 1 720 3384 t
(Find Notify Close may generate the following errors.)7 2181 1 720 3780 t
(Error Class ERRDOS)2 888 1 1080 3960 t
(ERRbad\256d)1146 4200 w
10 S1 f
(<)1146 4320 w
10 R f
(implementation speci\256c)1 966 1 1202 4320 t
10 S1 f
(>)2168 4320 w
10 R f
(Error Class ERRSRV)2 883 1 1080 4560 t
(ERRerror)1146 4800 w
(ERRinvnid)1146 4920 w
10 S1 f
(<)1146 5040 w
10 R f
(implementation speci\256c)1 966 1 1202 5040 t
10 S1 f
(>)2168 5040 w
10 R f
(Error Class ERRHRD)2 899 1 1080 5280 t
10 S1 f
(<)1146 5520 w
10 R f
(implementation speci\256c)1 966 1 1202 5520 t
10 S1 f
(>)2168 5520 w
10 R f
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 53 53
%%Page: 54 54
save
mark
54 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 54 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( CLOSE)1 373(6.0.3. FIND)1 535 2 720 840 t
10 R f
(Request Format:)1 672 1 720 996 t
(BYTE smb)1 578 1 830 1176 t
10 S f
(_)1408 1176 w
10 R f
( value = 1 */)4 532(wct; /*)1 1260 2 1458 1176 t
(WORD smb)1 622 1 786 1296 t
10 S f
(_)1408 1296 w
10 R f
(handle; /* Find handle */)4 1032 1 1458 1296 t
(WORD smb)1 622 1 786 1416 t
10 S f
(_)1408 1416 w
10 R f
( value = 0 */)4 532(bcc; /*)1 1260 2 1458 1416 t
(Response Format:)1 733 1 720 1872 t
(BYTE smb)1 578 1 830 2052 t
10 S f
(_)1408 2052 w
10 R f
( value = 0 */)4 532(wct; /*)1 400 2 1458 2052 t
(WORD smb)1 622 1 786 2172 t
10 S f
(_)1408 2172 w
10 R f
( value = 0 */)4 532(bcc; /*)1 400 2 1458 2172 t
(Service:)720 2628 w
( a search handle returned following a successful)7 2012(The Find Close protocol closes the association between)7 2308 2 720 2784 t
( server using the TRANSACT2 protocol and the resulting system \256le)10 2945(FIND FIRST request sent to the)5 1375 2 720 2904 t
(search. This request allows the server to free any resources held in support of the open handle.)16 3891 1 720 3024 t
(The Find Close protocol is used to match the DosFindFirst2 OS/2 system call.)12 3222 1 720 3264 t
(Find Close may generate the following errors.)6 1887 1 720 3660 t
(Error Class ERRDOS)2 888 1 1080 3840 t
(ERRbad\256d)1146 4080 w
10 S1 f
(<)1146 4200 w
10 R f
(implementation speci\256c)1 966 1 1202 4200 t
10 S1 f
(>)2168 4200 w
10 R f
(Error Class ERRSRV)2 883 1 1080 4440 t
(ERRerror)1146 4680 w
(ERRinvnid)1146 4800 w
10 S1 f
(<)1146 4920 w
10 R f
(implementation speci\256c)1 966 1 1202 4920 t
10 S1 f
(>)2168 4920 w
10 R f
(Error Class ERRHRD)2 899 1 1080 5160 t
10 S1 f
(<)1146 5400 w
10 R f
(implementation speci\256c)1 966 1 1202 5400 t
10 S1 f
(>)2168 5400 w
10 R f
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 54 54
%%Page: 55 55
save
mark
55 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 55 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( LOGOFF and X)3 756(6.0.4. USER)1 558 2 720 840 t
10 R f
(Request Format:)1 672 1 720 996 t
(BYTE smb)1 578 1 830 1176 t
10 S f
(_)1408 1176 w
10 R f
( value = 2 */)4 532(wct; /*)1 511 2 1458 1176 t
(BYTE smb)1 578 1 830 1296 t
10 S f
(_)1408 1296 w
10 R f
( secondary \(X\) command, 0xFF = none */)7 1732(com2; /*)1 511 2 1458 1296 t
(BYTE smb)1 578 1 830 1416 t
10 S f
(_)1408 1416 w
10 R f
( reserved \(must be zero\) */)5 1106(reh2; /*)1 511 2 1458 1416 t
(WORD smb)1 622 1 786 1536 t
10 S f
(_)1408 1536 w
10 R f
( offset \(from SMB hdr start\) to next cmd \()9 1756(off2; /*)1 511 2 1458 1536 t
10 S1 f
(@)3725 1536 w
10 R f
(smb)3817 1536 w
10 S f
(_)3984 1536 w
10 R f
(wct\) */)1 288 1 4034 1536 t
(WORD smb)1 622 1 786 1656 t
10 S f
(_)1408 1656 w
10 R f
( value = 0 */)4 532(bcc; /*)1 511 2 1458 1656 t
(Response Format:)1 733 1 720 1992 t
(BYTE smb)1 578 1 830 2172 t
10 S f
(_)1408 2172 w
10 R f
( value = 2 */)4 532(wct; /*)1 478 2 1458 2172 t
(BYTE smb)1 578 1 830 2292 t
10 S f
(_)1408 2292 w
10 R f
( secondary \(X\) command, 0xFF = none */)7 1732(com2; /*)1 478 2 1458 2292 t
(BYTE smb)1 578 1 830 2412 t
10 S f
(_)1408 2412 w
10 R f
( reserved \(pad to word\) */)5 1073(res2; /*)1 478 2 1458 2412 t
(WORD smb)1 622 1 786 2532 t
10 S f
(_)1408 2532 w
10 R f
( offset \(from SMB hdr start\) to next cmd \()9 1756(off2; /*)1 478 2 1458 2532 t
10 S1 f
(@)3692 2532 w
10 R f
(smb)3784 2532 w
10 S f
(_)3951 2532 w
10 R f
(wct\) */)1 288 1 4001 2532 t
(WORD smb)1 622 1 786 2652 t
10 S f
(_)1408 2652 w
10 R f
( value = 0 */)4 532(bcc; /*)1 478 2 1458 2652 t
(Service de\256nition:)1 744 1 720 2988 t
(This protocol is used to)4 1055 1 720 3228 t
10 S1 f
(")1829 3228 w
10 R f
(Log Off)1 354 1 1870 3228 t
10 S1 f
(")2224 3228 w
10 R f
( \(identi\256ed by the UID value in smb)7 1656(the user)1 376 2 2320 3228 t
10 S f
(_)4352 3228 w
10 R f
(uid\) previously)1 638 1 4402 3228 t
10 S1 f
(")720 3348 w
10 R f
(Logged On)1 460 1 761 3348 t
10 S1 f
(")1221 3348 w
10 R f
(via the Session Set Up protocol.)5 1323 1 1295 3348 t
( subsequent protocol)2 857( Any)1 245( this UID from its list of valid UIDs for this session.)11 2248(The server will remove)3 970 4 720 3588 t
(containing this UID \(in smb)4 1154 1 720 3708 t
10 S f
(_)1874 3708 w
10 R f
(uid\) received \(on this session\) will be returned with an access error.)11 2787 1 1924 3708 t
(Another Session Set Up \()4 1048 1 720 3948 t
10 S1 f
(")1768 3948 w
10 R f
(User Logon)1 482 1 1809 3948 t
10 S1 f
(")2291 3948 w
10 R f
(\) must be sent in order to reenstate the user on the session.)12 2423 1 2332 3948 t
( the UIDs registered on the session to be invalidated. When the session)12 2988(Session Termination also causes)3 1332 2 720 4188 t
(is reestablished, Session Setup request\(s\) must again be used to validate each user.)12 3391 1 720 4308 t
(The following are the only valid protocol request commands for smb)10 2832 1 720 4548 t
10 S f
(_)3552 4548 w
10 R f
(com2 \(X\) for User Logoff and X:)6 1383 1 3602 4548 t
(SESSION SET UP and X)4 1060 1 1146 4848 t
(User Logoff may generate the following errors.)6 1940 1 720 5148 t
(Error Class ERRDOS)2 888 1 1146 5448 t
10 S1 f
(<)1146 5688 w
10 R f
(implementation speci\256c)1 966 1 1202 5688 t
10 S1 f
(>)2168 5688 w
10 R f
(Error Class ERRSRV)2 883 1 1146 5928 t
10 S1 f
(<)1146 6168 w
10 R f
(implementation speci\256c)1 966 1 1202 6168 t
10 S1 f
(>)2168 6168 w
10 R f
(Error Class ERRHRD)2 899 1 1146 6408 t
10 S1 f
(<)1146 6648 w
10 R f
(implementation speci\256c)1 966 1 1202 6648 t
10 S1 f
(>)2168 6648 w
10 R f
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 55 55
%%Page: 56 56
save
mark
56 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 56 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( DEFINITIONS)1 695(7. DATA)1 424 2 720 840 t
( CODES)1 378(7.1. COMMAND)1 770 2 720 1080 t
10 R f
(The command codes are unchanged for commands that are common with the Core File Sharing Protocol.)15 4319 1 720 1236 t
(The following values have been assigned for the)7 1988 1 720 1476 t
10 S1 f
(")2741 1476 w
10 R f
(core)2782 1476 w
10 S1 f
(")2953 1476 w
10 R f
(protocol commands.)1 824 1 3027 1476 t
10 S1 f
(#)720 1656 w
10 R f
( create directory */)3 774( /*)1 250( 0x00)1 487(de\256ne SMBmkdir)1 728 4 770 1656 t
10 S1 f
(#)720 1776 w
10 R f
( delete directory */)3 775( /*)1 250( 0x01)1 504(de\256ne SMBrmdir)1 711 4 770 1776 t
10 S1 f
(#)720 1896 w
10 R f
( open \256le */)3 499( /*)1 250( 0x02)1 532(de\256ne SMBopen)1 683 4 770 1896 t
10 S1 f
(#)720 2016 w
10 R f
( create \256le */)3 542( /*)1 250( 0x03)1 489(de\256ne SMBcreate)1 726 4 770 2016 t
10 S1 f
(#)720 2136 w
10 R f
( close \256le */)3 510( /*)1 250( 0x04)1 521(de\256ne SMBclose)1 694 4 770 2136 t
10 S1 f
(#)720 2256 w
10 R f
( \257ush \256le */)3 500( /*)1 250( 0x05)1 531(de\256ne SMB\257ush)1 684 4 770 2256 t
10 S1 f
(#)720 2376 w
10 R f
( delete \256le */)3 543( /*)1 250( 0x06)1 470(de\256ne SMBunlink)1 745 4 770 2376 t
10 S1 f
(#)720 2496 w
10 R f
( rename \256le */)3 598( /*)1 250( 0x07)1 598(de\256ne SMBmv)1 617 4 770 2496 t
10 S1 f
(#)720 2616 w
10 R f
( get \256le attributes */)4 832( /*)1 250( 0x08)1 499(de\256ne SMBgetatr)1 716 4 770 2616 t
10 S1 f
(#)720 2736 w
10 R f
( set \256le attributes */)4 821( /*)1 250( 0x09)1 510(de\256ne SMBsetatr)1 705 4 770 2736 t
10 S1 f
(#)720 2856 w
10 R f
( read from \256le */)4 703( /*)1 228( 0x0A)1 577(de\256ne SMBread)1 660 4 770 2856 t
10 S1 f
(#)720 2976 w
10 R f
( write to \256le */)4 621( /*)1 233( 0x0B)1 538(de\256ne SMBwrite)1 694 4 770 2976 t
10 S1 f
(#)720 3096 w
10 R f
( lock byte range */)4 775( /*)1 233( 0x0C)1 571(de\256ne SMBlock)1 661 4 770 3096 t
10 S1 f
(#)720 3216 w
10 R f
( unlock byte range */)4 875( /*)1 228( 0x0D)1 476(de\256ne SMBunlock)1 761 4 770 3216 t
10 S1 f
(#)720 3336 w
10 R f
( create temporary \256le */)4 985( /*)1 239( 0x0E)1 493(de\256ne SMBctemp)1 733 4 770 3336 t
10 S1 f
(#)720 3456 w
10 R f
( make new \256le */)4 720( /*)1 244( 0x0F)1 438(de\256ne SMBmknew)1 783 4 770 3456 t
10 S1 f
(#)720 3576 w
10 R f
( check directory path */)4 974( /*)1 250( 0x10)1 454(de\256ne SMBchkpth)1 761 4 770 3576 t
10 S1 f
(#)720 3696 w
10 R f
( process exit */)3 626( /*)1 250( 0x11)1 576(de\256ne SMBexit)1 639 4 770 3696 t
10 S1 f
(#)720 3816 w
10 R f
( seek */)2 321( /*)1 250( 0x12)1 521(de\256ne SMBlseek)1 694 4 770 3816 t
10 S1 f
(#)720 3936 w
10 R f
( tree connect */)3 636( /*)1 250( 0x70)1 554(de\256ne SMBtcon)1 661 4 770 3936 t
10 S1 f
(#)720 4056 w
10 R f
( tree disconnect */)3 753( /*)1 250( 0x71)1 581(de\256ne SMBtdis)1 634 4 770 4056 t
10 S1 f
(#)720 4176 w
10 R f
( negotiate protocol */)3 876( /*)1 250( 0x72)1 421(de\256ne SMBnegprot)1 794 4 770 4176 t
10 S1 f
(#)720 4296 w
10 R f
( get disk attributes */)4 871( /*)1 250( 0x80)1 454(de\256ne SMBdskattr)1 761 4 770 4296 t
10 S1 f
(#)720 4416 w
10 R f
( search directory */)3 791( /*)1 250( 0x81)1 472(de\256ne SMBsearch)1 743 4 770 4416 t
10 S1 f
(#)720 4536 w
10 R f
( open print spool \256le */)5 971( /*)1 233( 0xC0)1 432(de\256ne SMBsplopen)1 800 4 770 4536 t
10 S1 f
(#)720 4656 w
10 R f
( write to print spool \256le */)6 1093( /*)1 233( 0xC1)1 521(de\256ne SMBsplwr)1 711 4 770 4656 t
10 S1 f
(#)720 4776 w
10 R f
( close print spool \256le */)5 982( /*)1 233( 0xC2)1 421(de\256ne SMBsplclose)1 811 4 770 4776 t
10 S1 f
(#)720 4896 w
10 R f
( return print queue */)4 875( /*)1 233( 0xC3)1 471(de\256ne SMBsplretq)1 761 4 770 4896 t
10 S1 f
(#)720 5016 w
10 R f
( send single block message */)5 1225( /*)1 228( 0xD0)1 526(de\256ne SMBsends)1 711 4 770 5016 t
10 S1 f
(#)720 5136 w
10 R f
( send broadcast message */)4 1113( /*)1 228( 0xD1)1 515(de\256ne SMBsendb)1 722 4 770 5136 t
10 S1 f
(#)720 5256 w
10 R f
( forward user name */)4 907( /*)1 228( 0xD2)1 377(de\256ne SMBfwdname)1 860 4 770 5256 t
10 S1 f
(#)720 5376 w
10 R f
( cancel forward */)3 746( /*)1 228( 0xD3)1 461(de\256ne SMBcancelf)1 776 4 770 5376 t
10 S1 f
(#)720 5496 w
10 R f
( get machine name */)4 886( /*)1 228( 0xD4)1 460(de\256ne SMBgetmac)1 777 4 770 5496 t
10 S1 f
(#)720 5616 w
10 R f
( send start of multi-block message */)6 1519( /*)1 228( 0xD5)1 437(de\256ne SMBsendstrt)1 800 4 770 5616 t
10 S1 f
(#)720 5736 w
10 R f
( send end of multi-block message */)6 1491( /*)1 228( 0xD6)1 421(de\256ne SMBsendend)1 816 4 770 5736 t
10 S1 f
(#)720 5856 w
10 R f
( send text of multi-block message */)6 1497( /*)1 228( 0xD7)1 459(de\256ne SMBsendtxt)1 778 4 770 5856 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 56 56
%%Page: 57 57
save
mark
57 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 57 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
( Sharing Protocol have the following com-)6 1824(The commands added by the LANMAN 1.0 Extended File)8 2496 2 720 840 t
(mand codes:)1 510 1 720 960 t
10 S1 f
(#)720 1140 w
10 R f
( lock then read data */)5 924( /*)1 250( 0x13)1 489(de\256ne SMBlockread)1 832 4 770 1140 t
10 S1 f
(#)720 1260 w
10 R f
( write then unlock data */)5 1058( /*)1 250( 0x14)1 355(de\256ne SMBwriteunlock)1 966 4 770 1260 t
10 S1 f
(#)720 1380 w
10 R f
( read block raw */)4 752( /*)1 228( 0x1A)1 467(de\256ne SMBreadBraw)1 876 4 770 1380 t
10 S1 f
(#)720 1500 w
10 R f
( read block multiplexed */)4 1081( /*)1 233( 0x1B)1 433(de\256ne SMBreadBmpx)1 905 4 770 1500 t
10 S1 f
(#)720 1620 w
10 R f
( read block \(secondary response\) */)5 1455( /*)1 233( 0x1C)1 572(de\256ne SMBreadBs)1 766 4 770 1620 t
10 S1 f
(#)720 1740 w
10 R f
( write block raw */)4 786( /*)1 228( 0x1D)1 433(de\256ne SMBwriteBraw)1 910 4 770 1740 t
10 S1 f
(#)720 1860 w
10 R f
( write block multiplexed */)4 1115( /*)1 239( 0x1E)1 393(de\256ne SMBwriteBmpx)1 939 4 770 1860 t
10 S1 f
(#)720 1980 w
10 R f
( write block \(secondary request\) */)5 1428( /*)1 244( 0x1F)1 527(de\256ne SMBwriteBs)1 800 4 770 1980 t
10 S1 f
(#)720 2100 w
10 R f
( write complete response */)4 1130( /*)1 250( 0x20)1 560(de\256ne SMBwriteC)1 761 4 770 2100 t
10 S1 f
(#)720 2220 w
10 R f
( set \256le attributes expanded */)5 1236( /*)1 250( 0x22)1 527(de\256ne SMBsetattrE)1 794 4 770 2220 t
10 S1 f
(#)720 2340 w
10 R f
( get \256le attributes expanded */)5 1247( /*)1 250( 0x23)1 516(de\256ne SMBgetattrE)1 805 4 770 2340 t
10 S1 f
(#)720 2460 w
10 R f
( lock/unlock byte ranges and X */)6 1396( /*)1 250( 0x24)1 460(de\256ne SMBlockingX)1 861 4 770 2460 t
10 S1 f
(#)720 2580 w
10 R f
( transaction - name, bytes in/out */)6 1433( /*)1 250( 0x25)1 638(de\256ne SMBtrans)1 683 4 770 2580 t
10 S1 f
(#)720 2700 w
10 R f
( transaction \(secondary request/response\) */)4 1783( /*)1 250( 0x26)1 599(de\256ne SMBtranss)1 722 4 770 2700 t
10 S1 f
(#)720 2820 w
10 R f
( IOCTL */)2 438( /*)1 250( 0x27)1 654(de\256ne SMBioctl)1 667 4 770 2820 t
10 S1 f
(#)720 2940 w
10 R f
( request/response\) */)2 842( \(secondary)1 503( IOCTL)1 327( /*)1 250( 0x28)1 615(de\256ne SMBioctls)1 706 6 770 2940 t
10 S1 f
(#)720 3060 w
10 R f
( copy */)2 338( /*)1 250( 0x29)1 638(de\256ne SMBcopy)1 683 4 770 3060 t
10 S1 f
(#)720 3180 w
10 R f
( move */)2 366( /*)1 228( 0x2A)1 632(de\256ne SMBmove)1 711 4 770 3180 t
10 S1 f
(#)720 3300 w
10 R f
( echo */)2 332( /*)1 233( 0x2B)1 661(de\256ne SMBecho)1 677 4 770 3300 t
10 S1 f
(#)720 3420 w
10 R f
( Write and Close */)4 809( /*)1 233( 0x2C)1 439(de\256ne SMBwriteclose)1 899 4 770 3420 t
10 S1 f
(#)720 3540 w
10 R f
( open and X */)4 620( /*)1 228( 0x2D)1 588(de\256ne SMBopenX)1 755 4 770 3540 t
10 S1 f
(#)720 3660 w
10 R f
( read and X */)4 597( /*)1 239( 0x2E)1 600(de\256ne SMBreadX)1 732 4 770 3660 t
10 S1 f
(#)720 3780 w
10 R f
( write and X */)4 631( /*)1 244( 0x2F)1 561(de\256ne SMBwriteX)1 766 4 770 3780 t
10 S1 f
(#)720 3900 w
10 R f
( Session Set Up & X \(including User Logon\) */)9 1974( /*)1 250( 0x73)1 460(de\256ne SMBsesssetup)1 861 4 770 3900 t
10 S1 f
(#)720 4020 w
10 R f
( tree connect and X */)5 918( /*)1 250( 0x75)1 588(de\256ne SMBtconX)1 733 4 770 4020 t
10 S1 f
(#)720 4140 w
10 R f
( \256nd \256rst */)3 489( /*)1 250( 0x82)1 643(de\256ne SMBf\256rst)1 678 4 770 4140 t
10 S1 f
(#)720 4260 w
10 R f
( \256nd unique */)3 605( /*)1 250( 0x83)1 527(de\256ne SMBfunique)1 794 4 770 4260 t
10 S1 f
(#)720 4380 w
10 R f
( \256nd close */)3 538( /*)1 250( 0x84)1 594(de\256ne SMBfclose)1 727 4 770 4380 t
10 S1 f
(#)720 4500 w
10 R f
( invalid command */)3 849( /*)1 233( 0xFE)1 571(de\256ne SMBinvalid)1 767 4 770 4500 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 57 57
%%Page: 58 58
save
mark
58 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 58 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
( Sharing Protocol have the following com-)6 1824(The commands added by the LANMAN 2.0 Extended File)8 2496 2 720 840 t
(mand codes:)1 510 1 720 960 t
10 S1 f
(#)720 1140 w
10 R f
( transaction2 - function, byte in/out */)6 1561( /*)1 228( 0x32)1 527(de\256ne SMBtrans2)1 733 4 770 1140 t
10 S1 f
(#)720 1260 w
10 R f
( transaction2 \(secondary request/response*/)3 1767( /*)1 228( 0x33)1 488(de\256ne SMBtranss2)1 772 4 770 1260 t
10 S1 f
(#)720 1380 w
10 R f
( \256nd close */)3 538( /*)1 228( 0x34)1 410(de\256ne SMB\256ndclose)1 850 4 770 1380 t
10 S1 f
(#)720 1500 w
10 R f
( \256nd notify close */)4 810( /*)1 228( 0x35)1 360(de\256ne SMB\256ndnclose)1 900 4 770 1500 t
10 S1 f
(#)720 1620 w
10 R f
( User logoff and X */)5 891( /*)1 228( 0x74)1 355(de\256ne SMBuloggoffX)1 905 4 770 1620 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 58 58
%%Page: 59 59
save
mark
59 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 59 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
10 B f
( CLASSES AND CODES)3 1106(7.2. ERROR)1 577 2 720 840 t
10 R f
( classes and codes generated by the Core File)8 1967(The error class and code lists in the section include all)10 2353 2 720 996 t
( These)1 304( of error conditions.)3 817(Sharing Protocol. Errors listed here are intended to provide a \256ner granularity)11 3199 3 720 1116 t
(lists are not complete.)3 901 1 720 1236 t
(The following error classes may be returned by the protocol elements de\256ned in this document.)14 3920 1 720 1476 t
( request was successful.)3 977( The)1 305(SUCCESS 0)1 835 3 720 1656 t
( is from the core DOS operating system set.)8 1809( Error)1 360(ERRDOS 0x01)1 835 3 720 1776 t
( is generated by the server network \256le manager.)8 2006( Error)1 360(ERRSRV 0x02)1 835 3 720 1896 t
( is an hardware error.)4 881( Error)1 360(ERRHRD 0x03)1 835 3 720 2016 t
( for XENIX.)2 517( Reserved)1 521(ERRXOS 0x04)1 835 3 720 2136 t
( for iRMX)2 438( Reserved)1 521(ERRRMX1 0xE1)1 835 3 720 2256 t
( for iRMX)2 438( Reserved)1 521(ERRRMX2 0xE2)1 835 3 720 2376 t
( for iRMX)2 438( Reserved)1 521(ERRRMX3 0xE3)1 835 3 720 2496 t
( was not in the)4 615( Command)1 567(ERRCMD 0xFF)1 835 3 720 2616 t
10 S1 f
(")2770 2616 w
10 R f
(SMB)2811 2616 w
10 S1 f
(")3023 2616 w
10 R f
(format.)3097 2616 w
(The following error codes may be generated with the SUCCESS error class.)11 3127 1 720 2832 t
( request was successful.)3 977(SUCCESS 0 The)2 940 2 720 3012 t
( XENIX errors)2 666( The)1 250( codes may be generated with the ERRDOS error class.)9 2545(The following error)2 859 4 720 3228 t
( - When the)3 540( NOTE)1 348( of these errors are noted at the end of the error description.)12 2656(equivalent to each)2 776 4 720 3348 t
( \(LANMAN 1.0\) has been negotiated, all of the error codes below may be generated)14 3587(extended protocol)1 733 2 720 3468 t
( OS/2 operating system documentation for com-)6 2022(plus any of the new error codes de\256ned for OS/2 \(see)10 2298 2 720 3588 t
( only)1 222( When)1 315(plete list of OS/2 error codes\).)5 1304 3 720 3708 t
10 S1 f
(")2605 3708 w
10 R f
(core)2646 3708 w
10 S1 f
(")2817 3708 w
10 R f
( server must map)3 745(protocol has been negotiated, the)4 1393 2 2902 3708 t
(additional OS/2 \(or OS/2 like\) errors to the errors listed below.)10 2591 1 720 3828 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 59 59
%%Page: 60 60
save
mark
60 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 60 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(The following error codes may be generated with the ERRDOS error class.)11 3087 1 720 840 t
( not recognize or could not perform a)7 1586( server OS did)3 613( The)1 226( function.)1 396( Invalid)1 433(ERRbadfunc 1)1 1027 6 720 1020 t
( by the server, e.g., set the DIRECTORY attribute on)9 2221(system call generated)2 883 2 1897 1140 t
(a data \256le, invalid seek mode. [EINVAL])6 1700 1 1897 1260 t
( component of a \256le's pathname could not be)8 2027( last)1 191( The)1 240( not found.)2 490( File)1 306(ERRbad\256le 2)1 1027 6 720 1380 t
(found.)1897 1500 w
( in a pathname could not be)6 1290( directory component)2 914( A)1 160( invalid.)1 358( Directory)1 532(ERRbadpath 3)1 1027 6 720 1620 t
(found. [ENOENT])1 789 1 1897 1740 t
( \256le handles \(FIDs\) available.)4 1300( server has no)3 635( The)1 241( many open \256les.)3 767( Too)1 311(ERRno\256ds 4)1 1027 6 720 1860 t
([EMFILE])1897 1980 w
( requested func-)2 672( denied, the requester's context does not permit the)8 2150( Access)1 432(ERRnoaccess 5)1 1027 4 720 2100 t
( [EPERM])1 466( includes the following conditions.)4 1418(tion. This)1 425 3 1897 2220 t
(invalid rename command)2 1031 1 2029 2400 t
(write to \256d open for read only)6 1246 1 2029 2520 t
(read on \256d open for write only)6 1268 1 2029 2640 t
(Attempt to delete a non-empty directory)5 1646 1 2029 2760 t
( speci\256ed was not recognized by the)6 1585( \256le handle)2 488( The)1 235( \256le handle.)2 513( Invalid)1 433(ERRbad\256d 6)1 1027 6 720 2940 t
(server. [EBADF])1 728 1 1897 3060 t
( [EREMOTEIO])1 709( control blocks destroyed.)3 1056( Memory)1 494(ERRbadmcb 7)1 1027 4 720 3180 t
( [ENOMEM])1 576( server memory to perform the requested function.)7 2068( Insuf\256cient)1 605(ERRnomem 8)1 1027 4 720 3300 t
( [EFAULT])1 515( memory block address.)3 978( Invalid)1 433(ERRbadmem 9)1 1027 4 720 3420 t
( [EREMOTEIO])1 709( environment.)1 563( Invalid)1 433(ERRbadenv 10)1 1027 4 720 3540 t
( [EREMOTEIO])1 709( format.)1 324( Invalid)1 433(ERRbadformat 11)1 1027 4 720 3660 t
( open mode.)2 507( Invalid)1 433(ERRbadaccess 12)1 1027 3 720 3780 t
( [E2BIG])1 415( data \(generated only by IOCTL calls within the server\).)9 2317( Invalid)1 433(ERRbaddata 13)1 1027 4 720 3900 t
( reserved)1 487(ERR 14)1 1027 2 720 4020 t
( [ENXIO])1 442( drive speci\256ed.)2 651( Invalid)1 433(ERRbaddrive 15)1 1027 4 720 4140 t
( Delete Directory request attempted to remove the server's current direc-)10 3032( A)1 222(ERRremcd 16)1 1027 3 720 4260 t
(tory. [EREMOTEIO])1 895 1 1897 4380 t
( [EXDEV])1 470( same device \(e.g., a cross volume rename was attempted\))9 2388( Not)1 300(ERRdiffdevice 17)1 1027 4 720 4500 t
( speci\256ed cri-)2 571( File Search command can \256nd no more \256les matching the)10 2461( A)1 222(ERRno\256les 18)1 1027 4 720 4620 t
(teria.)1897 4740 w
( sharing mode speci\256ed for an Open con\257icts with existing FIDs on the)12 2949( The)1 305(ERRbadshare 32)1 1027 3 720 4860 t
(\256le. [ETXTBSY])1 735 1 1897 4980 t
( an invalid)2 478( Lock request con\257icted with an existing lock or speci\256ed)9 2554( A)1 222(ERRlock 33)1 1027 4 720 5100 t
( Unlock requested attempted to remove a lock held by another)10 2604(mode, or an)2 500 2 1897 5220 t
(process. [EDEADLOCK])1 1066 1 1897 5340 t
( named in a Create Directory, Make New File or Link request)11 2769( \256le)1 180( The)1 305(ERR\256lexists 80)1 1027 4 720 5460 t
( Create and Rename)3 845(already exists. The error may also be generated in the)9 2259 2 1897 5580 t
(transaction. [EEXIST])1 939 1 1897 5700 t
( invalid.)1 336( Pipe)1 328(ERRbadpipe 230)1 1027 3 720 5940 t
( instances of the requested pipe are busy.)7 1691( All)1 278(ERRpipebusy 231)1 1027 3 720 6060 t
( close in progress.)3 745( Pipe)1 328(ERRpipeclosing 232)1 1027 3 720 6180 t
( process on other end of pipe.)6 1226(ERRnotconnected 233 No)2 1299 2 720 6300 t
( is more data to be returned.)6 1165( There)1 382(ERRmoredata 234)1 1027 3 720 6420 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 60 60
%%Page: 61 61
save
mark
61 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 61 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
(The following error codes may be generated with the ERRSRV error class.)11 3082 1 720 840 t
( is returned under the following conditions:)6 1780( It)1 127( error code.)2 472( Non-speci\256c)1 660(ERRerror 1)1 1186 5 720 1020 t
(resource other than disk space exhausted \(e.g. TIDs\))7 2147 1 2188 1200 t
(\256rst command on VC was not negotiate)6 1636 1 2188 1320 t
(multiple negotiates attempted)2 1199 1 2188 1440 t
(internal server error [ENFILE])3 1250 1 2188 1560 t
( Session)1 359( password - name/password pair in a Tree Connect or)9 2374( Bad)1 311(ERRbadpw 2)1 1186 4 720 1740 t
(Setup are invalid.)2 718 1 2056 1860 t
( reserved)1 487(ERRbadtype 3)1 1186 2 720 1980 t
( the necessary access rights within the)6 1675( requester does not have)4 1064( The)1 305(ERRaccess 4)1 1186 4 720 2100 t
( is de\256ned by)3 566(speci\256ed context for the requested function. The context)7 2328 2 2056 2220 t
( [EACCES])1 516(the TID or the UID.)4 827 2 2056 2340 t
( tree ID \(TID\) speci\256ed in a command was invalid.)9 2112( The)1 305(ERRinvnid 5)1 1186 3 720 2460 t
( network name in tree connect.)5 1270( Invalid)1 433(ERRinvnetname 6)1 1186 3 720 2580 t
( made to non-printer connection or)5 1544( device - printer request)4 1067( Invalid)1 433(ERRinvdevice 7)1 1186 4 720 2700 t
(non-printer request made to printer connection.)5 1925 1 2056 2820 t
( queue full \(\256les\) -- returned by open print \256le.)9 1941( Print)1 345(ERRqfull 49)1 1186 3 720 2940 t
( queue full -- no space.)5 954( Print)1 345(ERRqtoobig 50)1 1186 3 720 3060 t
( on print queue dump.)4 912( EOF)1 339(ERRqeof 51)1 1186 3 720 3180 t
( print \256le FID.)3 602( Invalid)1 433(ERRinvp\256d 52)1 1186 3 720 3300 t
( server did not recognize the command received.)7 1995( The)1 305(ERRsmbcmd 64)1 1186 3 720 3420 t
( server encountered an internal error, e.g., system \256le unavailable.)9 2704( The)1 305(ERRsrverror 65)1 1186 3 720 3540 t
( an invalid)2 460( \256le handle \(FID\) and pathname parameters contained)7 2279( The)1 305(ERR\256lespecs 67)1 1186 4 720 3660 t
(combination of values.)2 929 1 2056 3780 t
( reserved.)1 512(ERRreserved 68)1 1186 2 720 3900 t
( a \256le or directory are not a valid)8 1396( access permissions speci\256ed for)4 1343( The)1 305(ERRbadpermits 69)1 1186 4 720 4020 t
( server cannot set the requested attribute.)6 1680(combination. The)1 746 2 2056 4140 t
( reserved.)1 512(ERRreserved 70)1 1186 2 720 4260 t
( attribute mode in the Set File Attribute request is invalid.)10 2388( The)1 305(ERRsetattrmode 71)1 1186 3 720 4380 t
( is paused. \(reserved for messaging\))5 1475( Server)1 410(ERRpaused 81)1 1186 3 720 4500 t
( receiving messages. \(reserved for messaging\).)5 1904( Not)1 300(ERRmsgoff 82)1 1186 3 720 4620 t
( room to buffer message. \(reserved for messaging\).)7 2092( No)1 272(ERRnoroom 83)1 1186 3 720 4740 t
( many remote user names. \(reserved for messaging\).)7 2142( Too)1 311(ERRrmuns 87)1 1186 3 720 4860 t
( timed out.)2 447( Operation)1 549(ERRtimeout 88)1 1186 3 720 4980 t
( resources currently available for request.)5 1690( No)1 272(ERRnoresource 89)1 1186 3 720 5100 t
( many UIDs active on this session.)6 1433( Too)1 311(ERRtoomanyuids 90)1 1186 3 720 5220 t
( UID is not known as a valid ID on this session.)11 1998( The)1 305(ERRbaduid 91)1 1186 3 720 5340 t
( unable to support Raw, use MPX mode.)7 1680( Temp)1 383(ERRusempx 250)1 1186 3 720 5580 t
( unable to support Raw, use standard read/write.)7 1983( Temp)1 383(ERRusestd 251)1 1186 3 720 5700 t
( continue in MPX mode.)4 1018( \(reserved\))1 553(ERRcontmpx 252)1 1186 3 720 5820 t
( reserved.)1 512(ERRreserved 253)1 1186 2 720 5940 t
( reserved.)1 512(ERRreserved 254)1 1186 2 720 6060 t
( not supported.)2 613( Function)1 506(ERRnosupport 0xFFFF)1 1186 3 720 6300 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
cleartomark
showpage
restore
%%EndPage: 61 61
%%Page: 62 62
save
mark
62 pagesetup
10 R f
(-- --)1 5472 1 0 40 t
( 19, 1990)2 391( June)1 1653( 62 -)2 199( -)1 1021(SMB Protocol Extensions)2 1056 5 720 520 t
( errors)1 294( XENIX)1 371( The)1 249(The following error codes may be generated with the ERRHRD error class.)11 3406 4 720 840 t
(equivalent to each of these errors are noted at the end of the error description.)14 3206 1 720 960 t
( [EROFS])1 444( to write on write-protected diskette.)5 1493( Attempt)1 478(ERRnowrite 19)1 951 4 720 1140 t
( [ENODEV])1 542( unit.)1 214( Unknown)1 544(ERRbadunit 20)1 951 4 720 1260 t
( [EUCLEAN])1 598( not ready.)2 440( Drive)1 377(ERRnotready 21)1 951 4 720 1380 t
( command.)1 452( Unknown)1 544(ERRbadcmd 22)1 951 3 720 1500 t
( [EIO])1 298( error \(CRC\).)2 551( Data)1 338(ERRdata 23)1 951 4 720 1620 t
( [ERANGE])1 537( request structure length.)3 1011( Bad)1 311(ERRbadreq 24)1 951 4 720 1740 t
( error.)1 251( Seek)1 344(ERRseek 25)1 951 3 720 1860 t
( media type.)2 507( Unknown)1 544(ERRbadmedia 26)1 951 3 720 1980 t
( not found.)2 452( Sector)1 405(ERRbadsector 27)1 951 3 720 2100 t
( out of paper.)3 556( Printer)1 422(ERRnopaper 28)1 951 3 720 2220 t
( fault.)1 241( Write)1 377(ERRwrite 29)1 951 3 720 2340 t
( fault.)1 241( Read)1 355(ERRread 30)1 951 3 720 2460 t
( failure.)1 318( General)1 465(ERRgeneral 31)1 951 3 720 2580 t
( open con\257icts with an existing open. [ETXTBSY])7 2088( A)1 222(ERRbadshare 32)1 951 3 720 2700 t
( con\257icted with an existing lock or)6 1586( Lock request)2 607( A)1 222(ERRlock 33)1 951 4 720 2820 t
( an Unlock requested)3 956(speci\256ed an invalid mode, or)4 1309 2 1821 2940 t
( remove a lock held by another process.)7 1746(attempted to)1 519 2 1821 3060 t
([EDEADLOCK])1821 3180 w
( wrong disk was found in a drive.)7 1393( The)1 305(ERRwrongdisk 34)1 951 3 720 3300 t
( FCBs are available to process request.)6 1598(ERRFCBUnavail 35 No)2 1223 2 720 3420 t
( sharing buffer has been exceeded.)5 1418( A)1 222(ERRsharebufexc 36)1 951 3 720 3540 t
( Networks)1 421( Microsoft)1 2159(Copyright Microsoft Corporation, 1987-90)3 1740 3 720 7680 t
(-- --)1 5472 1 0 7950 t
cleartomark
showpage
restore
%%EndPage: 62 62
%%Trailer
done
%%DocumentFonts: Times-Roman Times-Bold Times-Italic Symbol
%%Pages: 62
